import{B as xe,Bd as dt,C as Jt,Cc as si,D as Q,Da as Kr,Ea as Gr,F as lt,Fa as nr,G as P,Ga as Yr,H as er,I as xr,Ia as ct,Jd as $,K as Br,Ld as u,M as pe,N as jr,Na as Ee,O as y,P as G,Q as g,Qa as Zr,R as w,Ta as Xr,Tb as ii,U as R,Ud as ui,Va as Jr,Vb as se,Vd as di,W as kr,Wa as ei,Wd as L,X as z,Y as tr,Z as d,_ as qr,_b as ni,a as Mr,aa as Be,b as Pr,ba as W,c as wr,cc as oi,d as Yt,e as Zt,f as V,g as h,ga as Hr,gb as ti,gd as ai,i as ee,ia as zr,j as q,k as m,ka as rr,l as $e,lc as ut,m as Dr,ma as je,mb as ri,md as li,n as Fr,na as Qr,o as f,oa as Wr,p as O,pa as ir,q as H,r as Vr,s as at,u as Xt,v as $r,vd as ci,y as N,yc as fe,z as he}from"./chunk-BJQECC5Y.js";import{a as v,b as B}from"./chunk-6MDQTQU3.js";var A="primary",rt=Symbol("RouteTitle"),cr=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ce(r){return new cr(r)}function Si(r,e,t){let i=t.path.split("/");if(i.length>r.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<r.length))return null;let n={};for(let o=0;o<i.length;o++){let s=i[o],a=r[o];if(s[0]===":")n[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:r.slice(0,i.length),posParams:n}}function In(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!Y(r[t],e[t]))return!1;return!0}function Y(r,e){let t=r?ur(r):void 0,i=e?ur(e):void 0;if(!t||!i||t.length!=i.length)return!1;let n;for(let o=0;o<t.length;o++)if(n=t[o],!vi(r[n],e[n]))return!1;return!0}function ur(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function vi(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;let t=[...r].sort(),i=[...e].sort();return t.every((n,o)=>i[o]===n)}else return r===e}function Ii(r){return r.length>0?r[r.length-1]:null}function ie(r){return Dr(r)?r:Xr(r)?q(Promise.resolve(r)):m(r)}var An={exact:bi,subset:Ti},Ai={exact:bn,subset:Tn,ignored:()=>!0};function hi(r,e,t){return An[t.paths](r.root,e.root,t.matrixParams)&&Ai[t.queryParams](r.queryParams,e.queryParams)&&!(t.fragment==="exact"&&r.fragment!==e.fragment)}function bn(r,e){return Y(r,e)}function bi(r,e,t){if(!ae(r.segments,e.segments)||!Et(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!r.children[i]||!bi(r.children[i],e.children[i],t))return!1;return!0}function Tn(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>vi(r[t],e[t]))}function Ti(r,e,t){return _i(r,e,e.segments,t)}function _i(r,e,t,i){if(r.segments.length>t.length){let n=r.segments.slice(0,t.length);return!(!ae(n,t)||e.hasChildren()||!Et(n,t,i))}else if(r.segments.length===t.length){if(!ae(r.segments,t)||!Et(r.segments,t,i))return!1;for(let n in e.children)if(!r.children[n]||!Ti(r.children[n],e.children[n],i))return!1;return!0}else{let n=t.slice(0,r.segments.length),o=t.slice(r.segments.length);return!ae(r.segments,n)||!Et(r.segments,n,i)||!r.children[A]?!1:_i(r.children[A],e,o,i)}}function Et(r,e,t){return e.every((i,n)=>Ai[t](r[n].parameters,i.parameters))}var X=class{root;queryParams;fragment;_queryParamMap;constructor(e=new _([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=ce(this.queryParams),this._queryParamMap}toString(){return yn.serialize(this)}},_=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ft(this)}},ne=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ce(this.parameters),this._parameterMap}toString(){return yi(this)}};function _n(r,e){return ae(r,e)&&r.every((t,i)=>Y(t.parameters,e[i].parameters))}function ae(r,e){return r.length!==e.length?!1:r.every((t,i)=>t.path===e[i].path)}function Ln(r,e){let t=[];return Object.entries(r.children).forEach(([i,n])=>{i===A&&(t=t.concat(e(n,i)))}),Object.entries(r.children).forEach(([i,n])=>{i!==A&&(t=t.concat(e(n,i)))}),t}var it=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:()=>new ue,providedIn:"root"})}return r})(),ue=class{parse(e){let t=new hr(e);return new X(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${ke(e.root,!0)}`,i=On(e.queryParams),n=typeof e.fragment=="string"?`#${Cn(e.fragment)}`:"";return`${t}${i}${n}`}},yn=new ue;function ft(r){return r.segments.map(e=>yi(e)).join("/")}function ke(r,e){if(!r.hasChildren())return ft(r);if(e){let t=r.children[A]?ke(r.children[A],!1):"",i=[];return Object.entries(r.children).forEach(([n,o])=>{n!==A&&i.push(`${n}:${ke(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=Ln(r,(i,n)=>n===A?[ke(r.children[A],!1)]:[`${n}:${ke(i,!1)}`]);return Object.keys(r.children).length===1&&r.children[A]!=null?`${ft(r)}/${t[0]}`:`${ft(r)}/(${t.join("//")})`}}function Li(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ht(r){return Li(r).replace(/%3B/gi,";")}function Cn(r){return encodeURI(r)}function dr(r){return Li(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function mt(r){return decodeURIComponent(r)}function pi(r){return mt(r.replace(/\+/g,"%20"))}function yi(r){return`${dr(r.path)}${Un(r.parameters)}`}function Un(r){return Object.entries(r).map(([e,t])=>`;${dr(e)}=${dr(t)}`).join("")}function On(r){let e=Object.entries(r).map(([t,i])=>Array.isArray(i)?i.map(n=>`${ht(t)}=${ht(n)}`).join("&"):`${ht(t)}=${ht(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Nn=/^[^\/()?;#]+/;function or(r){let e=r.match(Nn);return e?e[0]:""}var Mn=/^[^\/()?;=#]+/;function Pn(r){let e=r.match(Mn);return e?e[0]:""}var wn=/^[^=?&#]+/;function Dn(r){let e=r.match(wn);return e?e[0]:""}var Fn=/^[^&#]+/;function Vn(r){let e=r.match(Fn);return e?e[0]:""}var hr=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new _([],{}):new _([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[A]=new _(e,t)),i}parseSegment(){let e=or(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new w(4009,!1);return this.capture(e),new ne(mt(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Pn(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let n=or(this.remaining);n&&(i=n,this.capture(i))}e[mt(t)]=mt(i)}parseQueryParam(e){let t=Dn(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=Vn(this.remaining);s&&(i=s,this.capture(i))}let n=pi(t),o=pi(i);if(e.hasOwnProperty(n)){let s=e[n];Array.isArray(s)||(s=[s],e[n]=s),s.push(o)}else e[n]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=or(this.remaining),n=this.remaining[i.length];if(n!=="/"&&n!==")"&&n!==";")throw new w(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=A);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[A]:new _([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new w(4011,!1)}};function Ci(r){return r.segments.length>0?new _([],{[A]:r}):r}function Ui(r){let e={};for(let[i,n]of Object.entries(r.children)){let o=Ui(n);if(i===A&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new _(r.segments,e);return $n(t)}function $n(r){if(r.numberOfChildren===1&&r.children[A]){let e=r.children[A];return new _(r.segments.concat(e.segments),e.children)}return r}function ve(r){return r instanceof X}function Oi(r,e,t=null,i=null){let n=Ni(r);return Mi(n,e,t,i)}function Ni(r){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new _(o.url,s);return o===r&&(e=a),a}let i=t(r.root),n=Ci(i);return e??n}function Mi(r,e,t,i){let n=r;for(;n.parent;)n=n.parent;if(e.length===0)return sr(n,n,n,t,i);let o=xn(e);if(o.toRoot())return sr(n,n,new _([],{}),t,i);let s=Bn(o,n,r),a=s.processChildren?He(s.segmentGroup,s.index,o.commands):wi(s.segmentGroup,s.index,o.commands);return sr(n,s.segmentGroup,a,t,i)}function gt(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function We(r){return typeof r=="object"&&r!=null&&r.outlets}function sr(r,e,t,i,n){let o={};i&&Object.entries(i).forEach(([l,c])=>{o[l]=Array.isArray(c)?c.map(p=>`${p}`):`${c}`});let s;r===e?s=t:s=Pi(r,e,t);let a=Ci(Ui(s));return new X(a,o,n)}function Pi(r,e,t){let i={};return Object.entries(r.children).forEach(([n,o])=>{o===e?i[n]=t:i[n]=Pi(o,e,t)}),new _(r.segments,i)}var Rt=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&gt(i[0]))throw new w(4003,!1);let n=i.find(We);if(n&&n!==Ii(i))throw new w(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function xn(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new Rt(!0,0,r);let e=0,t=!1,i=r.reduce((n,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...n,{outlets:a}]}if(o.segmentPath)return[...n,o.segmentPath]}return typeof o!="string"?[...n,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&n.push(a))}),n):[...n,o]},[]);return new Rt(t,e,i)}var Re=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function Bn(r,e,t){if(r.isAbsolute)return new Re(e,!0,0);if(!t)return new Re(e,!1,NaN);if(t.parent===null)return new Re(t,!0,0);let i=gt(r.commands[0])?0:1,n=t.segments.length-1+i;return jn(t,n,r.numberOfDoubleDots)}function jn(r,e,t){let i=r,n=e,o=t;for(;o>n;){if(o-=n,i=i.parent,!i)throw new w(4005,!1);n=i.segments.length}return new Re(i,!1,n-o)}function kn(r){return We(r[0])?r[0].outlets:{[A]:r}}function wi(r,e,t){if(r??=new _([],{}),r.segments.length===0&&r.hasChildren())return He(r,e,t);let i=qn(r,e,t),n=t.slice(i.commandIndex);if(i.match&&i.pathIndex<r.segments.length){let o=new _(r.segments.slice(0,i.pathIndex),{});return o.children[A]=new _(r.segments.slice(i.pathIndex),r.children),He(o,0,n)}else return i.match&&n.length===0?new _(r.segments,{}):i.match&&!r.hasChildren()?pr(r,e,t):i.match?He(r,0,n):pr(r,e,t)}function He(r,e,t){if(t.length===0)return new _(r.segments,{});{let i=kn(t),n={};if(Object.keys(i).some(o=>o!==A)&&r.children[A]&&r.numberOfChildren===1&&r.children[A].segments.length===0){let o=He(r.children[A],e,t);return new _(r.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(n[o]=wi(r.children[o],e,s))}),Object.entries(r.children).forEach(([o,s])=>{i[o]===void 0&&(n[o]=s)}),new _(r.segments,n)}}function qn(r,e,t){let i=0,n=e,o={match:!1,pathIndex:0,commandIndex:0};for(;n<r.segments.length;){if(i>=t.length)return o;let s=r.segments[n],a=t[i];if(We(a))break;let l=`${a}`,c=i<t.length-1?t[i+1]:null;if(n>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!fi(l,c,s))return o;i+=2}else{if(!fi(l,{},s))return o;i++}n++}return{match:!0,pathIndex:n,commandIndex:i}}function pr(r,e,t){let i=r.segments.slice(0,e),n=0;for(;n<t.length;){let o=t[n];if(We(o)){let l=Hn(o.outlets);return new _(i,l)}if(n===0&&gt(t[0])){let l=r.segments[e];i.push(new ne(l.path,Ei(t[0]))),n++;continue}let s=We(o)?o.outlets[A]:`${o}`,a=n<t.length-1?t[n+1]:null;s&&a&&gt(a)?(i.push(new ne(s,Ei(a))),n+=2):(i.push(new ne(s,{})),n++)}return new _(i,{})}function Hn(r){let e={};return Object.entries(r).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=pr(new _([],{}),0,i))}),e}function Ei(r){let e={};return Object.entries(r).forEach(([t,i])=>e[t]=`${i}`),e}function fi(r,e,t){return r==t.path&&Y(e,t.parameters)}var ze="imperative",M=(function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r})(M||{}),k=class{id;url;constructor(e,t){this.id=e,this.url=t}},de=class extends k{type=M.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",n=null){super(e,t),this.navigationTrigger=i,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},te=class extends k{urlAfterRedirects;type=M.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},D=(function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r[r.Aborted=4]="Aborted",r})(D||{}),Ke=(function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r})(Ke||{}),Z=class extends k{reason;code;type=M.NavigationCancel;constructor(e,t,i,n){super(e,t),this.reason=i,this.code=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},re=class extends k{reason;code;type=M.NavigationSkipped;constructor(e,t,i,n){super(e,t),this.reason=i,this.code=n}},Ie=class extends k{error;target;type=M.NavigationError;constructor(e,t,i,n){super(e,t),this.error=i,this.target=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ge=class extends k{urlAfterRedirects;state;type=M.RoutesRecognized;constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},St=class extends k{urlAfterRedirects;state;type=M.GuardsCheckStart;constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},vt=class extends k{urlAfterRedirects;state;shouldActivate;type=M.GuardsCheckEnd;constructor(e,t,i,n,o){super(e,t),this.urlAfterRedirects=i,this.state=n,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},It=class extends k{urlAfterRedirects;state;type=M.ResolveStart;constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},At=class extends k{urlAfterRedirects;state;type=M.ResolveEnd;constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},bt=class{route;type=M.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Tt=class{route;type=M.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},_t=class{snapshot;type=M.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Lt=class{snapshot;type=M.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yt=class{snapshot;type=M.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ct=class{snapshot;type=M.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Ye=class{},Ae=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function zn(r){return!(r instanceof Ye)&&!(r instanceof Ae)}function Qn(r,e){return r.providers&&!r._injector&&(r._injector=nr(r.providers,e,`Route: ${r.path}`)),r._injector??e}function K(r){return r.outlet||A}function Wn(r,e){let t=r.filter(i=>K(i)===e);return t.push(...r.filter(i=>K(i)!==e)),t}function _e(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Ut=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return _e(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Le(this.rootInjector)}},Le=(()=>{class r{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let n=this.getOrCreateContext(t);n.outlet=i,this.contexts.set(t,n)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Ut(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||r)(tr(Be))};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Ot=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Er(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=Er(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=fr(e,this._root);return t.length<2?[]:t[t.length-2].children.map(n=>n.value).filter(n=>n!==e)}pathFromRoot(e){return fr(e,this._root).map(t=>t.value)}};function Er(r,e){if(r===e.value)return e;for(let t of e.children){let i=Er(r,t);if(i)return i}return null}function fr(r,e){if(r===e.value)return[e];for(let t of e.children){let i=fr(r,t);if(i.length)return i.unshift(e),i}return[]}var j=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ge(r){let e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}var Ze=class extends Ot{snapshot;constructor(e,t){super(e),this.snapshot=t,br(this,e)}toString(){return this.snapshot.toString()}};function Di(r){let e=Kn(r),t=new h([new ne("",{})]),i=new h({}),n=new h({}),o=new h({}),s=new h(""),a=new J(t,i,o,s,n,A,r,e.root);return a.snapshot=e.root,new Ze(new j(a,[]),e)}function Kn(r){let e={},t={},i={},o=new le([],e,i,"",t,A,r,null,{});return new Xe("",new j(o,[]))}var J=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,n,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=n,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(f(c=>c[rt]))??m(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=n,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(f(e=>ce(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(f(e=>ce(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Nt(r,e,t="emptyOnly"){let i,{routeConfig:n}=r;return e!==null&&(t==="always"||n?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:v(v({},e.params),r.params),data:v(v({},e.data),r.data),resolve:v(v(v(v({},r.data),e.data),n?.data),r._resolvedData)}:i={params:v({},r.params),data:v({},r.data),resolve:v(v({},r.data),r._resolvedData??{})},n&&Vi(n)&&(i.resolve[rt]=n.title),i}var le=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[rt]}constructor(e,t,i,n,o,s,a,l,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=n,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ce(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ce(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Xe=class extends Ot{url;constructor(e,t){super(t),this.url=e,br(this,t)}toString(){return Fi(this._root)}};function br(r,e){e.value._routerState=r,e.children.forEach(t=>br(r,t))}function Fi(r){let e=r.children.length>0?` { ${r.children.map(Fi).join(", ")} } `:"";return`${r.value}${e}`}function ar(r){if(r.snapshot){let e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,Y(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),Y(e.params,t.params)||r.paramsSubject.next(t.params),In(e.url,t.url)||r.urlSubject.next(t.url),Y(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function mr(r,e){let t=Y(r.params,e.params)&&_n(r.url,e.url),i=!r.parent!=!e.parent;return t&&!i&&(!r.parent||mr(r.parent,e.parent))}function Vi(r){return typeof r.title=="string"||r.title===null}var $i=new z(""),Tr=(()=>{class r{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=A;activateEvents=new Ee;deactivateEvents=new Ee;attachEvents=new Ee;detachEvents=new Ee;routerOutletData=ni(void 0);parentContexts=d(Le);location=d(Kr);changeDetector=d(oi);inputBinder=d(Dt,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:n}=t.name;if(i)return;this.isTrackedInParentContexts(n)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(n)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new w(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new w(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new w(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new w(4013,!1);this._activatedRoute=t;let n=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new gr(t,a,n.injector,this.routerOutletData);this.activated=n.createComponent(s,{index:n.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||r)};static \u0275dir=ct({type:r,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Wr]})}return r})(),gr=class{route;childContexts;parent;outletData;constructor(e,t,i,n){this.route=e,this.childContexts=t,this.parent=i,this.outletData=n}get(e,t){return e===J?this.route:e===Le?this.childContexts:e===$i?this.outletData:this.parent.get(e,t)}},Dt=new z("");var _r=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275cmp=Yr({type:r,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,n){i&1&&ti(0,"router-outlet")},dependencies:[Tr],encapsulation:2})}return r})();function Lr(r){let e=r.children&&r.children.map(Lr),t=e?B(v({},r),{children:e}):v({},r);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==A&&(t.component=_r),t}function Gn(r,e,t){let i=Je(r,e._root,t?t._root:void 0);return new Ze(i,e)}function Je(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let n=Yn(r,e,t);return new j(i,n)}else{if(r.shouldAttach(e.value)){let o=r.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Je(r,a)),s}}let i=Zn(e.value),n=e.children.map(o=>Je(r,o));return new j(i,n)}}function Yn(r,e,t){return e.children.map(i=>{for(let n of t.children)if(r.shouldReuseRoute(i.value,n.value.snapshot))return Je(r,i,n);return Je(r,i)})}function Zn(r){return new J(new h(r.url),new h(r.params),new h(r.queryParams),new h(r.fragment),new h(r.data),r.outlet,r.component,r)}var be=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},xi="ngNavigationCancelingError";function Mt(r,e){let{redirectTo:t,navigationBehaviorOptions:i}=ve(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,n=Bi(!1,D.Redirect);return n.url=t,n.navigationBehaviorOptions=i,n}function Bi(r,e){let t=new Error(`NavigationCancelingError: ${r||""}`);return t[xi]=!0,t.cancellationCode=e,t}function Xn(r){return ji(r)&&ve(r.url)}function ji(r){return!!r&&r[xi]}var Jn=(r,e,t,i)=>f(n=>(new Rr(e,n.targetRouterState,n.currentRouterState,t,i).activate(r),n)),Rr=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,n,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=n,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),ar(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let n=ge(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,n[s],i),delete n[s]}),Object.values(n).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let n=e.value,o=t?t.value:null;if(n===o)if(n.component){let s=i.getContext(n.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),n=i&&e.value.component?i.children:t,o=ge(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,n);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),n=i&&e.value.component?i.children:t,o=ge(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,n);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let n=ge(t);e.children.forEach(o=>{this.activateRoutes(o,n[o.value.outlet],i),this.forwardEvent(new Ct(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Lt(e.value.snapshot))}activateRoutes(e,t,i){let n=e.value,o=t?t.value:null;if(ar(n),n===o)if(n.component){let s=i.getOrCreateContext(n.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(n.component){let s=i.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){let a=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),ar(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=n,s.outlet&&s.outlet.activateWith(n,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},Pt=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Se=class{component;route;constructor(e,t){this.component=e,this.route=t}};function eo(r,e,t){let i=r._root,n=e?e._root:null;return qe(i,n,t,[i.value])}function to(r){let e=r.routeConfig?r.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:r,guards:e}}function ye(r,e){let t=Symbol(),i=e.get(r,t);return i===t?typeof r=="function"&&!kr(r)?r:e.get(r):i}function qe(r,e,t,i,n={canDeactivateChecks:[],canActivateChecks:[]}){let o=ge(e);return r.children.forEach(s=>{ro(s,o[s.value.outlet],t,i.concat([s.value]),n),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Qe(a,t.getContext(s),n)),n}function ro(r,e,t,i,n={canDeactivateChecks:[],canActivateChecks:[]}){let o=r.value,s=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=io(s,o,o.routeConfig.runGuardsAndResolvers);l?n.canActivateChecks.push(new Pt(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?qe(r,e,a?a.children:null,i,n):qe(r,e,t,i,n),l&&a&&a.outlet&&a.outlet.isActivated&&n.canDeactivateChecks.push(new Se(a.outlet.component,s))}else s&&Qe(e,a,n),n.canActivateChecks.push(new Pt(i)),o.component?qe(r,null,a?a.children:null,i,n):qe(r,null,t,i,n);return n}function io(r,e,t){if(typeof t=="function")return t(r,e);switch(t){case"pathParamsChange":return!ae(r.url,e.url);case"pathParamsOrQueryParamsChange":return!ae(r.url,e.url)||!Y(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!mr(r,e)||!Y(r.queryParams,e.queryParams);case"paramsChange":default:return!mr(r,e)}}function Qe(r,e,t){let i=ge(r),n=r.value;Object.entries(i).forEach(([o,s])=>{n.component?e?Qe(s,e.children.getContext(o),t):Qe(s,null,t):Qe(s,e,t)}),n.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Se(e.outlet.component,n)):t.canDeactivateChecks.push(new Se(null,n)):t.canDeactivateChecks.push(new Se(null,n))}function nt(r){return typeof r=="function"}function no(r){return typeof r=="boolean"}function oo(r){return r&&nt(r.canLoad)}function so(r){return r&&nt(r.canActivate)}function ao(r){return r&&nt(r.canActivateChild)}function lo(r){return r&&nt(r.canDeactivate)}function co(r){return r&&nt(r.canMatch)}function ki(r){return r instanceof Fr||r?.name==="EmptyError"}var pt=Symbol("INITIAL_VALUE");function Te(){return y(r=>O(r.map(e=>e.pipe(Q(1),jr(pt)))).pipe(f(e=>{for(let t of e)if(t!==!0){if(t===pt)return pt;if(t===!1||uo(t))return t}return!0}),N(e=>e!==pt),Q(1)))}function uo(r){return ve(r)||r instanceof be}function ho(r,e){return H(t=>{let{targetSnapshot:i,currentSnapshot:n,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?m(B(v({},t),{guardsResult:!0})):po(s,i,n,r).pipe(H(a=>a&&no(a)?Eo(i,o,r,e):m(a)),f(a=>B(v({},t),{guardsResult:a})))})}function po(r,e,t,i){return q(r).pipe(H(n=>So(n.component,n.route,t,e,i)),P(n=>n!==!0,!0))}function Eo(r,e,t,i){return q(e).pipe(xe(n=>Vr(mo(n.route.parent,i),fo(n.route,i),Ro(r,n.path,t),go(r,n.route,t))),P(n=>n!==!0,!0))}function fo(r,e){return r!==null&&e&&e(new yt(r)),m(!0)}function mo(r,e){return r!==null&&e&&e(new _t(r)),m(!0)}function go(r,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return m(!0);let n=i.map(o=>at(()=>{let s=_e(e)??t,a=ye(o,s),l=so(a)?a.canActivate(e,r):W(s,()=>a(e,r));return ie(l).pipe(P())}));return m(n).pipe(Te())}function Ro(r,e,t){let i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>to(s)).filter(s=>s!==null).map(s=>at(()=>{let a=s.guards.map(l=>{let c=_e(s.node)??t,p=ye(l,c),S=ao(p)?p.canActivateChild(i,r):W(c,()=>p(i,r));return ie(S).pipe(P())});return m(a).pipe(Te())}));return m(o).pipe(Te())}function So(r,e,t,i,n){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return m(!0);let s=o.map(a=>{let l=_e(e)??n,c=ye(a,l),p=lo(c)?c.canDeactivate(r,e,t,i):W(l,()=>c(r,e,t,i));return ie(p).pipe(P())});return m(s).pipe(Te())}function vo(r,e,t,i){let n=e.canLoad;if(n===void 0||n.length===0)return m(!0);let o=n.map(s=>{let a=ye(s,r),l=oo(a)?a.canLoad(e,t):W(r,()=>a(e,t));return ie(l)});return m(o).pipe(Te(),qi(i))}function qi(r){return Pr(g(e=>{if(typeof e!="boolean")throw Mt(r,e)}),f(e=>e===!0))}function Io(r,e,t,i){let n=e.canMatch;if(!n||n.length===0)return m(!0);let o=n.map(s=>{let a=ye(s,r),l=co(a)?a.canMatch(e,t):W(r,()=>a(e,t));return ie(l)});return m(o).pipe(Te(),qi(i))}var et=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},tt=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function me(r){return $e(new et(r))}function Ao(r){return $e(new w(4e3,!1))}function bo(r){return $e(Bi(!1,D.GuardRejected))}var Sr=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],n=t.root;for(;;){if(i=i.concat(n.segments),n.numberOfChildren===0)return m(i);if(n.numberOfChildren>1||!n.children[A])return Ao(`${e.redirectTo}`);n=n.children[A]}}applyRedirectCommands(e,t,i,n,o){return To(t,n,o).pipe(f(s=>{if(s instanceof X)throw new tt(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new tt(a);return a}))}applyRedirectCreateUrlTree(e,t,i,n){let o=this.createSegmentGroup(e,t.root,i,n);return new X(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([n,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[n]=t[a]}else i[n]=o}),i}createSegmentGroup(e,t,i,n){let o=this.createSegments(e,t.segments,i,n),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,n)}),new _(o,s)}createSegments(e,t,i,n){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,n):this.findOrReturn(o,i))}findPosParam(e,t,i){let n=i[t.path.substring(1)];if(!n)throw new w(4001,!1);return n}findOrReturn(e,t){let i=0;for(let n of t){if(n.path===e.path)return t.splice(i),n;i++}return e}};function To(r,e,t){if(typeof r=="string")return m(r);let i=r,{queryParams:n,fragment:o,routeConfig:s,url:a,outlet:l,params:c,data:p,title:S}=e;return ie(W(t,()=>i({params:c,data:p,queryParams:n,fragment:o,routeConfig:s,url:a,outlet:l,title:S})))}var vr={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function _o(r,e,t,i,n){let o=Hi(r,e,t);return o.matched?(i=Qn(e,i),Io(i,e,t,n).pipe(f(s=>s===!0?o:v({},vr)))):m(o)}function Hi(r,e,t){if(e.path==="**")return Lo(t);if(e.path==="")return e.pathMatch==="full"&&(r.hasChildren()||t.length>0)?v({},vr):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let n=(e.matcher||Si)(t,r,e);if(!n)return v({},vr);let o={};Object.entries(n.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=n.consumed.length>0?v(v({},o),n.consumed[n.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:n.consumed,remainingSegments:t.slice(n.consumed.length),parameters:s,positionalParamSegments:n.posParams??{}}}function Lo(r){return{matched:!0,parameters:r.length>0?Ii(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}function mi(r,e,t,i){return t.length>0&&Uo(r,t,i)?{segmentGroup:new _(e,Co(i,new _(t,r.children))),slicedSegments:[]}:t.length===0&&Oo(r,t,i)?{segmentGroup:new _(r.segments,yo(r,t,i,r.children)),slicedSegments:t}:{segmentGroup:new _(r.segments,r.children),slicedSegments:t}}function yo(r,e,t,i){let n={};for(let o of t)if(Ft(r,e,o)&&!i[K(o)]){let s=new _([],{});n[K(o)]=s}return v(v({},i),n)}function Co(r,e){let t={};t[A]=e;for(let i of r)if(i.path===""&&K(i)!==A){let n=new _([],{});t[K(i)]=n}return t}function Uo(r,e,t){return t.some(i=>Ft(r,e,i)&&K(i)!==A)}function Oo(r,e,t){return t.some(i=>Ft(r,e,i))}function Ft(r,e,t){return(r.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function No(r,e,t){return e.length===0&&!r.children[t]}var Ir=class{};function Mo(r,e,t,i,n,o,s="emptyOnly"){return new Ar(r,e,t,i,n,s,o).recognize()}var Po=31,Ar=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,n,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=n,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Sr(this.urlSerializer,this.urlTree)}noMatchError(e){return new w(4002,`'${e.segmentGroup}'`)}recognize(){let e=mi(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(f(({children:t,rootSnapshot:i})=>{let n=new j(i,t),o=new Xe("",n),s=Oi(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new le([],Object.freeze({}),Object.freeze(v({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),A,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,A,t).pipe(f(i=>({children:i,rootSnapshot:t})),he(i=>{if(i instanceof tt)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof et?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,n,o){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,o):this.processSegment(e,t,i,i.segments,n,!0,o).pipe(f(s=>s instanceof j?[s]:[]))}processChildren(e,t,i,n){let o=[];for(let s of Object.keys(i.children))s==="primary"?o.unshift(s):o.push(s);return q(o).pipe(xe(s=>{let a=i.children[s],l=Wn(t,s);return this.processSegmentGroup(e,l,a,s,n)}),Br((s,a)=>(s.push(...a),s)),Jt(null),xr(),H(s=>{if(s===null)return me(i);let a=zi(s);return wo(a),m(a)}))}processSegment(e,t,i,n,o,s,a){return q(t).pipe(xe(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,i,n,o,s,a).pipe(he(c=>{if(c instanceof et)return m(null);throw c}))),P(l=>!!l),he(l=>{if(ki(l))return No(i,n,o)?m(new Ir):me(i);throw l}))}processSegmentAgainstRoute(e,t,i,n,o,s,a,l){return K(i)!==s&&(s===A||!Ft(n,o,i))?me(n):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,n,i,o,s,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,n,t,i,o,s,l):me(n)}expandSegmentAgainstRouteUsingRedirect(e,t,i,n,o,s,a){let{matched:l,parameters:c,consumedSegments:p,positionalParamSegments:S,remainingSegments:E}=Hi(t,n,o);if(!l)return me(t);typeof n.redirectTo=="string"&&n.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Po&&(this.allowRedirects=!1));let b=new le(o,c,Object.freeze(v({},this.urlTree.queryParams)),this.urlTree.fragment,gi(n),K(n),n.component??n._loadedComponent??null,n,Ri(n)),T=Nt(b,a,this.paramsInheritanceStrategy);return b.params=Object.freeze(T.params),b.data=Object.freeze(T.data),this.applyRedirects.applyRedirectCommands(p,n.redirectTo,S,b,e).pipe(y(C=>this.applyRedirects.lineralizeSegments(n,C)),H(C=>this.processSegment(e,i,t,C.concat(E),s,!1,a)))}matchSegmentAgainstRoute(e,t,i,n,o,s){let a=_o(t,i,n,e,this.urlSerializer);return i.path==="**"&&(t.children={}),a.pipe(y(l=>l.matched?(e=i._injector??e,this.getChildConfig(e,i,n).pipe(y(({routes:c})=>{let p=i._loadedInjector??e,{parameters:S,consumedSegments:E,remainingSegments:b}=l,T=new le(E,S,Object.freeze(v({},this.urlTree.queryParams)),this.urlTree.fragment,gi(i),K(i),i.component??i._loadedComponent??null,i,Ri(i)),F=Nt(T,s,this.paramsInheritanceStrategy);T.params=Object.freeze(F.params),T.data=Object.freeze(F.data);let{segmentGroup:C,slicedSegments:Gt}=mi(t,E,b,c);if(Gt.length===0&&C.hasChildren())return this.processChildren(p,c,C,T).pipe(f(I=>new j(T,I)));if(c.length===0&&Gt.length===0)return m(new j(T,[]));let vn=K(i)===o;return this.processSegment(p,c,C,Gt,vn?A:o,!0,T).pipe(f(I=>new j(T,I instanceof j?[I]:[])))}))):me(t)))}getChildConfig(e,t,i){return t.children?m({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?m({routes:t._loadedRoutes,injector:t._loadedInjector}):vo(e,t,i,this.urlSerializer).pipe(H(n=>n?this.configLoader.loadChildren(e,t).pipe(g(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):bo(t))):m({routes:[],injector:e})}};function wo(r){r.sort((e,t)=>e.value.outlet===A?-1:t.value.outlet===A?1:e.value.outlet.localeCompare(t.value.outlet))}function Do(r){let e=r.value.routeConfig;return e&&e.path===""}function zi(r){let e=[],t=new Set;for(let i of r){if(!Do(i)){e.push(i);continue}let n=e.find(o=>i.value.routeConfig===o.value.routeConfig);n!==void 0?(n.children.push(...i.children),t.add(n)):e.push(i)}for(let i of t){let n=zi(i.children);e.push(new j(i.value,n))}return e.filter(i=>!t.has(i))}function gi(r){return r.data||{}}function Ri(r){return r.resolve||{}}function Fo(r,e,t,i,n,o){return H(s=>Mo(r,e,t,i,s.extractedUrl,n,o).pipe(f(({state:a,tree:l})=>B(v({},s),{targetSnapshot:a,urlAfterRedirects:l}))))}function Vo(r,e){return H(t=>{let{targetSnapshot:i,guards:{canActivateChecks:n}}=t;if(!n.length)return m(t);let o=new Set(n.map(l=>l.route)),s=new Set;for(let l of o)if(!s.has(l))for(let c of Qi(l))s.add(c);let a=0;return q(s).pipe(xe(l=>o.has(l)?$o(l,i,r,e):(l.data=Nt(l,l.parent,r).resolve,m(void 0))),g(()=>a++),er(1),H(l=>a===s.size?m(t):ee))})}function Qi(r){let e=r.children.map(t=>Qi(t)).flat();return[r,...e]}function $o(r,e,t,i){let n=r.routeConfig,o=r._resolve;return n?.title!==void 0&&!Vi(n)&&(o[rt]=n.title),at(()=>(r.data=Nt(r,r.parent,t).resolve,xo(o,r,e,i).pipe(f(s=>(r._resolvedData=s,r.data=v(v({},r.data),s),null)))))}function xo(r,e,t,i){let n=ur(r);if(n.length===0)return m({});let o={};return q(n).pipe(H(s=>Bo(r[s],e,t,i).pipe(P(),g(a=>{if(a instanceof be)throw Mt(new ue,a);o[s]=a}))),er(1),f(()=>o),he(s=>ki(s)?ee:$e(s)))}function Bo(r,e,t,i){let n=_e(e)??i,o=ye(r,n),s=o.resolve?o.resolve(e,t):W(n,()=>o(e,t));return ie(s)}function lr(r){return y(e=>{let t=r(e);return t?q(t).pipe(f(()=>e)):m(e)})}var yr=(()=>{class r{buildTitle(t){let i,n=t.root;for(;n!==void 0;)i=this.getResolvedTitleForRoute(n)??i,n=n.children.find(o=>o.outlet===A);return i}getResolvedTitleForRoute(t){return t.data[rt]}static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:()=>d(Wi),providedIn:"root"})}return r})(),Wi=(()=>{class r extends yr{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||r)(tr(si))};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),ot=new z("",{providedIn:"root",factory:()=>({})}),st=new z(""),Ki=(()=>{class r{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=d(ii);loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return m(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let n=ie(W(t,()=>i.loadComponent())).pipe(f(Yi),y(Zi),g(s=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s}),lt(()=>{this.componentLoaders.delete(i)})),o=new Zt(n,()=>new V).pipe(Yt());return this.componentLoaders.set(i,o),o}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return m({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=Gi(i,this.compiler,t,this.onLoadEndListener).pipe(lt(()=>{this.childrenLoaders.delete(i)})),s=new Zt(o,()=>new V).pipe(Yt());return this.childrenLoaders.set(i,s),s}static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Gi(r,e,t,i){return ie(W(t,()=>r.loadChildren())).pipe(f(Yi),y(Zi),H(n=>n instanceof Gr||Array.isArray(n)?m(n):q(e.compileModuleAsync(n))),f(n=>{i&&i(r);let o,s,a=!1;return Array.isArray(n)?(s=n,a=!0):(o=n.create(t).injector,s=o.get(st,[],{optional:!0,self:!0}).flat()),{routes:s.map(Lr),injector:o}}))}function jo(r){return r&&typeof r=="object"&&"default"in r}function Yi(r){return jo(r)?r.default:r}function Zi(r){return m(r)}var Vt=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:()=>d(ko),providedIn:"root"})}return r})(),ko=(()=>{class r{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Xi=new z("");var Ji=new z(""),en=(()=>{class r{currentNavigation=je(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new V;transitionAbortWithErrorSubject=new V;configLoader=d(Ki);environmentInjector=d(Be);destroyRef=d(zr);urlSerializer=d(it);rootContexts=d(Le);location=d(ut);inputBindingEnabled=d(Dt,{optional:!0})!==null;titleStrategy=d(yr);options=d(ot,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=d(Vt);createViewTransition=d(Xi,{optional:!0});navigationErrorHandler=d(Ji,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>m(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=n=>this.events.next(new bt(n)),i=n=>this.events.next(new Tt(n));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;se(()=>{this.transitions?.next(B(v({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:i}))})}setupNavigations(t){return this.transitions=new h(null),this.transitions.pipe(N(i=>i!==null),y(i=>{let n=!1;return m(i).pipe(y(o=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",D.SupersededByNewNavigation),ee;this.currentTransition=i,this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?B(v({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()});let s=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!s&&a!=="reload")return this.events.next(new re(o.id,this.urlSerializer.serialize(o.rawUrl),"",Ke.IgnoredSameUrlNavigation)),o.resolve(!1),ee;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return m(o).pipe(y(l=>(this.events.next(new de(l.id,this.urlSerializer.serialize(l.extractedUrl),l.source,l.restoredState)),l.id!==this.navigationId?ee:Promise.resolve(l))),Fo(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),g(l=>{i.targetSnapshot=l.targetSnapshot,i.urlAfterRedirects=l.urlAfterRedirects,this.currentNavigation.update(p=>(p.finalUrl=l.urlAfterRedirects,p));let c=new Ge(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}));if(s&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:l,extractedUrl:c,source:p,restoredState:S,extras:E}=o,b=new de(l,this.urlSerializer.serialize(c),p,S);this.events.next(b);let T=Di(this.rootComponentType).snapshot;return this.currentTransition=i=B(v({},o),{targetSnapshot:T,urlAfterRedirects:c,extras:B(v({},E),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(F=>(F.finalUrl=c,F)),m(i)}else return this.events.next(new re(o.id,this.urlSerializer.serialize(o.extractedUrl),"",Ke.IgnoredByUrlHandlingStrategy)),o.resolve(!1),ee}),g(o=>{let s=new St(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(s)}),f(o=>(this.currentTransition=i=B(v({},o),{guards:eo(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),i)),ho(this.environmentInjector,o=>this.events.next(o)),g(o=>{if(i.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Mt(this.urlSerializer,o.guardsResult);let s=new vt(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(s)}),N(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",D.GuardRejected),!1)),lr(o=>{if(o.guards.canActivateChecks.length!==0)return m(o).pipe(g(s=>{let a=new It(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),y(s=>{let a=!1;return m(s).pipe(Vo(this.paramsInheritanceStrategy,this.environmentInjector),g({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(s,"",D.NoDataFromResolver)}}))}),g(s=>{let a=new At(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}))}),lr(o=>{let s=a=>{let l=[];if(a.routeConfig?.loadComponent){let c=_e(a)??this.environmentInjector;l.push(this.configLoader.loadComponent(c,a.routeConfig).pipe(g(p=>{a.component=p}),f(()=>{})))}for(let c of a.children)l.push(...s(c));return l};return O(s(o.targetSnapshot.root)).pipe(Jt(null),Q(1))}),lr(()=>this.afterPreactivation()),y(()=>{let{currentSnapshot:o,targetSnapshot:s}=i,a=this.createViewTransition?.(this.environmentInjector,o.root,s.root);return a?q(a).pipe(f(()=>i)):m(i)}),f(o=>{let s=Gn(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=i=B(v({},o),{targetRouterState:s}),this.currentNavigation.update(a=>(a.targetRouterState=s,a)),i}),g(()=>{this.events.next(new Ye)}),Jn(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Q(1),G(new wr(o=>{let s=i.abortController.signal,a=()=>o.next();return s.addEventListener("abort",a),()=>s.removeEventListener("abort",a)}).pipe(N(()=>!n&&!i.targetRouterState),g(()=>{this.cancelNavigationTransition(i,i.abortController.signal.reason+"",D.Aborted)}))),g({next:o=>{n=!0,this.lastSuccessfulNavigation=se(this.currentNavigation),this.events.next(new te(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{n=!0}}),G(this.transitionAbortWithErrorSubject.pipe(g(o=>{throw o}))),lt(()=>{n||this.cancelNavigationTransition(i,"",D.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),he(o=>{if(this.destroyed)return i.resolve(!1),ee;if(n=!0,ji(o))this.events.next(new Z(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode)),Xn(o)?this.events.next(new Ae(o.url,o.navigationBehaviorOptions)):i.resolve(!1);else{let s=new Ie(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);try{let a=W(this.environmentInjector,()=>this.navigationErrorHandler?.(s));if(a instanceof be){let{message:l,cancellationCode:c}=Mt(this.urlSerializer,a);this.events.next(new Z(i.id,this.urlSerializer.serialize(i.extractedUrl),l,c)),this.events.next(new Ae(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(s),o}catch(a){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(a)}}return ee}))}))}cancelNavigationTransition(t,i,n){let o=new Z(t.id,this.urlSerializer.serialize(t.extractedUrl),i,n);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=se(this.currentNavigation),n=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==n?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function qo(r){return r!==ze}var tn=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:()=>d(Ho),providedIn:"root"})}return r})(),wt=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},Ho=(()=>{class r extends wt{static \u0275fac=(()=>{let t;return function(n){return(t||(t=ir(r)))(n||r)}})();static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),rn=(()=>{class r{urlSerializer=d(it);options=d(ot,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=d(ut);urlHandlingStrategy=d(Vt);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new X;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:n}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=n??o;return s instanceof X?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:n}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,n),this.routerState=t):this.rawUrlTree=n}routerState=Di(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:()=>d(zo),providedIn:"root"})}return r})(),zo=(()=>{class r extends rn{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof de?this.updateStateMemento():t instanceof re?this.commitTransition(i):t instanceof Ge?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Ye?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Z&&t.code!==D.SupersededByNewNavigation&&t.code!==D.Redirect?this.restoreHistory(i):t instanceof Ie?this.restoreHistory(i,!0):t instanceof te&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:n}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,l=v(v({},s),this.generateNgRouterState(n,a));this.location.replaceState(t,"",l)}else{let a=v(v({},s),this.generateNgRouterState(n,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let n=this.browserPageId,o=this.currentPageId-n;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(n){return(t||(t=ir(r)))(n||r)}})();static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Cr(r,e){r.events.pipe(N(t=>t instanceof te||t instanceof Z||t instanceof Ie||t instanceof re),f(t=>t instanceof te||t instanceof re?0:(t instanceof Z?t.code===D.Redirect||t.code===D.SupersededByNewNavigation:!1)?2:1),N(t=>t!==2),Q(1)).subscribe(()=>{e()})}var Qo={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Wo={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ce=(()=>{class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=d(Zr);stateManager=d(rn);options=d(ot,{optional:!0})||{};pendingTasks=d(Qr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=d(en);urlSerializer=d(it);location=d(ut);urlHandlingStrategy=d(Vt);injector=d(Be);_events=new V;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=d(tn);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=d(st,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!d(Dt,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Mr;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let n=this.navigationTransitions.currentTransition,o=se(this.navigationTransitions.currentNavigation);if(n!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Z&&i.code!==D.Redirect&&i.code!==D.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof te)this.navigated=!0;else if(i instanceof Ae){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,n.currentRawUrl),l=v({browserUrl:n.extras.browserUrl,info:n.extras.info,skipLocationChange:n.extras.skipLocationChange,replaceUrl:n.extras.replaceUrl||this.urlUpdateStrategy==="eager"||qo(n.source)},s);this.scheduleNavigation(a,ze,null,l,{resolve:n.resolve,reject:n.reject,promise:n.promise})}}zn(i)&&this._events.next(i)}catch(n){this.navigationTransitions.transitionAbortWithErrorSubject.next(n)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ze,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,n)=>{this.navigateToSyncWithBrowser(t,n,i)})}navigateToSyncWithBrowser(t,i,n){let o={replaceUrl:!0},s=n?.navigationId?n:null;if(n){let l=v({},n);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(l=>{this.disposed||this.injector.get(rr)(l)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return se(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Lr),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:n,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:s,p=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":p=v(v({},this.currentUrlTree.queryParams),o);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=o||null}p!==null&&(p=this.removeEmptyProps(p));let S;try{let E=n?n.snapshot:this.routerState.snapshot.root;S=Ni(E)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),S=this.currentUrlTree.root}return Mi(S,t,p,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){let n=ve(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(o,ze,null,i)}navigate(t,i={skipLocationChange:!1}){return Ko(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let n;if(i===!0?n=v({},Qo):i===!1?n=v({},Wo):n=i,ve(t))return hi(this.currentUrlTree,t,n);let o=this.parseUrl(t);return hi(this.currentUrlTree,o,n)}removeEmptyProps(t){return Object.entries(t).reduce((i,[n,o])=>(o!=null&&(i[n]=o),i),{})}scheduleNavigation(t,i,n,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((S,E)=>{a=S,l=E});let p=this.pendingTasks.add();return Cr(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(S=>Promise.reject(S))}static \u0275fac=function(i){return new(i||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Ko(r){for(let e=0;e<r.length;e++)if(r[e]==null)throw new w(4008,!1)}var Yo=new z("");function Zo(r,...e){return qr([{provide:st,multi:!0,useValue:r},[],{provide:J,useFactory:Xo,deps:[Ce]},{provide:Jr,multi:!0,useFactory:Jo},e.map(t=>t.\u0275providers)])}function Xo(r){return r.routerState.root}function Jo(){let r=d(Hr);return e=>{let t=r.get(ei);if(e!==t.components[0])return;let i=r.get(Ce),n=r.get(es);r.get(ts)===1&&i.initialNavigation(),r.get(rs,null,{optional:!0})?.setUpPreloading(),r.get(Yo,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),n.closed||(n.next(),n.complete(),n.unsubscribe())}}var es=new z("",{factory:()=>new V}),ts=new z("",{providedIn:"root",factory:()=>1});var rs=new z("");var $t=class r{http=d(fe);baseUrl="https://wakfu.cdn.ankama.com/gamedata/";getConfig(){return this.http.get(this.baseUrl+"config.json")}getItems(e){return this.http.get(this.baseUrl+e+"/items.json")}getActions(e){return this.http.get(this.baseUrl+e+"/actions.json")}getStates(e){return this.http.get(this.baseUrl+e+"/states.json")}getRecipesResult(e){return this.http.get(this.baseUrl+e+"/recipeResults.json")}getJobsItems(e){return this.http.get(this.baseUrl+e+"/jobsItems.json")}getRecipeIngredients(e){return this.http.get(this.baseUrl+e+"/recipeIngredients.json")}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var nn=(I=>(I[I.LE_DIANINE=24700]="LE_DIANINE",I[I.LE_DORRRRE=24610]="LE_DORRRRE",I[I.LE_JALM=24593]="LE_JALM",I[I.LA_FLOUFF=24607]="LA_FLOUFF",I[I.L_ATTENTIONNEE=24551]="L_ATTENTIONNEE",I[I.LA_GAINE=24566]="LA_GAINE",I[I.LA_ZEOR=24668]="LA_ZEOR",I[I.LE_CONDOTTIER=24513]="LE_CONDOTTIER",I[I.LES_OPRESSANTES=24524]="LES_OPRESSANTES",I[I.LE_FOUIP=24601]="LE_FOUIP",I[I.LE_FELDSPATH=24615]="LE_FELDSPATH",I[I.LES_MELLES=24538]="LES_MELLES",I[I.LE_FAINNE=24585]="LE_FAINNE",I[I.LA_PROMESSE=24537]="LA_PROMESSE",I[I.LE_LIEUTE=24505]="LE_LIEUTE",I[I.LE_PELO=24521]="LE_PELO",I[I.LE_TIG=24488]="LE_TIG",I[I.LE_CABOT=24426]="LE_CABOT",I[I.LA_BASTOS=24408]="LA_BASTOS",I))(nn||{}),on=r=>Object.values(nn).includes(r);var xt=class r{ankamaCdnService=d($t);static MEDAILLE_BRAVOURE_ITEM_ID=24705;config=new h("");config$=this.config.asObservable().pipe(N(e=>e.length>0));action=new h([]);action$=this.action.asObservable().pipe(N(e=>e.length>0));item=new h([]);item$=this.item.asObservable().pipe(N(e=>e.length>0));states=new h([]);states$=this.states.asObservable().pipe(N(e=>e.length>0));recipes=new h([]);recipes$=this.recipes.asObservable().pipe(N(e=>e.length>0));idSiouperes=new h([]);idSiouperes$=this.idSiouperes.asObservable().pipe(N(e=>e.length>0));recipeIngredients=new h([]);recipeIngredients$=this.recipeIngredients.asObservable().pipe(N(e=>e.length>0));mapProductItemIdToRecipeResult=new Map;mapRecipeIdToRecipeIngredients=new Map;loadItems(e){this.ankamaCdnService.getItems(e).pipe(g(t=>this.item.next(t))).subscribe()}loadActions(e){this.ankamaCdnService.getActions(e).pipe(g(t=>this.action.next(t))).subscribe()}loadStates(e){this.ankamaCdnService.getStates(e).pipe(g(t=>this.states.next(t))).subscribe()}loadRecipeIngredients(e){this.ankamaCdnService.getRecipeIngredients(e).pipe(g(t=>this.recipeIngredients.next(t)),g(t=>{t.forEach(i=>{let n=this.mapRecipeIdToRecipeIngredients.get(i.recipeId)||[];n.push(i),this.mapRecipeIdToRecipeIngredients.set(i.recipeId,n)})})).subscribe()}loadRecipesResult(e){this.ankamaCdnService.getRecipesResult(e).pipe(g(t=>this.recipes.next(t)),g(t=>{t.forEach(i=>{this.mapProductItemIdToRecipeResult.set(i.productedItemId,i)})})).subscribe()}loadIdSioupere(e){this.ankamaCdnService.getJobsItems(e).pipe(f(t=>t.filter(i=>i.title.fr.toLowerCase().includes("sioup\xE8re"))),g(t=>this.idSiouperes.next(t))).subscribe()}load(){this.ankamaCdnService.getConfig().pipe(g(e=>this.config.next(e.version)),g(e=>this.loadItems(e.version)),g(e=>this.loadActions(e.version)),g(e=>this.loadStates(e.version)),g(e=>this.loadRecipesResult(e.version)),g(e=>this.loadIdSioupere(e.version)),g(e=>this.loadRecipeIngredients(e.version))).subscribe()}getActionList(){return this.action.getValue()}getStatesList(){return this.states.getValue()}isItemPvP(e){if(on(e))return!0;let t=this.mapProductItemIdToRecipeResult.get(e);return t?(this.mapRecipeIdToRecipeIngredients.get(t.recipeId)||[]).some(n=>n.itemId===r.MEDAILLE_BRAVOURE_ITEM_ID):!1}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var oe=class r{imageService=d(dt);itemTypes=new Map([[1,{ids:[101,111,114,117,223,253]}],[2,{ids:[108,110,113,115,254]}],[3,{ids:[103]}],[4,{ids:[119]}],[5,{ids:[120]}],[6,{ids:[132]}],[7,{ids:[133]}],[8,{ids:[134]}],[9,{ids:[136]}],[10,{ids:[138]}],[11,{ids:[646]}],[12,{ids:[189]}],[13,{ids:[112]}],[14,{ids:[582]}]]);getItemTypes(){return this.itemTypes}getItemType(e){let t;return this.itemTypes.forEach((i,n)=>{i.ids.includes(e)&&(t=n)}),t}getLogo(e){return e?this.imageService.mapUrlItemType.get(e)??"":""}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Bt=class r{http=d(fe);monsterDrops=new h([]);monsterDrops$=this.monsterDrops.asObservable();loadPromise;load(){return this.loadPromise?this.loadPromise:(this.loadPromise=new Promise(e=>{this.http.get("/monstres_drops_gfx.json").pipe(g(t=>this.monsterDrops.next(t)),pe(1)).subscribe({next:()=>e(),error:t=>{console.error("Failed to load monster drops:",t),this.monsterDrops.next([]),e()}})}),this.loadPromise)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Or=(C=>(C.POIDS="POIDS",C.MAITRISES="MAITRISES",C.RESISTANCES="RESISTANCES",C.EQUILIBRE="EQUILIBRE",C.PARADE_ARMURE_DONNEE="PARADE_ARMURE_DONNEE",C.POINT_DE_VIE="POINT_DE_VIE",C.TACLE="TACLE",C.ESQUIVE="ESQUIVE",C.TACLE_ESQUIVE="TACLE_ESQUIVE",C.CRITIQUE="CRITIQUE",C.PARADE="PARADE",C.CRITIQUE_PARADE="CRITIQUE_PARADE",C.PA="PA",C.PM="PM",C.PO="PO",C.PW="PW",C))(Or||{});var Ue=class r extends L{itemTypeServices=d(oe);selected=new h([]);selected$=this.selected.asObservable();keyEnum="KEY_ITEM_TYPE";form=new $({deuxMains:new u,uneMain:new u,anneau:new u,bottes:new u,amulette:new u,cape:new u,ceinture:new u,casque:new u,plastron:new u,epaulettes:new u,bouclier:new u,dague:new u,accessoires:new u,familier:new u});constructor(){super(),this.init()}handleChanges(e){let t=[];e.uneMain&&t.push(this.itemTypeServices.getItemTypes().get(2)?.ids),e.deuxMains&&t.push(this.itemTypeServices.getItemTypes().get(1)?.ids),e.anneau&&t.push(this.itemTypeServices.getItemTypes().get(3)?.ids),e.bottes&&t.push(this.itemTypeServices.getItemTypes().get(4)?.ids),e.amulette&&t.push(this.itemTypeServices.getItemTypes().get(5)?.ids),e.cape&&t.push(this.itemTypeServices.getItemTypes().get(6)?.ids),e.ceinture&&t.push(this.itemTypeServices.getItemTypes().get(7)?.ids),e.casque&&t.push(this.itemTypeServices.getItemTypes().get(8)?.ids),e.plastron&&t.push(this.itemTypeServices.getItemTypes().get(9)?.ids),e.epaulettes&&t.push(this.itemTypeServices.getItemTypes().get(10)?.ids),e.bouclier&&t.push(this.itemTypeServices.getItemTypes().get(12)?.ids),e.dague&&t.push(this.itemTypeServices.getItemTypes().get(13)?.ids),e.accessoires&&t.push(this.itemTypeServices.getItemTypes().get(11)?.ids),e.familier&&t.push(this.itemTypeServices.getItemTypes().get(14)?.ids),this.selected.next(t.flat())}setValue(e){this.form.setValue({deuxMains:e?.deuxMains??!1,uneMain:e?.uneMain??!1,anneau:e?.anneau??!1,bottes:e?.bottes??!1,amulette:e?.amulette??!1,cape:e?.cape??!1,ceinture:e?.ceinture??!1,casque:e?.casque??!1,plastron:e?.plastron??!1,epaulettes:e?.epaulettes??!1,bouclier:e?.bouclier??!1,dague:e?.dague??!1,accessoires:e?.accessoires??!1,familier:e?.familier??!1})}setDefaultValue(){this.setItemType()}setItemType(...e){this.form.setValue({deuxMains:e.includes(1),uneMain:e.includes(2),anneau:e.includes(3),bottes:e.includes(4),amulette:e.includes(5),cape:e.includes(6),ceinture:e.includes(7),casque:e.includes(8),plastron:e.includes(9),epaulettes:e.includes(10),bouclier:e.includes(12),dague:e.includes(13),accessoires:e.includes(11),familier:e.includes(14)})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var jt=class r extends L{static DEFAULT_VALUE="MAITRISES";sort=new h(r.DEFAULT_VALUE);sort$=this.sort.asObservable();keyEnum="KEY_SORT_CHOICE";form=new u(r.DEFAULT_VALUE,{nonNullable:!0});constructor(){super(),this.init()}handleChanges(e){this.sort.next(e)}setValue(e){this.form.setValue(e??r.DEFAULT_VALUE)}setDefaultValue(){this.form.setValue(r.DEFAULT_VALUE)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Oe=class r extends L{static DEFAULT_VALUE=!1;onlyNoSecondary=new h(!1);onlyNoSecondary$=this.onlyNoSecondary.asObservable();keyEnum="KEY_ONLY_NO_SECONDARY";form=new u(r.DEFAULT_VALUE,{nonNullable:!0});constructor(){super(),this.init()}handleChanges(e){this.onlyNoSecondary.next(e??!1)}setValue(e){this.form.setValue(e??r.DEFAULT_VALUE)}setDefaultValue(){this.form.setValue(r.DEFAULT_VALUE)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ne=class r extends L{idMajor=new h([]);idMajor$=this.idMajor.asObservable();keyEnum="KEY_MAJOR_PRESENT";form=new $({PA:new u,PM:new u,PW:new u,PO:new u,CONTROLE:new u,ARMURE_DONNEE:new u,ARMURE_RECUE:new u,CRITIQUE:new u,PARADE:new u,RESISTANCE_DOS:new u,RESISTANCE_CRITIQUE:new u,PERTE_PA:new u,PERTE_PM:new u,PERTE_PW:new u,PERTE_PO:new u,PERTE_CONTROLE:new u,PERTE_ARMURE_DONNEE:new u,PERTE_ARMURE_RECUE:new u,PERTE_CRITIQUE:new u,PERTE_PARADE:new u,PERTE_RESISTANCE_DOS:new u,PERTE_RESISTANCE_CRITIQUE:new u,PERTE_MAITRISES_MELEE:new u,PERTE_MAITRISES_DISTANCE:new u,PERTE_MAITRISES_CRITIQUE:new u,PERTE_MAITRISES_DOS:new u,PERTE_MAITRISES_SOIN:new u,PERTE_MAITRISES_BERZERK:new u});constructor(){super(),this.init()}handleChanges(e){let t=[];e.PA&&t.push({id:31}),e.PM&&t.push({id:41}),e.PW&&t.push({id:191}),e.PO&&t.push({id:160}),e.CONTROLE&&t.push({id:184}),e.ARMURE_DONNEE&&t.push({id:39,parameter:120}),e.ARMURE_RECUE&&t.push({id:39,parameter:121}),e.CRITIQUE&&t.push({id:150}),e.PARADE&&t.push({id:875}),e.RESISTANCE_DOS&&t.push({id:71}),e.RESISTANCE_CRITIQUE&&t.push({id:988}),e.PERTE_PA&&t.push({id:56}),e.PERTE_PM&&t.push({id:57}),e.PERTE_PW&&t.push({id:192}),e.PERTE_PO&&t.push({id:161}),e.PERTE_CONTROLE&&t.push({id:-1}),e.PERTE_ARMURE_DONNEE&&t.push({id:40,parameter:120}),e.PERTE_ARMURE_RECUE&&t.push({id:40,parameter:121}),e.PERTE_CRITIQUE&&t.push({id:168}),e.PERTE_PARADE&&t.push({id:876}),e.PERTE_RESISTANCE_DOS&&t.push({id:1063}),e.PERTE_RESISTANCE_CRITIQUE&&t.push({id:1062}),e.PERTE_MAITRISES_MELEE&&t.push({id:1059}),e.PERTE_MAITRISES_DISTANCE&&t.push({id:1060}),e.PERTE_MAITRISES_CRITIQUE&&t.push({id:1056}),e.PERTE_MAITRISES_DOS&&t.push({id:181}),e.PERTE_MAITRISES_SOIN&&t.push({id:-1}),e.PERTE_MAITRISES_BERZERK&&t.push({id:1061}),this.idMajor.next(t)}setValue(e){this.form.setValue({PA:e?.PA??!1,PM:e?.PM??!1,PW:e?.PW??!1,PO:e?.PO??!1,CONTROLE:e?.CONTROLE??!1,ARMURE_DONNEE:e?.ARMURE_DONNEE??!1,ARMURE_RECUE:e?.ARMURE_RECUE??!1,CRITIQUE:e?.CRITIQUE??!1,PARADE:e?.PARADE??!1,RESISTANCE_DOS:e?.RESISTANCE_DOS??!1,RESISTANCE_CRITIQUE:e?.RESISTANCE_CRITIQUE??!1,PERTE_PA:e?.PERTE_PA??!1,PERTE_PM:e?.PERTE_PM??!1,PERTE_PW:e?.PERTE_PW??!1,PERTE_PO:e?.PERTE_PO??!1,PERTE_CONTROLE:e?.PERTE_CONTROLE??!1,PERTE_ARMURE_DONNEE:e?.PERTE_ARMURE_DONNEE??!1,PERTE_ARMURE_RECUE:e?.PERTE_ARMURE_RECUE??!1,PERTE_CRITIQUE:e?.PERTE_CRITIQUE??!1,PERTE_PARADE:e?.PERTE_PARADE??!1,PERTE_RESISTANCE_DOS:e?.PERTE_RESISTANCE_DOS??!1,PERTE_RESISTANCE_CRITIQUE:e?.PERTE_RESISTANCE_CRITIQUE??!1,PERTE_MAITRISES_MELEE:e?.PERTE_MAITRISES_MELEE??!1,PERTE_MAITRISES_DISTANCE:e?.PERTE_MAITRISES_DISTANCE??!1,PERTE_MAITRISES_CRITIQUE:e?.PERTE_MAITRISES_CRITIQUE??!1,PERTE_MAITRISES_DOS:e?.PERTE_MAITRISES_DOS??!1,PERTE_MAITRISES_SOIN:e?.PERTE_MAITRISES_SOIN??!1,PERTE_MAITRISES_BERZERK:e?.PERTE_MAITRISES_BERZERK??!1})}setDefaultValue(){this.setMajor()}setMajor(...e){this.form.setValue({PA:e.some(t=>t.id===31),PM:e.some(t=>t.id===41),PW:e.some(t=>t.id===191),PO:e.some(t=>t.id===160),CONTROLE:e.some(t=>t.id===184),ARMURE_DONNEE:e.some(t=>t.id===39&&t.parameter===120),ARMURE_RECUE:e.some(t=>t.id===39&&t.parameter===121),CRITIQUE:e.some(t=>t.id===150),PARADE:e.some(t=>t.id===875),RESISTANCE_DOS:e.some(t=>t.id===71),RESISTANCE_CRITIQUE:e.some(t=>t.id===988),PERTE_PA:e.some(t=>t.id===56),PERTE_PM:e.some(t=>t.id===57),PERTE_PW:e.some(t=>t.id===192),PERTE_PO:e.some(t=>t.id===161),PERTE_CONTROLE:e.some(t=>t.id===-1),PERTE_ARMURE_DONNEE:e.some(t=>t.id===40&&t.parameter===120),PERTE_ARMURE_RECUE:e.some(t=>t.id===40&&t.parameter===121),PERTE_CRITIQUE:e.some(t=>t.id===168),PERTE_PARADE:e.some(t=>t.id===876),PERTE_RESISTANCE_DOS:e.some(t=>t.id===1063),PERTE_RESISTANCE_CRITIQUE:e.some(t=>t.id===1062),PERTE_MAITRISES_MELEE:e.some(t=>t.id===1059),PERTE_MAITRISES_DISTANCE:e.some(t=>t.id===1060),PERTE_MAITRISES_CRITIQUE:e.some(t=>t.id===1056),PERTE_MAITRISES_DOS:e.some(t=>t.id===181),PERTE_MAITRISES_SOIN:e.some(t=>t.id===-1),PERTE_MAITRISES_BERZERK:e.some(t=>t.id===1061)})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var sn=(n=>(n.COEUR_HUPPERMAGE="COEUR_HUPPERMAGE",n.DENOUEMENT="DENOUEMENT",n.DEMESURE="DEMESURE",n.CHAOS="CHAOS",n))(sn||{});var Me=class r extends L{static DEFAULT_VALUE=[];multiplicateurElem=new h(1);multiplicateurElem$=this.multiplicateurElem.asObservable();denouement=new h(!1);denouement$=this.denouement.asObservable();demesure=new h(!1);demesure$=this.demesure.asObservable();chaos=new h(!1);chaos$=this.chaos.asObservable();keyEnum="KEY_MODIFIER_MECANISM";form=new u(r.DEFAULT_VALUE,{nonNullable:!0});constructor(){super(),this.init()}handleChanges(e){let t=1;e?.includes("COEUR_HUPPERMAGE".valueOf())&&(t*=1.2),this.multiplicateurElem.next(t),this.denouement.next(e?.includes("DENOUEMENT".valueOf())??!1),this.demesure.next(e?.includes("DEMESURE".valueOf())??!1),this.chaos.next(e?.includes("CHAOS".valueOf())??!1)}setValue(e){this.form.setValue(e??r.DEFAULT_VALUE)}setDefaultValue(){this.form.setValue(r.DEFAULT_VALUE)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Pe=class r extends L{static DEFAULT_LEVEL_MIN=200;static DEFAULT_LEVEL_MAX=245;selected=new h([]);selected$=this.selected.asObservable();levelMin=new h(r.DEFAULT_LEVEL_MIN);levelMin$=this.levelMin.asObservable();levelMax=new h(r.DEFAULT_LEVEL_MAX);levelMax$=this.levelMax.asObservable();keyEnum="KEY_ITEM_LEVEL";form=new $({levelMin:new u(r.DEFAULT_LEVEL_MIN,{nonNullable:!0}),levelMax:new u(r.DEFAULT_LEVEL_MAX,{nonNullable:!0})});constructor(){super(),this.init()}handleChanges(e){this.levelMin.next(e.levelMin??r.DEFAULT_LEVEL_MIN),this.levelMax.next(e.levelMax??r.DEFAULT_LEVEL_MAX)}setValue(e){this.form.setValue({levelMin:e?.levelMin??r.DEFAULT_LEVEL_MIN,levelMax:e?.levelMax??r.DEFAULT_LEVEL_MAX})}setDefaultValue(){this.form.setValue({levelMin:r.DEFAULT_LEVEL_MIN,levelMax:r.DEFAULT_LEVEL_MAX})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var we=class r extends L{selected=new h([]);selected$=this.selected.asObservable();rarity=new h([]);rarity$=this.rarity.asObservable();keyEnum="KEY_RARETE_ITEM";form=new $({normal:new u,rare:new u,mythique:new u,legendaire:new u,souvenir:new u,relique:new u,epique:new u});constructor(){super(),this.init()}handleChanges(e){let t=[];e.normal&&t.push(1),e.rare&&t.push(2),e.mythique&&t.push(3),e.legendaire&&t.push(4),e.relique&&t.push(5),e.souvenir&&t.push(6),e.epique&&t.push(7),this.rarity.next(t)}setValue(e){this.form.setValue({normal:e?.normal??!1,rare:e?.rare??!1,mythique:e?.mythique??!1,legendaire:e?.legendaire??!1,souvenir:e?.souvenir??!1,relique:e?.relique??!1,epique:e?.epique??!1})}setRarity(...e){this.form.setValue({normal:e.includes(1),rare:e.includes(2),mythique:e.includes(3),legendaire:e.includes(4),relique:e.includes(5),souvenir:e.includes(6),epique:e.includes(7)})}setDefaultValue(){this.setRarity()}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var qt=class r extends L{rareteItemFormServices=d(we);itemTypeFormServices=d(Ue);itemTypeService=d(oe);itemLevelFormService=d(Pe);majorPresentFormService=d(Ne);static DEFAULT_VALUE="";itemName=new h("");itemName$=this.itemName.asObservable();keyEnum="KEY_SEARCH_ITEM_NAME";form=new u(r.DEFAULT_VALUE,{nonNullable:!0});constructor(){super(),this.init()}handleChanges(e){this.itemName.next(e??r.DEFAULT_VALUE)}setValue(e){this.form.setValue(e??r.DEFAULT_VALUE)}setDefaultValue(){this.form.setValue(r.DEFAULT_VALUE)}setFilter(e){this.rareteItemFormServices.setDefaultValue(),this.majorPresentFormService.setDefaultValue();let t=this.itemTypeService.getItemType(e.itemTypeId);if(t)if(this.itemTypeFormServices.setItemType(t),e.level<=20)this.itemLevelFormService.setValue({levelMin:0,levelMax:20});else{let i=Math.ceil((e.level-20)/15);this.itemLevelFormService.setValue({levelMin:(i-1)*15+20+1,levelMax:i*15+20})}}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var De=class r extends L{idResistances=new h([]);idResistances$=this.idResistances.asObservable();keyEnum="KEY_RESISTANCES";form=new $({feu:new u,eau:new u,terre:new u,air:new u});constructor(){super(),this.init()}handleChanges(e){let t=[];e.feu&&t.push(82),e.eau&&t.push(83),e.terre&&t.push(84),e.air&&t.push(85),this.idResistances.next(t)}setValue(e){this.form.setValue({feu:e?.feu??!1,eau:e?.eau??!1,terre:e?.terre??!1,air:e?.air??!1})}setResistances(...e){this.form.setValue({feu:e.includes(82),eau:e.includes(83),terre:e.includes(84),air:e.includes(85)})}setDefaultValue(){this.setResistances()}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Fe=class r extends L{nbElements=new h(0);nbElements$=this.nbElements.asObservable();idMaitrises=new h([]);idMaitrises$=this.idMaitrises.asObservable();keyEnum="KEY_MAITRISES";form=new $({feu:new u,eau:new u,terre:new u,air:new u,critique:new u,dos:new u,melee:new u,distance:new u,soin:new u,berzerk:new u});constructor(){super(),this.init()}handleChanges(e){let t=0,i=[];e.feu&&(t++,i.push(122)),e.eau&&(t++,i.push(124)),e.terre&&(t++,i.push(123)),e.air&&(t++,i.push(125)),this.nbElements.next(t),e.critique&&i.push(149),e.dos&&i.push(180),e.melee&&i.push(1052),e.distance&&i.push(1053),e.soin&&i.push(26),e.berzerk&&i.push(1055),this.idMaitrises.next(i)}setValue(e){this.form.setValue({feu:e?.feu??!1,eau:e?.eau??!1,terre:e?.terre??!1,air:e?.air??!1,critique:e?.critique??!1,dos:e?.dos??!1,melee:e?.melee??!1,distance:e?.distance??!1,soin:e?.soin??!1,berzerk:e?.berzerk??!1})}setDefaultValue(){this.setMaitrises()}setMaitrises(...e){this.form.setValue({feu:e.includes(122),eau:e.includes(124),terre:e.includes(123),air:e.includes(125),critique:e.includes(149),dos:e.includes(180),melee:e.includes(1052),distance:e.includes(1053),soin:e.includes(26),berzerk:e.includes(1055)})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ve=class r extends L{static DEFAULT_VALUE=!1;onlyNoElem=new h(!1);onlyNoElem$=this.onlyNoElem.asObservable();keyEnum="KEY_ONLY_NO_ELEM";form=new u(r.DEFAULT_VALUE,{nonNullable:!0});constructor(){super(),this.init()}handleChanges(e){this.onlyNoElem.next(e??!1)}setValue(e){this.form.setValue(e??r.DEFAULT_VALUE)}setDefaultValue(){this.form.setValue(r.DEFAULT_VALUE)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ht=class r extends L{static DEFAULT_VALUE=!1;reverse=new h(r.DEFAULT_VALUE);reverse$=this.reverse.asObservable();keyEnum="KEY_REVERSE";form=new u(r.DEFAULT_VALUE,{nonNullable:!0});constructor(){super(),this.init()}handleChanges(e){this.reverse.next(e??r.DEFAULT_VALUE)}setValue(e){this.form.setValue(e??r.DEFAULT_VALUE)}setDefaultValue(){this.form.setValue(r.DEFAULT_VALUE)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};function an(r){switch(r){case 1:return 1;case 2:return 3;case 3:return 4;case 4:return 6;case 5:return 7;case 6:return 10;case 7:return 15;case 8:return 19;case 9:return 24;case 10:return 30;case 11:return 33;default:return 0}}function ln(r){switch(r){case 1:return 2;case 2:return 5;case 3:return 7;case 4:return 10;case 5:return 12;case 6:return 15;case 7:return 17;case 8:return 20;case 9:return 22;case 10:return 25;case 11:return 27;default:return 0}}var zt=class r extends L{static DEFAULT_VALUE_DROP=!0;static DEFAULT_VALUE_CRAFTABLE=!0;static DEFAULT_VALUE_BOSS=!0;static DEFAULT_VALUE_ARCHI=!0;static DEFAULT_VALUE_PVP=!0;drop=new h(r.DEFAULT_VALUE_DROP);drop$=this.drop.asObservable();craftable=new h(r.DEFAULT_VALUE_CRAFTABLE);craftable$=this.craftable.asObservable();boss=new h(r.DEFAULT_VALUE_BOSS);boss$=this.boss.asObservable();archi=new h(r.DEFAULT_VALUE_ARCHI);archi$=this.archi.asObservable();pvp=new h(r.DEFAULT_VALUE_PVP);pvp$=this.pvp.asObservable();keyEnum="KEY_OBTENTION";form=new $({DROP:new u,CRAFTABLE:new u,BOSS:new u,ARCHI:new u,PVP:new u});constructor(){super(),this.init()}handleChanges(e){this.drop.next(!e.DROP),this.craftable.next(!e.CRAFTABLE),this.boss.next(!e.BOSS),this.archi.next(!e.ARCHI),this.pvp.next(!e.PVP)}setValue(e){this.form.setValue({DROP:e?.DROP??r.DEFAULT_VALUE_DROP,CRAFTABLE:e?.CRAFTABLE??r.DEFAULT_VALUE_CRAFTABLE,BOSS:e?.BOSS??r.DEFAULT_VALUE_BOSS,ARCHI:e?.ARCHI??r.DEFAULT_VALUE_ARCHI,PVP:e?.PVP??r.DEFAULT_VALUE_PVP})}setDefaultValue(){this.setValue({DROP:r.DEFAULT_VALUE_DROP,CRAFTABLE:r.DEFAULT_VALUE_CRAFTABLE,BOSS:r.DEFAULT_VALUE_BOSS,ARCHI:r.DEFAULT_VALUE_ARCHI,PVP:r.DEFAULT_VALUE_PVP})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var cn=(E=>(E[E.EMBLEME_SHUSHU_1=18670]="EMBLEME_SHUSHU_1",E[E.EMBLEME_SHUSHU_2=18671]="EMBLEME_SHUSHU_2",E[E.EMBLEME_SHUSHU_3=18672]="EMBLEME_SHUSHU_3",E[E.EMBLEME_SHUSHU_4=18673]="EMBLEME_SHUSHU_4",E[E.EMBLEME_SHUSHU_5=18674]="EMBLEME_SHUSHU_5",E[E.EMBLEME_SHUSHU_6=18675]="EMBLEME_SHUSHU_6",E[E.EMBLEME_SHUSHU_7=18676]="EMBLEME_SHUSHU_7",E[E.EMBLEME_SHUSHU_8=18677]="EMBLEME_SHUSHU_8",E[E.EMBLEME_SHUSHU_9=18678]="EMBLEME_SHUSHU_9",E[E.EMBLEME_SHUSHU_10=18679]="EMBLEME_SHUSHU_10",E[E.EMBLEME_SHUSHU_11=18680]="EMBLEME_SHUSHU_11",E[E.EMBLEME_SHUSHU_12=18681]="EMBLEME_SHUSHU_12",E))(cn||{}),un=r=>Object.values(cn).includes(r);var Qt=class r{itemTypeFormServices=d(Ue);translateService=d(ci);onlyNoSecondaryFormService=d(Oe);sortChoiceFormService=d(jt);majorPresentFormService=d(Ne);modifierElemMaitrisesFormService=d(Me);searchItemNameFormService=d(qt);rareteItemFormService=d(we);itemLevelFormService=d(Pe);resistanceFormService=d(De);maitrisesFormService=d(Fe);ankamaCdnFacade=d(xt);onlyNoElemFormService=d(Ve);reverseFormService=d(Ht);obtentionFormService=d(zt);monsterDropService=d(Bt);static ARMURE_DONNEE_RECUE_LIST=[39,40];static RESISTANCE_ELEM_IDS=[85,83,84,82];static MALUS_RESIS_ELEM_IDS=[97,96,98];static MAITRISES_ELEM_IDS=[122,123,124,125];static PERTE_MAITRISES_IDS=[130,132];static EQUILIBRE_RESISTANCE_MULTIPLIER=1.2;static DEFAULT_NB_ELEMENTS=4;idPierresList=[29847,29848,29849,29850,29851];LEVEL_RATIOS=[{maxLevel:36,ratio:this.truncate2(1/2)},{maxLevel:51,ratio:this.truncate2(3/5)},{maxLevel:66,ratio:this.truncate2(4/7)},{maxLevel:81,ratio:this.truncate2(6/10)},{maxLevel:96,ratio:this.truncate2(7/12)},{maxLevel:126,ratio:this.truncate2(10/15)},{maxLevel:141,ratio:this.truncate2(15/17)},{maxLevel:171,ratio:this.truncate2(19/20)},{maxLevel:186,ratio:this.truncate2(24/22)},{maxLevel:216,ratio:this.truncate2(30/25)}];items=[];fullItems$=new h([]);items$;itemsFilterByItemName$;itemsFilters$;recipesByProductId=new Map;itemsByName=new Map;monsterDropsByItemId=new Map;archiIds=new Set;sublimations=new h([]);sublimations$=this.sublimations.asObservable();isLoading=je(!0);init(){this.initItemsList(),this.initFilter();let e=O([this.itemsFilters$,this.maitrisesFormService.nbElements$,this.maitrisesFormService.idMaitrises$,this.sortChoiceFormService.sort$,this.modifierElemMaitrisesFormService.multiplicateurElem$,this.modifierElemMaitrisesFormService.denouement$,this.resistanceFormService.idResistances$,this.onlyNoElemFormService.onlyNoElem$,this.onlyNoSecondaryFormService.onlyNoSecondary$,this.modifierElemMaitrisesFormService.chaos$]).pipe(g(([t,i,n,o,s,a,l,c,p,S])=>this.fillItemWeightMap(t,i,n,o,s,l,a,c,p,S)),f(([t])=>t));this.items$=O([e,this.reverseFormService.reverse$]).pipe(f(([t,i])=>{let n=t.sort(this.sortItems());return i?n.reverse():n}),g(()=>this.isLoading.set(!1)),pe(1)),this.items$.pipe(Q(1)).subscribe()}sortItems(){return(e,t)=>t.weightForSort>e.weightForSort?1:t.weightForSort===e.weightForSort?t.weight-e.weight:-1}isNotWIP(e){return!!e.title}filterObtention(e,t,i,n,o,s){let a=e.isCraftable&&!i;return a=a||e.mobDropable.length>0&&!t,a=a||e.bossDropable.length>0&&!n,a=a||e.archiDropable.length>0&&!o,a=a||e.isPvP&&!s,a=a||e.mobDropable.length===0&&e.bossDropable.length===0&&e.archiDropable.length===0&&!e.isCraftable&&!e.isPvP,a}loadSublimations(){let t=this.items.filter(i=>i.itemTypeId===812).filter(i=>i.enchantement.isEpic||i.enchantement.isRelic||["I","II","III"].includes(i.title.fr.split(" ").pop()||"")).sort((i,n)=>i.title.fr.localeCompare(n.title.fr));this.sublimations.next(t),console.log(`Loaded ${t.length} sublimations`,t),this.prepareJsonSublimations(t)}prepareJsonSublimations(e){let t=[],i=new Map;e.forEach(n=>{if(n.enchantement.isEpic||n.enchantement.isRelic)i.set(n.title.fr,[n]);else{let o=n.title.fr.replace(/ I{1,3}$| II$| III$/,"").trim();i.has(o)||i.set(o,[]),i.get(o)?.push(n)}}),i.forEach(n=>{let o=[];n.forEach(p=>{if(p.enchantement.isEpic||p.enchantement.isRelic)o.push({id:p.id,level:1});else{let S=p.title.fr.endsWith(" III")?3:p.title.fr.endsWith(" II")?2:1;o.push({id:p.id,level:S})}});let s=0,a=n[0];if(!a.enchantement.isEpic&&!a.enchantement.isRelic){let p=a.description.fr.slice(a.description.fr.length-2,a.description.fr.length-1);s=Number.parseInt(p||"0")}let l=a.enchantement.isEpic||a.enchantement.isRelic,c=[];t.push({linkSublimation:o,title:{fr:l?n[0].title.fr:n[0].title.fr.replace(/ I{1,3}$| II$| III$/,"").trim(),en:l?n[0].title.en:n[0].title.en.replace(/ I{1,3}$| II$| III$/,"").trim(),es:l?n[0].title.es:n[0].title.es.replace(/ I{1,3}$| II$| III$/,"").trim(),pt:l?n[0].title.pt:n[0].title.pt.replace(/ I{1,3}$| II$| III$/,"").trim()},description:{fr:"",en:"",es:"",pt:""},levelMax:s,baseEffect:c,id:o[0].id,gfxId:a.idImage,isEpic:a.enchantement.isEpic,isRelic:a.enchantement.isRelic,slotColorPattern:a.enchantement.slotColorPattern})}),console.log(t)}initFilter(){this.items=this.items.filter(c=>![480,811,812].includes(c.itemTypeId)).filter(c=>this.isNotWIP(c)),this.fullItems$.next(this.items),this.itemsFilterByItemName$=O([this.fullItems$,this.searchItemNameFormService.itemName$]).pipe(f(([c,p])=>c.filter(S=>this.normalizeString(S.title[this.translateService.currentLang].toString()).includes(this.normalizeString(p)))));let e=O([this.itemsFilterByItemName$,this.obtentionFormService.drop$,this.obtentionFormService.craftable$,this.obtentionFormService.boss$,this.obtentionFormService.archi$,this.obtentionFormService.pvp$]).pipe(f(([c,p,S,E,b,T])=>c.filter(F=>this.filterObtention(F,p,S,E,b,T)))),t=O([e,this.itemLevelFormService.levelMin$]).pipe(f(([c,p])=>c.filter(S=>S.level>=p||S.itemTypeId===582))),i=O([t,this.itemLevelFormService.levelMax$]).pipe(f(([c,p])=>c.filter(S=>S.level<=p||S.itemTypeId===582))),n=O([i,this.rareteItemFormService.rarity$]).pipe(f(([c,p])=>c.filter(S=>p.length===0||p.includes(S.rarity)))),o=O([n,this.onlyNoElemFormService.onlyNoElem$]).pipe(f(([c,p])=>c.filter(S=>!p||!S.equipEffects.find(E=>[122,124,123,125,120,1068].includes(E.actionId))))),s=O([o,this.onlyNoSecondaryFormService.onlyNoSecondary$,this.modifierElemMaitrisesFormService.denouement$,this.onlyNoElemFormService.onlyNoElem$]).pipe(f(([c,p,S,E])=>c.filter(b=>!p||!b.equipEffects.find(T=>[180,1052,1053,26,1055].includes(T.actionId))&&(S&&!E||!b.equipEffects.find(T=>T.actionId===149))))),a=O([s,this.majorPresentFormService.idMajor$]).pipe(f(([c,p])=>c.filter(S=>this.majorIsPresent(p,S)))),l=O([a,this.modifierElemMaitrisesFormService.demesure$]).pipe(f(([c,p])=>c.filter(S=>!p||S.equipEffects.find(E=>[875,150].includes(E.actionId)))));this.itemsFilters$=O([l,this.itemTypeFormServices.selected$]).pipe(f(([c,p])=>c.filter(S=>p.length===0||p.includes(S.itemTypeId))))}normalizeString(e){return e.normalize("NFKD").replace(/['''`]/g,"'").replace(/\s+/g," ").trim().toLowerCase()}fillItemWeightMap(e,t,i,n,o,s,a,l,c,p){let S=0,E=0;e.forEach(b=>{b.resistance=Math.trunc(this.calculResistancesForAnItem(b,s)),b.maitrise=Math.trunc(this.calculMaitrisesForAnItem(b,t,i,o,a,l,c,p)),b.weight=this.calculWeight(b.resistance,b.maitrise,b.level),b.weightForSort=0}),n==="EQUILIBRE"&&e.length&&(S=e.sort((b,T)=>T.maitrise-b.maitrise)[0].maitrise,E=e.sort((b,T)=>T.resistance-b.resistance)[0].resistance),e.forEach(b=>{let T=this.createEffectsMap(b);b.weightForSort=this.calculateWeightForSort(b,n,T,S,E)})}createEffectsMap(e){let t=new Map;return e.equipEffects.forEach(i=>{t.set(i.actionId,i.params[0])}),t}calculateWeightForSort(e,t,i,n,o){switch(t){case"POIDS":return e.weight;case"MAITRISES":return e.maitrise;case"EQUILIBRE":return e.maitrise/n+r.EQUILIBRE_RESISTANCE_MULTIPLIER*(e.resistance/o);case"POINT_DE_VIE":return this.calculateNetEffect(i,20,21);case"PARADE_ARMURE_DONNEE":return this.calculateParadeArmureDonnee(e,i);case"TACLE":return this.calculateNetEffect(i,173,174);case"ESQUIVE":return this.calculateNetEffect(i,175,176);case"TACLE_ESQUIVE":return this.calculateNetEffect(i,173,174)+this.calculateNetEffect(i,175,176);case"CRITIQUE":return this.calculateNetEffect(i,150,168);case"PARADE":return this.calculateNetEffect(i,875,876);case"CRITIQUE_PARADE":return this.calculateNetEffect(i,150,168)+this.calculateNetEffect(i,875,876);case"PA":return this.calculateNetEffect(i,31,56);case"PM":return this.calculateNetEffect(i,41,57);case"PO":return this.calculateNetEffect(i,160,161);case"PW":return this.calculateNetEffect(i,193,194)+this.calculateNetEffect(i,191,192);default:return e.resistance}}calculateParadeArmureDonnee(e,t){let i=t.get(875)??0;return e.equipEffects.forEach(n=>{n.actionId===39&&n.params[4]===120&&(i+=n.params[0])}),i}getEffectValue(e,t){return e.get(t)??0}calculateNetEffect(e,t,i){return this.getEffectValue(e,t)-this.getEffectValue(e,i)}calculWeight(e,t,i){return Math.trunc(this.ratioWeightByLevel(i)*e+t)}ratioWeightByLevel(e){return this.LEVEL_RATIOS.find(i=>e<i.maxLevel)?.ratio??this.truncate2(33/27)}truncate2(e){return Math.trunc(e*100)/100}initItemsList(){O([this.ankamaCdnFacade.item$,this.ankamaCdnFacade.recipes$,this.ankamaCdnFacade.idSiouperes$,this.monsterDropService.monsterDrops$]).pipe(Q(1),g(([e,t,i,n])=>{e.filter(o=>!un(o.definition.item.id)).forEach(o=>this.items.push({id:o.definition.item.id,level:o.definition.item.level,rarity:o.definition.item.baseParameters.rarity,itemTypeId:o.definition.item.baseParameters.itemTypeId,equipEffects:o.definition.equipEffects.map(s=>({id:s.effect.definition.id,actionId:s.effect.definition.actionId,params:s.effect.definition.params})),title:{fr:o.title.fr.trim(),en:o.title.en.trim(),es:o.title.es.trim(),pt:o.title.pt.trim()},description:o.description,idImage:o.definition.item.graphicParameters.gfxId,weightForSort:0,weight:0,maitrise:0,resistance:0,isCraftable:!1,mobDropable:[],bossDropable:[],archiDropable:[],isPvP:!1,enchantement:{slotColorPattern:o.definition.item.sublimationParameters?.slotColorPattern??[],isEpic:o.definition.item.sublimationParameters?.isEpic??!1,isRelic:o.definition.item.sublimationParameters?.isRelic??!1}})),this.buildIndexes(t,n,i),this.items.forEach(o=>this.calculItemIsCraftable(o)),this.items.forEach(o=>this.calculItemIsDropable(o)),this.items.forEach(o=>this.calculIsItemPvP(o))})).subscribe()}buildIndexes(e,t,i){for(let n of e)this.recipesByProductId.set(n.productedItemId,n);for(let n of this.items)this.itemsByName.has(n.title.fr)||this.itemsByName.set(n.title.fr,[]),this.itemsByName.get(n.title.fr).push(n);for(let n of t)for(let o of n.idsDrop)this.monsterDropsByItemId.has(o)||this.monsterDropsByItemId.set(o,[]),this.monsterDropsByItemId.get(o).push(n);for(let n of i)this.archiIds.add(n.definition.id)}calculIsItemPvP(e){if(!this.ankamaCdnFacade.isItemPvP(e.id))return;let i=this.itemsByName.get(e.title.fr);i&&i.forEach(n=>n.isPvP=!0)}calculItemIsCraftable(e){if(e.isCraftable||!this.recipesByProductId.get(e.id))return;if(e.rarity===6){e.isCraftable=!0;return}let i=this.itemsByName.get(e.title.fr);if(!(!i||i.some(o=>e.level<=35?o.rarity<e.rarity:o.rarity<e.rarity&&o.level>=35)))for(let o of i)o.isCraftable=!0}calculItemIsDropable(e){if(e.mobDropable.length)return;let t=this.monsterDropsByItemId.get(e.id);if(!t||t.length===0)return;let i=t.filter(s=>s.idsDrop.some(a=>this.idPierresList.includes(a))),n=t.filter(s=>s.idsDrop.some(a=>this.archiIds.has(a))).filter(s=>!i.includes(s));if(t=t.filter(s=>!i.includes(s)&&!n.includes(s)),e.rarity===6){t.length&&(e.mobDropable=t),i.length&&(e.bossDropable=i),n.length&&(e.archiDropable=n);return}let o=this.itemsByName.get(e.title.fr);if(o)for(let s of o)s.rarity!==6&&((s.rarity!==1||s.level<=35)&&s.level>=e.level&&t.length&&(s.mobDropable=t),i.length&&(s.bossDropable=i),n.length&&(s.archiDropable=n))}searchItem(e){return this.fullItems$.pipe(f(t=>t.find(i=>i.id===e)))}getItem(e){return this.fullItems$.value.find(t=>t.id===e)}majorIsPresent(e,t){return!e.find(i=>!r.ARMURE_DONNEE_RECUE_LIST.includes(i.id)&&!t.equipEffects.map(n=>n.actionId).includes(i.id)||i.id===39&&!t.equipEffects.find(n=>n.actionId===39&&n.params[4]===i.parameter)||i.id===40&&!t.equipEffects.find(n=>n.actionId===40&&n.params[4]===i.parameter))}calculResistancesForAnItem(e,t){let i=0,n=t.length===0?r.DEFAULT_NB_ELEMENTS:t.length;return e.equipEffects.forEach(o=>{o.actionId===1069&&o.params[2]>=t.length?i+=o.params[0]*Math.min(o.params[2],n):o.actionId===80?i+=o.params[0]*n:o.actionId===90||o.actionId===100?i-=o.params[0]*n:r.RESISTANCE_ELEM_IDS.includes(o.actionId)&&(n===r.DEFAULT_NB_ELEMENTS||t.includes(o.actionId))?i+=o.params[0]:(n===r.DEFAULT_NB_ELEMENTS&&r.MALUS_RESIS_ELEM_IDS.includes(o.actionId)||o.actionId===97&&t.includes(82)||o.actionId===96&&t.includes(84)||o.actionId===98&&t.includes(83))&&(i-=o.params[0])}),i}calculMaitrisesForAnItem(e,t,i,n,o,s,a,l){let c=0,p=[...i].filter(E=>!r.MAITRISES_ELEM_IDS.includes(E));e.equipEffects.forEach(E=>{!s&&!l&&(E.actionId===120||E.actionId===1068&&E.params[2]>=t||E.actionId===149&&o)?c+=E.params[0]*n:!a&&p.includes(E.actionId)?c+=E.params[0]:(!s&&!l&&r.PERTE_MAITRISES_IDS.includes(E.actionId)||!a&&(E.actionId===1056&&i.includes(149)||E.actionId===181&&i.includes(180)||E.actionId===1059&&i.includes(1052)||E.actionId===1060&&i.includes(1053)||E.actionId===1061&&i.includes(1055)))&&(c-=E.params[0])});let S=e.equipEffects.find(E=>r.MAITRISES_ELEM_IDS.includes(E.actionId)&&(t===0||t===1&&i.includes(E.actionId)));return!s&&!l&&S&&(c+=S.params[0]*n),c}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var dn=class r{overlay=d(li);overlayRefs=[];mouseEnter$=new V;mouseLeave$=new V;destroy$=new V;keepOpenOnHover=!1;constructor(){this.mouseLeave$.pipe(y(()=>{let e=this.keepOpenOnHover?100:0;return $r(e).pipe(G(this.mouseEnter$),G(this.destroy$))})).subscribe(()=>{this.forceClose()})}closeTooltip(){this.mouseLeave$.next()}cancelClose(){this.mouseEnter$.next()}forceClose(){this.overlayRefs.forEach(e=>e.dispose()),this.overlayRefs=[],this.keepOpenOnHover=!1}openTooltip(e,t,i,n,o,s=!0,a=!1){this.cancelClose(),this.keepOpenOnHover=a;let l=o;l||(l=[{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetY:80}]);let c=this.overlay.position().flexibleConnectedTo(i.target).withPositions(l).withPush(s),p=this.overlay.create({positionStrategy:c,hasBackdrop:!1,panelClass:"no-max-width",scrollStrategy:this.overlay.scrollStrategies.reposition()}),S=new ai(t,e),E=p.attach(S);if(E.instance&&Object.assign(E.instance,n),a){let b=p.overlayElement,T=new V,F=new V;b.addEventListener("mouseenter",()=>{T.next(),this.cancelClose()}),b.addEventListener("mouseleave",()=>{F.next(),this.closeTooltip()}),p.detachments().subscribe(()=>{T.complete(),F.complete()})}return this.overlayRefs.push(p),p}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.mouseEnter$.complete(),this.mouseLeave$.complete(),this.forceClose()}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Wt=class r{sublimations=new Map;sublimationsClassique=[];sublimationsEpiqueRelique=[];http=d(fe);loadPromise;load(){return this.loadPromise?this.loadPromise:(this.loadPromise=new Promise(e=>{this.http.get("/sublimations.json").pipe(g(t=>t.forEach(i=>this.sublimations.set(i.title.fr,i))),g(t=>this.sublimationsClassique.push(...t.filter(i=>!i.isEpic&&!i.isRelic))),g(t=>this.sublimationsEpiqueRelique.push(...t.filter(i=>i.isEpic||i.isRelic))),pe(1)).subscribe({next:()=>e(),error:t=>{console.error("Failed to load sublimations:",t),e()}})}),this.loadPromise)}getSublimations(){return this.sublimationsClassique}getSublimationsEpiqueRelique(){return this.sublimationsEpiqueRelique}getSublimationById(e){for(let t of this.sublimations.values())if(t.id===e)return t}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};function Kt(){let r=[];for(let e=0;e<4;e++)r.push({color:-1,lvl:0});return{chasses:r,sublimation:void 0}}function hn(r){switch(r){case 1:return 3;case 2:return 6;case 3:return 9;case 4:return 12;case 5:return 15;case 6:return 21;case 7:return 30;case 8:return 39;case 9:return 48;case 10:return 60;case 11:return 66;default:return 0}}function pn(r){switch(r){case 1:return 2;case 2:return 4;case 3:return 6;case 4:return 8;case 5:return 10;case 6:return 14;case 7:return 20;case 8:return 26;case 9:return 32;case 10:return 40;case 11:return 44;default:return 0}}function En(r){switch(r){case 1:return 4;case 2:return 8;case 3:return 12;case 4:return 16;case 5:return 20;case 6:return 28;case 7:return 40;case 8:return 52;case 9:return 64;case 10:return 80;case 11:return 88;default:return 0}}function fn(r){switch(r){case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 7;case 7:return 10;case 8:return 13;case 9:return 16;case 10:return 20;case 11:return 22;default:return 0}}var mn=class r extends L{static DEFAULT_VALUE=()=>{let e=[];for(let t=0;t<10;t++)e.push(Kt());return{chasseCombinaison:e}};recapChassesEffect=new h([]);recapChassesEffect$=this.recapChassesEffect.asObservable();enchantement=new h(r.DEFAULT_VALUE());enchantement$=this.enchantement.asObservable();sublimationsIdToLevel=new h(new Map);sublimationsIdToLevel$=this.sublimationsIdToLevel.asObservable();keyEnum="KEY_ENCHANTEMENT";form=new u(r.DEFAULT_VALUE(),{nonNullable:!0});sublimationService=d(Wt);indexToItemType=new Map([[0,8],[1,5],[2,9],[3,3],[4,3],[5,4],[6,6],[7,10],[8,7],[9,2]]);doubleEffect=new Map([[120,[9,6]],[26,[5,10]],[1052,[8,6]],[1053,[7,2]],[1055,[5,6]],[149,[10,2]],[180,[7,4]],[173,[3,3]],[175,[3,3]],[171,[5,6]],[82,[9,7]],[83,[9,10]],[85,[9,6]],[84,[9,4]],[20,[8,2]]]);constructor(){super(),this.init()}equalChasses(e,t){return e.color===t.color&&e.lvl===t.lvl&&e.idAction===t.idAction}removeEpic(){let e=this.getValue();e.epique=void 0,this.setValue(e)}removeRelic(){let e=this.getValue();e.relique=void 0,this.setValue(e)}applySublimationEpicRelic(e){let t=this.getValue();e.epique?(t.epique={id:e.id,idImage:e.idImage,title:v({},e.title),epique:!0,relique:!1},this.setValue(t)):e.relique&&(t.relique={id:e.id,idImage:e.idImage,title:v({},e.title),epique:!1,relique:!0},this.setValue(t))}applySumblimation(e,t){let i=this.getValue(),o=i.chasseCombinaison[e];o.sublimation=t,o.sublimation.isValid=this.canApplySublimation(o,t),this.setValue(i)}removeSublimation(e){let t=this.getValue(),n=t.chasseCombinaison[e];n.sublimation=void 0,this.setValue(t)}applyEffect(e,t,i){let n=this.getValue(),s=n.chasseCombinaison[t];this.equalChasses(s.chasses[e],i)?this.clearEffect(e,t):s.chasses[e]=i,s.sublimation&&(s.sublimation.isValid=this.canApplySublimation(s,s.sublimation)),this.setValue(n)}clearChasseCombinaison(e){let t=this.getValue(),i=t.chasseCombinaison;i[e]=Kt(),this.setValue(t)}clearEffect(e,t){let i=this.getValue(),o=i.chasseCombinaison[t];o.chasses[e]=Kt().chasses[0],o.sublimation&&(o.sublimation.isValid=this.canApplySublimation(o,o.sublimation)),this.setValue(i)}changeJokerState(e,t){let i=this.getValue(),n=[...i.chasseCombinaison],o=v({},n[t]),s=[...o.chasses],a=v({},s[e]);a.idAction&&(a.joker=!a.joker,s[e]=a,o.chasses=s,n[t]=o,this.setValue(B(v({},i),{chasseCombinaison:n})))}getChasseEffectValue(e){return e.idAction?[173,175].includes(e.idAction)?hn(e.lvl):[171].includes(e.idAction)?pn(e.lvl):[20].includes(e.idAction)?En(e.lvl):[120].includes(e.idAction)?fn(e.lvl):[26,1052,1053,1055,149,180].includes(e.idAction)?an(e.lvl):[82,83,85,84].includes(e.idAction)?ln(e.lvl):0:0}handleChanges(e){let t=[];e.chasseCombinaison.forEach((o,s)=>{o.chasses.forEach(a=>{if(!a.idAction)return;let l=this.indexToItemType.get(s);if(!l)return;let c=this.doubleEffect.get(a.idAction)?.includes(l)?2:1;t.push({id:a.idAction,value:c*this.getChasseEffectValue(a),params:[]})})});let i=e.chasseCombinaison.filter(o=>!!o.sublimation).map(o=>o.sublimation),n=this.calculMaxSublimationLevel(i);e.epique&&n.set(e.epique.id,1),e.relique&&n.set(e.relique.id,1),this.sublimationsIdToLevel.next(n),this.enchantement.next(e),this.recapChassesEffect.next(t)}calculMaxSublimationLevel(e){let t=new Map;return e.forEach(i=>{let n=t.get(i.id);n===void 0?t.set(i.id,i.level):t.set(i.id,n+i.level)}),t.forEach((i,n)=>{let o=this.sublimationService.getSublimationById(n)?.levelMax;o!==void 0&&i>o&&t.set(n,Math.min(i,o))}),t}setValue(e){let t=e??r.DEFAULT_VALUE();this.form.setValue(t),this.enchantement.next(t)}setDefaultValue(){this.form.setValue(r.DEFAULT_VALUE())}getValue(){return this.enchantement.getValue()}canApplySublimationWithItem(e,t){return this.canApplySublimation(e,{id:t.id,title:v({},t.title),slotColorPattern:t.slotColorPattern,isValid:!1,level:t.linkSublimation[0].level})}canApplySublimation(e,t){let i=e.chasses,n=t.slotColorPattern;if(n.length>i.length)return!1;for(let o=0;o<=i.length-n.length;o++)if(this.matchPattern(i,n,o))return!0;return!1}matchPattern(e,t,i){for(let n=0;n<t.length;n++){let o=e[i+n],s=t[n];if(o.color===-1)return!1;if(!(o.joker&&this.isValidJokerReplacement(s))&&o.color!==s)return!1}return!0}isValidJokerReplacement(e){return e===3||e===1||e===2}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var gn=class r{neoImageMap=new Map([[1115705791,"n\xE9o/neo-bouftou-royal.png"],[1115705800,"n\xE9o/neo-chene-mou.png"],[1115705797,"n\xE9o/neo-corbeau-noir.png"],[1115705795,"n\xE9o/neo-gligli-royal.png"],[1115705794,"n\xE9o/neo-goel-le-golem.png"],[1115705799,"n\xE9o/neo-kya-missiz-frizz.png"],[1115705793,"n\xE9o/neo-moogr-royale.png"],[1115705806,"n\xE9o/neo-ogrest.png"],[1115705805,"n\xE9o/neo-pandore.png"],[1115705792,"n\xE9o/neo-piou-royal.png"],[1115705804,"n\xE9o/neo-remington-smisse.png"],[1115705796,"n\xE9o/neo-vampyro.png"],[1115705803,"n\xE9o/neo-wa-wabbit.png"]]);imageMap=new Map([[1111105448,"mob/ydalipe.png"],[-1,"mob/bilbygirl.png"],[11,"mob/bilbyboy.png"],[126002474,"mob/gelee-reglisse.png"],[40,"mob/assassin-encapuchonne.png"],[-2,"mob/protecteur-encapuchonne.png"],[107700210,"mob/ratchitik.png"],[1111105445,"mob/lela.png"],[1111105447,"mob/erpel.png"],[1111105446,"mob/eenca.png"],[107702129,"mob/ratagasd-le-marron.png"],[121801632,"mob/moumoute-la-postiche.png"],[128401429,"mob/scaraboss.png"],[128401430,"mob/scarafon.png"],[128401431,"mob/scaramel.png"],[128401432,"mob/scarabruni.png"]]);onError(e){if(e instanceof HTMLImageElement){let t=e.src.split("/").pop()?.split(".").shift(),i=t?this.neoImageMap.get(+t):null,n=t?this.imageMap.get(+t):null;e.src=i??n??dt.IMAGE_ERROR}}static \u0275fac=function(t){return new(t||r)};static \u0275dir=ct({type:r,selectors:[["img","appFallback",""]],hostBindings:function(t,i){t&1&&ri("error",function(o){return i.onError(o.target)})}})};var Rn=class r{mapColors=new Map([[2,"#4c9646"],[3,"#dd7f13"],[4,"#ffef64"],[5,"#c570ef"],[6,"#80d6d4"],[7,"#eebcd7"]]);static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Sn=class r extends di{itemTypeService=d(oe);itemService=d(Qt);router=d(Ce);activatedRoute=d(J);localStorageService=d(ui);modifierElemMaitrisesFormService=d(Me);resistancesFormService=d(De);maitrisesFormService=d(Fe);onlyNoElemFormService=d(Ve);onlyNoSecondaryFormService=d(Oe);mapItem=new Map([[2,new h([void 0])],[3,new h([void 0,void 0])],[4,new h([void 0])],[5,new h([void 0])],[6,new h([void 0])],[7,new h([void 0])],[8,new h([void 0])],[9,new h([void 0])],[10,new h([void 0])],[11,new h([void 0])],[12,new h([void 0])],[14,new h([void 0])]]);idItems=new h("");idItems$=this.idItems.asObservable();totalWeight=new h(0);totalWeight$=this.totalWeight.asObservable();listItem=new h([]);listItem$=this.listItem.asObservable();totalMaitrises=new h(0);totalMaitrises$=this.totalMaitrises.asObservable();totalResistances=new h(0);totalResistances$=this.totalResistances.asObservable();indexAnneau=0;constructor(){super(),setTimeout(()=>{this.initItemChooses(),this.updateUrl()}),this.handleCalculTotal()}handleCalculTotal(){O([this.listItem$,this.maitrisesFormService.nbElements$,this.maitrisesFormService.idMaitrises$,this.modifierElemMaitrisesFormService.multiplicateurElem$,this.modifierElemMaitrisesFormService.denouement$,this.resistancesFormService.idResistances$,this.onlyNoElemFormService.onlyNoElem$,this.onlyNoSecondaryFormService.onlyNoSecondary$,this.modifierElemMaitrisesFormService.chaos$]).pipe(G(this.destroy$),g(([e,t,i,n,o,s,a,l,c])=>this.calculTotal(e,t,i,n,s,o,a,l,c))).subscribe()}updateUrl(){O([this.getObsItem(2),this.getObsItem(3),this.getObsItem(4),this.getObsItem(5),this.getObsItem(6),this.getObsItem(7),this.getObsItem(8),this.getObsItem(9),this.getObsItem(10),this.getObsItem(11),this.getObsItem(12),this.getObsItem(14)]).pipe(G(this.destroy$),f(e=>e.flat()),f(e=>e.filter(t=>t!=null)),g(e=>this.listItem.next([...new Set(e)])),f(e=>e.map(t=>t?.id)),f(e=>e.filter(t=>t).join(",")),g(e=>this.setIdItems(e))).subscribe(e=>{this.localStorageService.setItem("KEY_BUILD",e),this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:{itemsId:e},queryParamsHandling:"merge"})})}initItemChooses(){this.activatedRoute.queryParams.pipe(G(this.destroy$),N(e=>e!==void 0),f(e=>e.itemsId?e.itemsId:this.localStorageService.getItem("KEY_BUILD")),N(e=>e!=null),Q(1),f(e=>e.split(",")),g(e=>e.forEach(t=>this.setItemWithIdItem(parseInt(t))))).subscribe()}calculTotal(e,t,i,n,o,s,a,l,c){let p=0,S=0,E=0;e.forEach(b=>{let T=this.itemService.calculResistancesForAnItem(b,o),F=this.itemService.calculMaitrisesForAnItem(b,t,i,n,s,a,l,c);S+=T,E+=F,p+=this.itemService.calculWeight(T,F,b.level)}),this.totalWeight.next(Math.trunc(p)),this.totalMaitrises.next(Math.trunc(E)),this.totalResistances.next(Math.trunc(S))}setItemWithIdItem(e){this.itemService.searchItem(e).pipe(P(),N(t=>t!==void 0)).subscribe(t=>{let i=this.itemTypeService.getItemType(t.itemTypeId);i&&this.setItem(i,t,!1)})}cleanItemChoosen(){this.indexAnneau=0,this.mapItem.forEach((e,t)=>{e.next(t===3?[void 0,void 0]:[void 0])})}setIdItemsFromBuild(e){this.cleanItemChoosen(),this.idItems.next(e);let t=e.split(",");t&&t.forEach(i=>{let n=this.itemService.getItem(parseInt(i));if(!n)return;let o=this.itemTypeService.getItemType(n.itemTypeId);o&&this.setItem(o,n,!1)})}setIdItems(e){this.idItems.next(e)}getObsItem(e){return this.mapItem.get(e)?.asObservable()??m()}deleteItem(e,t){this.getObsItem(e).pipe(P(),y(i=>Xt(()=>i!==void 0&&!!i[0]?.itemTypeId&&this.itemTypeService.getItemType(i[0]?.itemTypeId)===1,m(i).pipe(g(()=>{this.mapItem.get(12)?.next([void 0]),this.mapItem.get(2)?.next([void 0])})),m(i).pipe(f(n=>(n[t]=void 0,n)),g(n=>this.mapItem.get(e)?.next(n)))))).subscribe()}setItem(e,t,i=!0){m(null).pipe(P(),y(()=>Xt(()=>i,this.deleteItemInBuild(t).pipe(N(n=>!n)),m(null))),y(()=>this.ensureUniqueRelic(t)),y(()=>this.ensureCompatibleWithSecondHand(e,t)),y(()=>this.ensureCompatibleWithFirstHand(e,t)),y(()=>this.handleRings(e,t)),y(()=>this.handleDeuxMains(e,t)),y(()=>this.finalEquip(e,t))).subscribe()}ensureUniqueRelic(e){return[7,5].includes(e.rarity)?this.deleteFirstItemOnRarity(e.rarity):m(null)}ensureCompatibleWithSecondHand(e,t){return[13,12].includes(e)?this.getObsItem(2).pipe(P(),g(()=>this.mapItem.get(12)?.next([t])),f(i=>i[0]),N(i=>i!==void 0&&this.itemTypeService.getItemType(i.itemTypeId)===1),g(()=>this.mapItem.get(2)?.next([void 0])),f(()=>null)):m(null)}ensureCompatibleWithFirstHand(e,t){return e!==2?m(null):this.getObsItem(12).pipe(P(),g(()=>this.mapItem.get(2)?.next([t])),f(i=>i[0]),N(i=>i!==void 0&&this.itemTypeService.getItemType(i.itemTypeId)===1),g(()=>this.mapItem.get(12)?.next([void 0])),f(()=>null))}handleRings(e,t){return e!==3?m(null):this.getObsItem(3).pipe(P(),y(i=>i.find(n=>n?.title===t.title)?m(null):m(i).pipe(f(n=>{let o=[...n];return o[this.indexAnneau]=t,o}),g(n=>this.mapItem.get(3)?.next(n)),g(()=>this.indexAnneau=this.indexAnneau===0?1:0))),f(()=>null))}handleDeuxMains(e,t){return e!==1?m(null):m(null).pipe(g(()=>{this.mapItem.get(12)?.next([t]),this.mapItem.get(2)?.next([t])}))}finalEquip(e,t){return e===3?m(null):m(null).pipe(g(()=>this.mapItem.get(e)?.next([t])))}deleteFirstItemOnRarity(e){return O([this.getObsItem(2),this.getObsItem(3),this.getObsItem(4),this.getObsItem(5),this.getObsItem(6),this.getObsItem(7),this.getObsItem(8),this.getObsItem(9),this.getObsItem(10),this.getObsItem(11),this.getObsItem(12),this.getObsItem(14)]).pipe(P(),f(t=>t.filter(i=>i.find(n=>n?.rarity===e))),g(t=>t.forEach(i=>{let n=i.find(s=>s!==void 0)?.itemTypeId;if(!n)return;let o=this.itemTypeService.getItemType(n);if(o===1)this.mapItem.get(2)?.next([void 0]),this.mapItem.get(12)?.next([void 0]);else if(o===13)this.mapItem.get(12)?.next([void 0]);else if(o===3){let s=i.findIndex(a=>a?.rarity===e);this.indexAnneau=s,i[s]=void 0,this.mapItem.get(3)?.next(i)}else o!==void 0&&this.mapItem.get(o)?.next([void 0])})),f(()=>null))}deleteItemInBuild(e){let t=!1;return O([this.getObsItem(2),this.getObsItem(3),this.getObsItem(4),this.getObsItem(5),this.getObsItem(6),this.getObsItem(7),this.getObsItem(8),this.getObsItem(9),this.getObsItem(10),this.getObsItem(11),this.getObsItem(12),this.getObsItem(14)]).pipe(P(),f(i=>i.filter(n=>n.find(o=>o?.id===e.id))),g(i=>i.forEach(n=>{let o=n.find(a=>a!==void 0)?.itemTypeId;if(!o)return;t=!0;let s=this.itemTypeService.getItemType(o);if(s===1)this.mapItem.get(2)?.next([void 0]),this.mapItem.get(12)?.next([void 0]);else if(s===13)this.mapItem.get(12)?.next([void 0]);else if(s===3){let a=n.findIndex(l=>l?.id===e.id);n[a]=void 0,this.indexAnneau=a,this.mapItem.get(3)?.next(n)}else s!==void 0&&this.mapItem.get(s)?.next([void 0])})),f(()=>t))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};export{te as a,Tr as b,Ce as c,Zo as d,gn as e,xt as f,Rn as g,Or as h,oe as i,Ue as j,jt as k,Oe as l,Ne as m,sn as n,Me as o,Pe as p,we as q,qt as r,De as s,Fe as t,Ve as u,Ht as v,zt as w,Bt as x,Qt as y,dn as z,Sn as A,Wt as B,mn as C};
