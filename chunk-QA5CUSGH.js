import{a as Qe,b as je}from"./chunk-P2SC5CIM.js";import{a as we,c as be,d as $e}from"./chunk-EFHSRGHD.js";import{a as De,b as xe,c as Le,d as Fe}from"./chunk-2HEWPP7W.js";import{a as se,b as G,c as re,e as Be,u as ne,v as Re,w as oe,y as Ge}from"./chunk-I4DGKEFB.js";import{$b as te,A as Ae,Ad as ke,Ba as R,C as j,D as A,Da as S,Ea as F,Ga as x,Gb as J,H as M,Ha as L,Ia as m,Ja as l,Ka as c,L as p,La as h,Ma as _e,Na as Ie,P as u,Pa as V,Q as P,Ra as O,Rb as ee,Sb as B,Ta as E,_ as Te,ad as k,b as Se,bd as ie,c as Ce,cb as H,cd as ae,d as U,dd as b,ea as C,eb as K,fa as o,fb as v,gb as Pe,gd as Ve,hb as w,i as I,ib as g,j as $,la as Me,ma as D,mb as Oe,nb as ge,ob as ye,pa as ue,q as he,qa as Y,rb as Ne,sb as f,t as ve,tb as d,ub as Ue,z as Z}from"./chunk-4VXWW5XM.js";import{a as X,b as z}from"./chunk-EQDQRRRY.js";var We=class s{isDisplayed=new U(!1);isDisplayed$=this.isDisplayed.asObservable();toggleDisplay(){this.isDisplayed.next(!this.isDisplayed.value)}setDisplay(e){this.isDisplayed.next(e)}static \u0275fac=function(i){return new(i||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:"root"})};var pe=class s{condition=new Map;http=p(te);loadPromise;load(){return this.loadPromise?this.loadPromise:(this.loadPromise=new Promise(e=>{this.http.get("/itemConditions.json").pipe(A(i=>i.forEach(t=>this.condition.set(t.id,t))),Z(1)).subscribe({next:()=>e(),error:i=>{console.error("Failed to load monster drops:",i),e()}})}),this.loadPromise)}findCondition(e){return this.condition.get(e)}static \u0275fac=function(i){return new(i||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:"root"})};var Ee=class s{stateDefinitionService=new Map;http=p(te);loadPromise;load(){return this.loadPromise?this.loadPromise:(this.loadPromise=new Promise(e=>{this.http.get("/statesDefinition.json").pipe(A(i=>i.forEach(t=>this.stateDefinitionService.set(t.id,{id:t.id,description:{fr:t.description.fr,en:t.description.en,es:t.description.es,pt:t.description.pt}}))),Z(1)).subscribe({next:()=>e(),error:i=>{console.error("Failed to load monster drops:",i),e()}})}),this.loadPromise)}findStatesDefinition(e){return this.stateDefinitionService.get(e)}static \u0275fac=function(i){return new(i||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:"root"})};var Q=class s{translateService=p(k);ankamaCdnFacade=p(G);static malusActions=new Set([21,40,56,57,90,96,97,98,100,130,132,161,168,172,174,176,181,192,194,876,1056,1059,1060,1061,1062,1063]);static opposedEffects=new Map;static opposedPairs=[[20,21],[39,40,!0],[80,90],[84,96],[82,97],[83,98],[80,100],[120,130],[122,132],[150,168],[171,172],[173,174],[175,176],[180,181],[191,192],[193,194],[875,876],[149,1056],[1052,1059],[1053,1060],[1055,1061],[988,1062],[71,1063],[31,56],[41,57],[160,161]];constructor(){for(let[e,i]of s.opposedPairs)s.opposedEffects.set(e,i),s.opposedEffects.set(i,e)}getEffectById(e){let i=this.ankamaCdnFacade.getActionList().find(t=>t.definition.id===e);return i?`${i.description[this.translateService.currentLang]}`:""}isAMalus(e){return s.malusActions.has(e)}isOpposed(e,i){let t=e.actionId,a=i.actionId;for(let[r,n,_]of s.opposedPairs)if((t===r||a===r)&&(t===n||a===n))return _?e.params[4]===i.params[4]:!0;return!1}getOpposedEffect(e){return s.opposedEffects.get(e)??e}static \u0275fac=function(i){return new(i||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:"root"})};var W=class s{ankamaCdnFacade=p(G);translateService=p(k);actionService=p(Q);transform(e){return $([this.translateService.onLangChange.pipe(Ae({lang:this.translateService.currentLang,translations:{}})),this.ankamaCdnFacade.action$]).pipe(I(([,i])=>i),I(i=>this.findAction(i,e)),I(i=>this.getDefinitions(i)),I(i=>this.getDefinitionsComplete(i,e)))}getDefinitionsComplete(e,i){let t=`${e}`;return t=this.replaceValues(t,i),t=this.cleanHeaderDefinition(t),t=this.cleanRecoltEffect(t),t=this.singularOrPlurial(t,i),t=this.atLeastSixParameters(t,i),t=this.armorGivenOrReceived(t,i),t=this.deleteDoubleMinus(t),t}deleteDoubleMinus(e){return e.replace(/--/g,"")}armorGivenOrReceived(e,i){if(i.actionId!==39&&i.actionId!==40)return e;let t=i.params[4]===120?this.translateService.instant("abstract.donnee"):this.translateService.instant("abstract.recue"),a=Math.abs(i.params[0]),r=this.actionService.isAMalus(i.actionId);return(r&&i.params[0]>0||!r&&i.params[0]<0?"-":"")+a+this.translateService.instant("abstract.armure")+t}atLeastSixParameters(e,i){let t=/{\[~3\]\?(.*):(.*)}/,a=e.match(t);return a&&(e=a[i.params.length>=6?1:2]),e}singularOrPlurial(e,i){return e=this.singularOrPlurialWithRegex(e,i,/\{\[>2\]\?([^}]){0,5}:([^}]){0,5}\}/g,2),e=this.singularOrPlurialWithRegex(e,i,/\{\[>1\]\?([^}]){0,5}:([^}]){0,5}\}/g),e}singularOrPlurialWithRegex(e,i,t,a=0){let r=[...e.matchAll(t)];if(r&&i.params.length>a){let n=r.map(_=>_[i.params[a]>=2?1:2]);for(let _=0;_<r.length;_++)e=e.replace(r[_][0],n[_]??"")}return e}cleanDefinition(e,i){let t=e.match(i);return t&&(e=e.replace(t[0],"")),e}cleanRecoltEffect(e){return this.cleanDefinition(e,/{\[~2]?.+}/g)}cleanHeaderDefinition(e){return this.cleanDefinition(e,/(\[#.*\]) /g)}replaceValues(e,i){let t=/(\[#\d\])/g,a=[...e.matchAll(t)].map(r=>r[1]);if(a)for(let r of a){let n=0;switch(r){case"[#1]":n=0;break;case"[#2]":n=2;break;case"[#3]":n=4;break}i.params.length>n&&(e=e.replace(r,i.params[n].toString()))}return e}getDefinitions(e){return e.description[this.translateService.currentLang]}findAction(e,i){return e.filter(t=>t.definition.id===i.actionId)[0]}static \u0275fac=function(i){return new(i||s)};static \u0275pipe=ue({name:"actions",type:s,pure:!0})};var ce=class s{AnkamaCdnFacade=p(G);findStates(e){let i=this.AnkamaCdnFacade.getStatesList().find(t=>t.definition.id===e);if(i)return{id:i.definition.id,fr:i.title.fr,en:i.title.en,es:i.title.es,pt:i.title.pt}}static \u0275fac=function(i){return new(i||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:"root"})};var q=class s{translateService=p(k);itemTypeService=p(Be);itemChooseService=p(oe);actionsService=p(Q);statesService=p(ce);imageService=p(Ve);destroy$=new Ce;resistances=0;maitrises=0;IdActionEnum=b;mapSortAction=new Map([[31,0],[56,1],[41,2],[57,3],[193,4],[191,4],[192,5],[184,6],[160,7],[161,8],[20,9],[21,10],[173,11],[175,12],[172,13],[875,14],[174,15],[176,16],[876,17],[120,18],[1068,19],[149,20],[180,21],[26,22],[1055,23],[1053,24],[1052,25],[1056,26],[181,27],[1061,28],[1060,29],[1059,30],[150,31],[39,32],[168,33],[40,34],[988,35],[71,36],[80,37],[1069,38],[82,39],[83,40],[85,41],[84,42],[1062,43],[1063,44],[90,45],[97,46],[98,47],[96,48]]);Math=Math;itemChoosen$=new U([[]]);IdActionsEnum=b;getEffectPng(e){return this.imageService.getActionIdUrl(e.actionId,e.actionId===39&&e.params[4]===121)}initItemChoosen(e){let i=this.itemTypeService.getItemType(e.itemTypeId);if(!i)return;let t=new Se;i===13?t=this.itemChooseService.getObsItem(12).pipe(I(a=>[a])):i===1?t=$([this.itemChooseService.getObsItem(2),this.itemChooseService.getObsItem(12)]).pipe(I(([a,r])=>[a,r])):t=this.itemChooseService.getObsItem(i).pipe(I(a=>[a])),t.pipe(j(this.destroy$)).subscribe(a=>this.itemChoosen$.next(a))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=D({type:s,selectors:[["app-item"]],decls:0,vars:0,template:function(i,t){},encapsulation:2})};function Ze(s,e){if(s&1&&(l(0,"div",0)(1,"span"),h(2,"img",7),v(3),f(4,"translate"),c(),l(5,"span"),h(6,"img",8),v(7),f(8,"translate"),c()()),s&2){let i=E();o(),K(i.getBackgroundDifferentsStatsOnValue(i.maitrises)),o(),m("src",i.imageService.getActionIdUrl(i.IdActionEnum.MAITRISES_ELEMENTAIRES),C),o(),g("",d(4,10,"item.maitrises")," ",i.Math.trunc(i.maitrises)),o(2),K(i.getBackgroundDifferentsStatsOnValue(i.resistances)),o(),m("src",i.imageService.getActionIdUrl(i.IdActionEnum.RESISTANCES_ELEMENTAIRE),C),o(),g("",d(8,12,"item.resistances")," ",i.resistances)}}function Ye(s,e){if(s&1&&(l(0,"div",4)(1,"h3"),v(2),c(),h(3,"img",9),c()),s&2){let i=e.$implicit,t=E(2);o(),H("color",t.colorRarityService.mapColors.get(i.rarity)),o(),g("",t.getTitle(i)," (",i.level,")"),o(),m("src",t.imageService.getItemUrl(i.idImage),C)}}function Je(s,e){s&1&&x(0,Ye,4,5,"div",4,F),s&2&&L(e)}function et(s,e){if(s&1&&(h(0,"img",11),v(1),f(2,"actions"),f(3,"async")),s&2){let i=E().$implicit,t=E(2);m("src",t.getEffectPng(i),C),o(),w(" ",d(3,4,d(2,2,i))," ")}}function tt(s,e){if(s&1&&(l(0,"p"),R(1,et,4,6),c()),s&2){let i=e.$implicit,t=E(2);K(t.getBackgroundDifferentsStats(i)),o(),S(i.actionId!==t.IdActionEnum.APPLIQUE_ETAT&&i.value!==0?1:-1)}}function it(s,e){s&1&&(l(0,"div"),x(1,tt,2,3,"p",10,F),c()),s&2&&(o(),L(e))}var fe=class s extends q{itemService=p(ne);colorRarityService=p(re);cdr=p(J);item;indexItemChoosen=0;ARMURE_DONNEE_RECUE=[39,40];listDifferentsStatsItem=[];loaded$;weight=0;itemSelected$=this.itemChoosen$.pipe(he(e=>e.length!==0),I(e=>e.map(i=>i[this.indexItemChoosen])),I(e=>e.length>=2&&e[0]?.id===e[1]?.id?[e.find(i=>i!==void 0)]:e),I(e=>e.filter(i=>i!==void 0)));differentStatsItemList$=this.itemSelected$.pipe(j(this.destroy$),A(e=>{this.listDifferentsStatsItem=[],this.fillListCurrentItem(),e.forEach(i=>i?this.fillMapDifferentStatsItem(i):"")}),I(()=>this.listDifferentsStatsItem.sort((e,i)=>(this.mapSortAction.get(e.actionId)??999)-(this.mapSortAction.get(i.actionId)??999))));constructor(){super()}ngAfterViewInit(){this.item&&(this.item.equipEffects=this.item.equipEffects.sort((e,i)=>(this.mapSortAction.get(e.actionId)??999)-(this.mapSortAction.get(i.actionId)??999)),this.loaded$=this.itemSelected$.pipe(j(this.destroy$),I(e=>(this.resistances=this.item.resistance,this.maitrises=this.item.maitrise,this.weight=this.itemService.calculWeight(this.resistances,this.maitrises,this.item.level),e.forEach(i=>{i&&(this.resistances-=i.resistance,this.maitrises-=i.maitrise,this.weight=this.itemService.calculWeight(this.resistances,this.maitrises,i.level))}),!0))),this.initItemChoosen(this.item),this.cdr.detectChanges())}setItem(e){let i=this.itemTypeService.getItemType(e.itemTypeId);i&&this.itemChooseService.setItem(i,e)}getTitle(e){return e?e.title[this.translateService.currentLang]:""}getBackgroundDifferentsStatsOnValue(e){return e>0?"green":e<0?"red":""}getBackgroundDifferentsStats(e){let i=this.actionsService.isAMalus(e.actionId);return e.value>0&&!i||e.value<0&&i||e.presentOnCurrentItem&&!e.presentOnEquippedItem&&!i?"green":e.value<0&&!i||e.value>0&&i||!e.presentOnCurrentItem&&e.presentOnEquippedItem&&i?"red":""}getByActionId(e,i){return this.listDifferentsStatsItem.find(t=>t.actionId===e&&t.isArmureRecue===i)}pushSetDifferentsStatsItem(e){e&&(this.listDifferentsStatsItem=this.listDifferentsStatsItem.filter(i=>i.actionId!==e.actionId||i.isArmureRecue!==e.isArmureRecue),this.listDifferentsStatsItem.push(e))}fillListCurrentItem(){this.item.equipEffects.forEach(e=>{let i=this.ARMURE_DONNEE_RECUE.includes(e.actionId)&&e.params[4]===121,t=this.getByActionId(e.actionId,i);if(t){let a=t.params;a[0]+=e.params[0],t=z(X({},t),{value:t.value+e.params[0],params:a,presentOnCurrentItem:!0})}else t={value:e.params[0],params:[...e.params],actionId:e.actionId,presentOnCurrentItem:!0,presentOnEquippedItem:!1,isArmureRecue:i};this.pushSetDifferentsStatsItem(t)})}fillMapDifferentStatsItem(e){e.equipEffects.forEach(i=>{let t=this.ARMURE_DONNEE_RECUE.includes(i.actionId)&&i.params[4]===121,a=this.getByActionId(i.actionId,t),r=this.item.equipEffects.find(n=>this.actionsService.isOpposed(n,i));if(r){let n=[...i.params];n[0]=r.params[0]+n[0],a={value:r.params[0]+i.params[0],params:n,actionId:r.actionId,presentOnCurrentItem:!0,presentOnEquippedItem:!0,isArmureRecue:t}}else if(a&&a.isArmureRecue===t){let n=a.params;n[0]-=i.params[0],a=z(X({},a),{value:a.value-i.params[0],params:n,presentOnEquippedItem:!0})}else{let n=[...i.params];n[0]=-n[0],a={value:-i.params[0],params:n,actionId:i.actionId,presentOnCurrentItem:!1,presentOnEquippedItem:!0,isArmureRecue:t}}this.pushSetDifferentsStatsItem(a)}),this.calculDifferenceResistance()}calculDifferenceResistance(){let e=this.getByActionId(80,!1),i=[82,83,85,84];e&&i.find(t=>this.getByActionId(t,!1))&&(i.forEach(t=>{let a=this.getByActionId(t,!1);a?(a.params[0]+=e.params[0],a.value+=e.params[0],a.presentOnCurrentItem=!0,a.presentOnEquippedItem=!0):a=z(X({},e),{actionId:t,presentOnCurrentItem:!0,presentOnEquippedItem:!0}),this.pushSetDifferentsStatsItem(a)}),this.listDifferentsStatsItem=this.listDifferentsStatsItem.filter(t=>t.actionId!==80))}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=D({type:s,selectors:[["app-item-tooltip"]],inputs:{item:"item",indexItemChoosen:"indexItemChoosen"},features:[Y],decls:17,vars:21,consts:[[1,"header"],[1,"content",3,"click"],[1,"column"],[1,"row"],[1,"title"],["alt","item",3,"src"],["alt","poids",3,"src"],["alt","Maitrises",3,"src"],["alt","Resistances",3,"src"],["appFallback","","alt","items",3,"src"],[3,"class"],["alt","aptitudes",3,"src"]],template:function(i,t){if(i&1&&(R(0,Ze,9,14,"div",0),f(1,"async"),l(2,"div",1),O("click",function(){return t.setItem(t.item)}),l(3,"div",2)(4,"div",3)(5,"div",4)(6,"h3"),v(7),c(),h(8,"img",5),c(),R(9,Je,2,0),f(10,"async"),c(),l(11,"span"),h(12,"img",6),v(13),f(14,"translate"),c()(),R(15,it,3,0,"div"),f(16,"async"),c()),i&2){let a,r;S(d(1,13,t.loaded$)?0:-1),o(6),H("color",t.colorRarityService.mapColors.get(t.item.rarity)),o(),g("",t.getTitle(t.item)," (",t.item.level,")"),o(),m("src",t.imageService.getItemUrl(t.item.idImage),C),o(),S((a=d(10,15,t.itemSelected$))?9:-1,a),o(2),K(t.getBackgroundDifferentsStatsOnValue(t.weight)+" poids"),o(),m("src","aptitudes/poids.png",C),o(),g("",d(14,17,"item.poids")," ",t.weight," "),o(2),S((r=d(16,19,t.differentStatsItemList$))?15:-1,r)}},dependencies:[B,ae,se,ee,ie,W],styles:["[_nghost-%COMP%]{background:linear-gradient(145deg,#0d1b2a,#415a77);border-radius:15px;padding:5px;color:#fff;height:fit-content;width:600px;display:flex;flex-direction:column;box-shadow:0 8px 8px #0009;position:relative}[_nghost-%COMP%]   span[_ngcontent-%COMP%]{border-radius:10px;width:200px;display:flex;justify-content:space-around;align-items:center;margin:2px auto}[_nghost-%COMP%]   .green[_ngcontent-%COMP%]{background:linear-gradient(145deg,#4caf50,#00c896)}[_nghost-%COMP%]   .red[_ngcontent-%COMP%]{background:linear-gradient(145deg,#e63946,#ff6b35)}[_nghost-%COMP%]   .green[_ngcontent-%COMP%], [_nghost-%COMP%]   .red[_ngcontent-%COMP%]{color:#0d1b2a}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;border-bottom:3px solid #415A77;margin-bottom:10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;cursor:pointer}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{width:50px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:space-around;cursor:pointer}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-around;align-items:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{margin-right:10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;max-width:30%;flex-direction:column}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;margin:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center;margin:2px 0;border-radius:20px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .poids[_ngcontent-%COMP%]{align-items:center;display:flex;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .poids[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px;height:22px;margin:0 10px}[_nghost-%COMP%]   .iconComparator[_ngcontent-%COMP%]{position:absolute;right:10px;bottom:10px;color:#415a77;background-color:#e5e9ea;border-radius:50%;cursor:pointer;border:5px solid #0D1B2A}@media screen and (max-width: 700px){[_nghost-%COMP%]{width:300px;font-size:12px}}@media screen and (max-width: 700px){  .cdk-overlay-pane{transform:none!important}}"]})};function at(s,e){if(s&1&&h(0,"app-item-tooltip",0),s&2){let i=E().$index,t=E();m("item",t.item)("indexItemChoosen",i)}}function st(s,e){if(s&1&&R(0,at,1,2,"app-item-tooltip",0),s&2){let i=e.$index,t=E();S(t.itemsChoosen[i]!==void 0?0:-1)}}var me=class s{item;itemsChoosen=[];static \u0275fac=function(i){return new(i||s)};static \u0275cmp=D({type:s,selectors:[["app-items-tooltip"]],inputs:{item:"item",itemsChoosen:"itemsChoosen"},decls:2,vars:0,consts:[[3,"item","indexItemChoosen"]],template:function(i,t){i&1&&x(0,st,1,1,null,null,F),i&2&&L(t.itemsChoosen)},dependencies:[B,fe],encapsulation:2})};function rt(s,e){if(s&1&&(_e(0,"div"),v(1),Ie()),s&2){let i=E();o(),w(" ",i.definition()," ")}}var de=class s{statesDefinitionService=p(Ee);translateService=p(k);statesDefinitionId=0;nameStates="";definition(){let e=this.statesDefinitionService.findStatesDefinition(this.statesDefinitionId);if(e)return e.description[this.translateService.currentLang]}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=D({type:s,selectors:[["app-states"]],inputs:{statesDefinitionId:"statesDefinitionId",nameStates:"nameStates"},decls:4,vars:2,consts:[[1,"header"]],template:function(i,t){i&1&&(_e(0,"div",0)(1,"span"),v(2),Ie()(),R(3,rt,2,1,"div")),i&2&&(o(2),Pe(t.nameStates),o(),S(t.definition()?3:-1))},dependencies:[B],styles:["[_nghost-%COMP%]{background:linear-gradient(145deg,#0d1b2a,#415a77);border-radius:15px;padding:10px;color:#fff;display:flex;flex-direction:column;box-shadow:0 8px 8px #0009;position:relative}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;border-bottom:3px solid #415A77;margin-bottom:10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;margin:auto}"]})};var nt=s=>({ratio:s}),ot=(s,e)=>e.id;function pt(s,e){s&1&&(l(0,"div",7),v(1),c()),s&2&&(o(),w(" [ ",e," ] "))}function Et(s,e){if(s&1&&(h(0,"img",19),v(1),f(2,"actions"),f(3,"async")),s&2){let i=E().$implicit,t=E(2);m("src",t.getEffectPng(i),C),o(),w(" ",d(3,4,d(2,2,i))," ")}}function ct(s,e){if(s&1){let i=V();Oe(0),l(1,"span",20),O("mouseenter",function(a){u(i);let r=ye(0),n=E(3);return P(n.openStatesTooltip(a,(r==null?null:r.id)??0,n.getStatesTranslate(r)))})("mouseleave",function(){u(i);let a=E(3);return P(a.stateTooltipService.closeTooltip())}),v(2),c()}if(s&2){let i=E().$implicit,t=E(2),a=ge(t.statesService.findStates(i.params[0]));o(2),w(" ",t.getStatesTranslate(a)," ")}}function lt(s,e){if(s&1&&(l(0,"p"),R(1,Et,4,6)(2,ct,3,2,"span",18),c()),s&2){let i=e.$implicit,t=E(2);o(),S(i.actionId!==t.IdActionEnum.APPLIQUE_ETAT?1:2)}}function ft(s,e){if(s&1){let i=V();l(0,"img",21),f(1,"translate"),O("click",function(){u(i);let a=E(2);return P(a.navigateToCraftku())}),c()}if(s&2){let i=E(2);m("src",i.imageService.getItemUrl(71919810),C)("matTooltip",d(1,2,"item.craftable"))}}function mt(s,e){if(s&1){let i=V();l(0,"img",23),f(1,"translate"),O("click",function(){let a=u(i).$implicit,r=E(3);return P(r.openEncyclopedieForMonster(a.idMob))}),c()}if(s&2){let i=e.$implicit,t=E(3);m("src",t.imageService.getMonsterUrl(i.gfxId),C)("matTooltip",`${d(1,2,"item.droppable")} (${t.nameMonster(i)})`)}}function dt(s,e){if(s&1&&x(0,mt,2,4,"img",22,F),s&2){let i=E(2);L(i.item.mobDropable)}}function _t(s,e){if(s&1){let i=V();l(0,"img",25),f(1,"translate"),O("click",function(){let a=u(i).$implicit,r=E(3);return P(r.openEncyclopedieForMonster(a.idMob))}),c()}if(s&2){let i=e.$implicit,t=E(3);m("src",t.imageService.getMonsterUrl(i.gfxId),C)("matTooltip",`${d(1,2,"item.boss-drop")} (${t.nameMonster(i)})`)}}function It(s,e){if(s&1&&x(0,_t,2,4,"img",24,F),s&2){let i=E(2);L(i.item.bossDropable)}}function Rt(s,e){if(s&1){let i=V();l(0,"img",27),f(1,"translate"),O("click",function(){let a=u(i).$implicit,r=E(3);return P(r.openEncyclopedieForMonster(a.idMob))}),c()}if(s&2){let i=e.$implicit,t=E(3);m("src",t.imageService.getMonsterUrl(i.gfxId),C)("matTooltip",`${d(1,2,"item.archi-drop")} (${t.nameMonster(i)})`)}}function St(s,e){if(s&1&&x(0,Rt,2,4,"img",26,F),s&2){let i=E(2);L(i.item.archiDropable)}}function Ct(s,e){if(s&1&&(h(0,"img",17),f(1,"translate")),s&2){let i=E(2);m("src",i.imageService.getItemUrl(53124705),C)("matTooltip",d(1,2,"item.pvp"))}}function ht(s,e){if(s&1){let i=V();l(0,"div",0)(1,"span",1),f(2,"translate"),O("click",function(){u(i);let a=E();return P(a.copyToClipboard())}),h(3,"mat-icon",2),c(),l(4,"span"),h(5,"img",3),v(6),f(7,"translate"),c(),l(8,"span"),h(9,"img",4),v(10),f(11,"translate"),c(),l(12,"span",5),O("click",function(){u(i);let a=E();return P(a.openEncyclopedie(a.item.id))}),h(13,"img",6),c()(),R(14,pt,2,1,"div",7),f(15,"async"),l(16,"div",8),O("click",function(){u(i);let a=E();return P(a.setItemChoosen())}),l(17,"div",9)(18,"h3"),v(19),h(20,"img",10),c(),h(21,"img",11),l(22,"div",12),f(23,"translate"),h(24,"img",13),v(25),f(26,"translate"),c()(),l(27,"div",14)(28,"div"),x(29,lt,3,1,"p",null,ot),c(),l(31,"div",15),R(32,ft,2,4,"img",16),R(33,dt,2,0),R(34,It,2,0),R(35,St,2,0),R(36,Ct,2,4,"img",17),c()()()}if(s&2){let i,t=E();o(),m("matTooltip",d(2,24,"item.copier")),o(4),m("src",t.imageService.getActionIdUrl(t.IdActionEnum.MAITRISES_ELEMENTAIRES),C),o(),g("",d(7,26,"item.maitrises")," ",t.Math.trunc(t.item.maitrise)),o(3),m("src",t.imageService.getActionIdUrl(t.IdActionEnum.RESISTANCES_ELEMENTAIRE),C),o(),g("",d(11,28,"item.resistances")," ",t.item.resistance),o(4),S((i=d(15,30,t.textCondition()))?14:-1,i),o(4),H("color",t.colorRarityService.mapColors.get(t.item.rarity)),o(),g("",t.getTitle()," (",t.item.level,") "),o(),m("src",t.itemTypeService.getLogo(t.itemTypeService.getItemType(t.item.itemTypeId)),C),o(),m("src",t.imageService.getItemUrl(t.item.idImage),C),o(),m("matTooltip",Ue(23,32,"item.poids-infobulle",Ne(37,nt,t.itemService.ratioWeightByLevel(t.item.level))))("matTooltipShowDelay",300),o(2),m("src","aptitudes/poids.png",C),o(),g("",d(26,35,"item.poids")," ",t.item.weight),o(4),L(t.item.equipEffects),o(3),S(t.item.isCraftable?32:-1),o(),S(t.item.mobDropable?33:-1),o(),S(t.item.bossDropable?34:-1),o(),S(t.item.archiDropable?35:-1),o(),S(t.item.isPvP?36:-1)}}function vt(s,e){if(s&1){let i=V();l(0,"mat-icon",29),O("mouseenter",function(a){u(i);let r=E(2);return P(r.openTooltip(a,r.item))})("mouseleave",function(){u(i);let a=E(2);return P(a.tooltipService.closeTooltip())}),c()}}function At(s,e){if(s&1&&R(0,vt,1,0,"mat-icon",28),s&2){let i=E();S(i.itemIsPresentAndNotChoosen(e)?0:-1)}}var He=class s extends q{viewContainerRef=p(Me);el=p(Te);itemService=p(ne);colorRarityService=p(re);tooltipService=p(Re);stateTooltipService=p(Re);cdr=p(J);itemConditionService=p(pe);item;condition=new U(void 0);condition$=this.condition.asObservable();constructor(){super()}navigateToCraftku(){window.open("https://craftkfu.waklab.fr/?"+this.item.id,"_blank")}setItemChoosen(){let e=this.itemTypeService.getItemType(this.item.itemTypeId);e&&this.itemChooseService.setItem(e,this.item)}itemIsPresentAndNotChoosen(e){return!!e.find(i=>i.find(t=>t!==void 0)&&!i.find(t=>t?.id===this.item.id))}ngAfterViewInit(){if(this.item){this.item.equipEffects=this.item.equipEffects.sort((i,t)=>(this.mapSortAction.get(i.actionId)??999)-(this.mapSortAction.get(t.actionId)??999)),this.initItemChoosen(this.item);let e=this.itemConditionService.findCondition(this.item.id);e&&this.condition.next(e),this.cdr.detectChanges()}}textCondition(){return this.condition$.pipe(I(e=>e?.description[this.translateService.currentLang]??void 0))}nameMonster(e){return e.name[this.translateService.currentLang]??""}openTooltip(e,i){let t=e.pageX>window.screen.width/2;this.tooltipService.closeTooltip(),this.itemChoosen$.pipe(ve(1),I(a=>a.find(r=>r.find(n=>n)))).subscribe(a=>{this.tooltipService.openTooltip(this.viewContainerRef,me,e,{item:i,itemsChoosen:a},[{originX:t?"end":"center",originY:"bottom",overlayX:t?"end":"center",overlayY:"bottom",offsetY:0,offsetX:t?-this.el.nativeElement.offsetWidth:340}],!1)})}openEncyclopedie(e){window.open("https://www.wakfu.com/fr/mmorpg/encyclopedie/armures/"+e)}openEncyclopedieForMonster(e){window.open("https://www.wakfu.com/fr/mmorpg/encyclopedie/monstres/"+e)}copyToClipboard(){navigator.clipboard.writeText(this.item.title[this.translateService.currentLang])}getStatesTranslate(e){if(!e)return"";let i=this.translateService.currentLang;return e[i].toString()??""}getTitle(){return this.item.title[this.translateService.currentLang]}openStatesTooltip(e,i,t){this.stateTooltipService.closeTooltip(),this.stateTooltipService.openTooltip(this.viewContainerRef,de,e,{statesDefinitionId:i,nameStates:t},[{originX:"center",originY:"top",overlayX:"center",overlayY:"top",offsetY:20,offsetX:0}])}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=D({type:s,selectors:[["app-item"]],inputs:{item:"item"},features:[Y],decls:3,vars:4,consts:[[1,"header"],[1,"imgContainer","fileCopy",3,"click","matTooltip"],["fontIcon","file_copy"],["alt","Maitrises",3,"src"],["alt","R\xE9sistances",3,"src"],[1,"imgContainer",3,"click"],["src","aptitudes/Encyclop\xE9die.png","alt","Encyclop\xE9die"],[1,"condition"],[1,"content",3,"click"],[1,"title"],["alt","item type logo",3,"src"],["alt","items","appFallback","",3,"src"],[1,"poids",3,"matTooltip","matTooltipShowDelay"],["alt","poids",3,"src"],[1,"effects"],[1,"craftAndDrop"],["alt","craftable",1,"craftable",3,"src","matTooltip"],["alt","pvp",3,"src","matTooltip"],[1,"appliqueEtat"],["alt","aptitudes",3,"src"],[1,"appliqueEtat",3,"mouseenter","mouseleave"],["alt","craftable",1,"craftable",3,"click","src","matTooltip"],["alt","droppable","appFallback","",1,"monster",3,"src","matTooltip"],["alt","droppable","appFallback","",1,"monster",3,"click","src","matTooltip"],["alt","boss drop","appFallback","",1,"monster",3,"src","matTooltip"],["alt","boss drop","appFallback","",1,"monster",3,"click","src","matTooltip"],["alt","archi drop","appFallback","",1,"monster",3,"src","matTooltip"],["alt","archi drop","appFallback","",1,"monster",3,"click","src","matTooltip"],["fontIcon","swap_horiz",1,"iconComparator"],["fontIcon","swap_horiz",1,"iconComparator",3,"mouseenter","mouseleave"]],template:function(i,t){if(i&1&&(R(0,ht,37,39),R(1,At,1,1),f(2,"async")),i&2){let a;S(t.item?0:-1),o(),S((a=d(2,2,t.itemChoosen$))?1:-1,a)}},dependencies:[B,xe,De,ae,Fe,Le,se,we,ee,ie,W],styles:["[_nghost-%COMP%]{background:linear-gradient(145deg,#0d1b2a,#415a77);border-radius:15px;padding:5px;color:#fff;height:100%;width:100%;display:flex;flex-direction:column;box-shadow:0 8px 8px #0009;position:relative}[_nghost-%COMP%]   span[_ngcontent-%COMP%]{border-radius:10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;border-bottom:3px solid #415A77;margin-bottom:10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;margin:auto}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:0 5px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:40px;height:40px;cursor:pointer;align-content:center}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{width:50px;height:50px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{transform:scale(1.2)}[_nghost-%COMP%]   .condition[_ngcontent-%COMP%]{text-align:center;color:red;font-weight:bolder;margin-bottom:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:space-around;cursor:pointer}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{margin-right:10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;max-width:30%;flex-direction:column}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:30px;min-width:30px;min-height:30px;vertical-align:middle}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:80px;height:80px;min-width:80px;min-height:80px;margin:auto;object-fit:contain;border-radius:8px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .poids[_ngcontent-%COMP%]{align-items:center;display:flex;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .poids[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px;height:22px;min-width:22px;min-height:22px;margin:0 10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0;border-radius:20px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:10px;width:24px;height:24px;min-width:24px;min-height:24px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .appliqueEtat[_ngcontent-%COMP%]{font-weight:500;text-decoration:underline}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-around}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;min-width:80px;min-height:80px;object-fit:contain;flex:0 0 calc(33% - 10px);max-width:calc(33% - 10px)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   .craftable[_ngcontent-%COMP%]:hover{transform:scale(1.2)}[_nghost-%COMP%]   .iconComparator[_ngcontent-%COMP%]{position:absolute;right:10px;bottom:10px;color:#415a77;background-color:#e5e9ea;border-radius:50%;cursor:pointer;border:5px solid #0D1B2A}@media screen and (max-width: 900px){[_nghost-%COMP%]{max-width:90%;margin:auto}[_nghost-%COMP%]   .fileCopy[_ngcontent-%COMP%]{display:none!important}[_nghost-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px!important;height:40px!important;min-width:40px!important;min-height:40px!important}[_nghost-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-of-type(n+4){display:none!important}}"]})};var Ke=class s extends ke{actionService=p(Q);itemChooseService=p(oe);aptitudesFormService=p(Qe);levelFormService=p(je);classeFormService=p(be);sortFormService=p($e);chasseFormService=p(Ge);maitrisesSecondairesList=[149,180,26,1055,1052,1053];naturalEffects=[{id:31,value:6,params:[]},{id:41,value:3,params:[]},{id:191,value:6,params:[]},{id:150,value:3,params:[]},{id:184,value:1,params:[]}];initialEffectList=[{id:122,value:0,params:[]},{id:124,value:0,params:[]},{id:123,value:0,params:[]},{id:125,value:0,params:[]},{id:1052,value:0,params:[]},{id:1053,value:0,params:[]},{id:149,value:0,params:[]},{id:180,value:0,params:[]},{id:26,value:0,params:[]},{id:1055,value:0,params:[]},{id:150,value:0,params:[]},{id:875,value:0,params:[]},{id:71,value:0,params:[]},{id:988,value:0,params:[]},{id:184,value:0,params:[]},{id:-6,value:0,params:[]},{id:-8,value:0,params:[]},{id:82,value:0,params:[]},{id:83,value:0,params:[]},{id:84,value:0,params:[]},{id:85,value:0,params:[]},{id:31,value:0,params:[]},{id:41,value:0,params:[]},{id:191,value:0,params:[]},{id:160,value:0,params:[]},{id:20,value:0,params:[]},{id:39,parameterMajorAction:120,value:0,params:[]},{id:39,parameterMajorAction:121,value:0,params:[]},{id:175,value:0,params:[]},{id:173,value:0,params:[]},{id:177,value:0,params:[]},{id:171,value:0,params:[]},{id:-9,value:0,params:[]},{id:-7,value:0,params:[]}];recap=new U([...this.initialEffectList]);recap$=this.recap.asObservable();maitrisesTotal=new U(0);maitrisesTotal$=this.maitrisesTotal.asObservable();resistancesTotal=new U(0);resistancesTotal$=this.resistancesTotal.asObservable();constructor(){super(),this.initializeListeners()}initializeListeners(){$([this.itemChooseService.listItem$,this.aptitudesFormService.recapStat$,this.levelFormService.level$,this.chasseFormService.recapChassesEffect$,this.chasseFormService.sublimationsIdToLevel$,this.classeFormService.classe$,this.sortFormService.sortPassifs$]).pipe(j(this.destroy$),A(()=>this.resetEffects()),I(([e,i,t,a,r])=>{let n=this.extractEquipEffects(e),_=this.mapToRecapStats(n);return _.push(...i,...a),{recapStat:_,level:t,sublimationsIdToLevel:r}}),A(()=>this.applyNatifEffects()),A(()=>this.applyEffectByClass()),A((e=>e.recapStat.forEach(i=>this.applyEffect(i)))),A(()=>this.applyEffectPassif()),A(e=>this.applyEffectSublimation(e.sublimationsIdToLevel)),A(()=>this.applyPdv()),A(()=>this.emitEffects())).subscribe()}applyPdv(){let e=this.recap.value.find(t=>t.id===20),i=this.recap.value.find(t=>t.id===-7);if(e&&i){let a=50+this.levelFormService.getValue()*10;e.value=Math.floor((a+e.value)*(1+i.value/100))}}allMaitrisesSecondairesNull(){return this.maitrisesSecondairesList.every(e=>{let i=this.recap.value.find(t=>t.id===e);return i?i.value<=0:!0})}applyEffectSublimation(e){let i=this.levelFormService.getValue();e.forEach((t,a)=>{if(a===29004&&this.allMaitrisesSecondairesNull())this.applyEffect({id:160,value:Math.floor(.5*t),params:[]}),this.applyEffect({id:191,value:Math.floor(.5*t),params:[]}),this.applyEffect({id:39,value:t*-5,parameterMajorAction:120,params:[]}),this.applyEffect({id:39,value:t*-5,parameterMajorAction:121,params:[]});else if(a===30752)this.applyEffect({id:-9,value:-20,params:[]});else if(a===30956)this.applyEffect({id:41,value:Math.floor(.5*t),params:[]});else if(a===31369)this.applyEffect({id:39,value:t*5,parameterMajorAction:120,params:[]});else if(a===29591&&this.allMaitrisesSecondairesNull())this.applyEffect({id:150,value:t*5,params:[]});else if(a===28900)this.applyEffect({id:-6,value:-20,params:[]});else if(a===29495)this.applyEffect({id:-6,value:10,params:[]}),this.applyEffect({id:41,value:-3+t,params:[]});else if(a===31630)this.applyEffect({id:988,value:t*5,params:[]});else if(a===31633)this.applyEffect({id:71,value:t*5,params:[]});else if(a===29497)this.applyEffect({id:80,value:75,params:[]}),this.applyEffect({id:31,value:-3+t,params:[]});else if(a===28828)this.applyEffect({id:120,value:Math.floor(.15*i*t),params:[]});else if(a===28830)this.applyEffect({id:-7,value:t*5,params:[]});else if(a===27158)this.applyEffect({id:177,value:-20,params:[]});else if(a===29499)this.applyEffect({id:160,value:-1,params:[]}),this.applyEffect({id:173,value:Math.floor(.5*i*t),params:[]}),this.applyEffect({id:175,value:Math.floor(.5*i*t),params:[]});else if(a===30763)this.applyEffect({id:875,value:10*t,params:[]});else if(a===28849)this.applyEffect({id:150,value:5*t,params:[]});else if(a===31627)this.applyEffect({id:875,value:3*t,params:[]});else if(a===28824)this.applyEffect({id:193,value:1,params:[]}),this.applyEffect({id:177,value:-40+10*t,params:[]});else if(a===28845)this.applyEffect({id:39,value:3*t,parameterMajorAction:121,params:[]});else if(a===28880)this.applyEffect({id:39,value:5*t,parameterMajorAction:120,params:[]});else if(a===28858)this.applyEffect({id:175,value:Math.floor(.5*i*t),params:[]});else if(a===30961)this.applyEffect({id:175,value:Math.floor(.5*i*t),params:[]});else if(a===28908)this.applyEffect({id:120,value:Math.floor(.25*i*t),params:[]});else if(a===27161)this.applyEffect({id:80,value:-50,params:[]});else if(a===27159)this.applyEffect({id:-6,value:-15,params:[]});else if(a===30953)this.applyEffect({id:-6,value:3*t,params:[]});else if(a===27153)this.applyEffect({id:-6,value:-15,params:[]});else if(a===28897)this.applyEffect({id:150,value:10*t,params:[]});else if(a===28871)this.applyEffect({id:150,value:3*t,params:[]});else if(a===30957)this.applyEffect({id:150,value:4*t,params:[]});else if(a===30967)this.applyEffect({id:173,value:Math.floor(.5*i),params:[]});else if(a===29001&&this.allMaitrisesSecondairesNull())this.applyEffect({id:-6,value:8*t,params:[]});else if(a===28867)this.applyEffect({id:875,value:5*t,params:[]});else if(a===29513){let r=this.recap.value.find(_=>_.id===41)?.value??0,n=Math.max(0,r-4);this.applyEffect({id:175,value:2*n*t,params:[]})}else if(a===29007)this.applyEffect({id:875,value:5*t,params:[]});else if(a===28894)this.applyEffect({id:191,value:-1*t,params:[]});else if(a===28826)this.applyEffect({id:120,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:1055,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:149,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:180,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:1052,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:1053,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:26,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:80,value:3*t,params:[]});else if(a===27124)this.applyEffect({id:177,value:-20,params:[]});else if(a===28988)this.applyEffect({id:-9,value:-10,params:[]});else if(a===28822)this.applyEffect({id:-8,value:5*t,params:[]});else if(a===31636)this.applyEffect({id:191,value:-1,params:[]});else if(a===27959){let r=this.recap.value.find(n=>n.id===26)?.value??0;this.applyEffect({id:-9,value:-r,params:[]}),this.applyEffect({id:-9,value:10,params:[]})}else if(a===28852)this.applyEffect({id:173,value:50*t*i,params:[]});else if(a===28842)this.applyEffect({id:150,value:50*t,params:[]}),this.applyEffect({id:-6,value:-50,params:[]}),this.applyEffect({id:-9,value:-50,params:[]});else if(a===28840){let r=this.recap.value.find(n=>n.id===175)?.value??0;this.applyEffect({id:175,value:-r,params:[]})}else if(a===28847)this.applyEffect({id:41,value:1,params:[]}),this.applyEffect({id:-6,value:-30+10*t,params:[]});else if(a===28851)this.applyEffect({id:160,value:1,params:[]}),this.applyEffect({id:175,value:-450+150*t,params:[]}),this.applyEffect({id:173,value:-450+150*t,params:[]});else if(a===30996)this.applyEffect({id:-6,value:-15,params:[]}),this.applyEffect({id:-9,value:30,params:[]});else if(a===25795)this.applyEffect({id:-6,value:-20,params:[]});else if(a===31609)this.applyEffect({id:80,value:50,params:[]});else if(a===31601)this.applyEffect({id:80,value:-100,params:[]});else if(a===29876)this.applyEffect({id:80,value:-50,params:[]});else if(a===30995){let r=this.recap.value.find(N=>N.id===122)?.value??0;this.applyEffect({id:122,value:-r,params:[]});let n=this.recap.value.find(N=>N.id===124)?.value??0;this.applyEffect({id:124,value:-n,params:[]});let _=this.recap.value.find(N=>N.id===123)?.value??0;this.applyEffect({id:123,value:-_,params:[]});let T=this.recap.value.find(N=>N.id===125)?.value??0;this.applyEffect({id:125,value:-T,params:[]}),this.applyEffect({id:-6,value:20,params:[]}),this.applyEffect({id:-9,value:20,params:[]})}else if(a===27190)this.applyEffect({id:-6,value:20,params:[]}),this.applyEffect({id:-9,value:20,params:[]}),this.applyNerfConcentrationElementaire();else if(a===24131)this.applyEffect({id:-6,value:20,params:[]}),this.applyEffect({id:150,value:50,params:[]});else if(a===30993)this.applyEffect({id:-8,value:40,params:[]});else if(a===29873)this.applyEffect({id:-8,value:30,params:[]});else if(a===24132){let r=this.recap.value.find(n=>n.id===149)?.value??0;this.applyEffect({id:149,value:-r,params:[]}),this.applyEffect({id:120,value:r,params:[]})}else if(a===30994)this.applyEffect({id:-6,value:20,params:[]}),this.applyEffect({id:-9,value:20,params:[]});else if(a===30997){let r=this.recap.value.find(n=>n.id===26)?.value??0;this.applyEffect({id:26,value:-r,params:[]}),this.applyEffect({id:-9,value:30,params:[]})}else if(a===25799)this.applyEffect({id:-6,value:-10,params:[]});else if(a===29871)this.applyEffect({id:-6,value:-10,params:[]});else if(a===25797)this.applyEffect({id:175,value:Math.floor(2.5*i),params:[]});else if(a===28383)(this.recap.value.find(n=>n.id===175)?.value??0)>i&&this.applyEffect({id:173,value:i,params:[]});else if(a===28384)this.applyEffect({id:160,value:1,params:[]});else if(a===24130)this.applyEffect({id:-6,value:15,params:[]}),i>=100&&this.applyEffect({id:-6,value:10,params:[]});else if(a===27188){let r=this.recap.value.find(n=>n.id===160)?.value??0;r>0&&this.applyEffect({id:160,value:-r,params:[]}),this.applyEffect({id:41,value:1,params:[]})}else a===27186?(this.applyEffect({id:41,value:-2,params:[]}),this.applyEffect({id:31,value:2,params:[]})):a===24134?this.applyEffect({id:150,value:10,params:[]}):a===31614?(this.applyEffect({id:875,value:20,params:[]}),this.applyEffect({id:177,value:10,params:[]})):a===27189?(this.applyEffect({id:177,value:10,params:[]}),this.applyEffect({id:875,value:15,params:[]})):a===28385?(this.applyEffect({id:-7,value:30,params:[]}),this.applyEffect({id:39,value:-50,parameterMajorAction:121,params:[]})):a===31613?(this.applyEffect({id:-7,value:-30,params:[]}),this.applyEffect({id:39,parameterMajorAction:120,value:30,params:[]})):a===24133?(this.applyEffect({id:-9,value:20,params:[]}),this.applyEffect({id:39,value:15,parameterMajorAction:120,params:[]})):a===28389?this.applyEffect({id:80,value:-50,params:[]}):a===25793?(this.applyEffect({id:-7,value:-30,params:[]}),this.applyEffect({id:39,parameterMajorAction:121,value:30,params:[]})):a===25794?(this.applyEffect({id:80,value:50,params:[]}),this.applyEffect({id:71,value:-200,params:[]})):a===29875?this.applyEffect({id:160,value:3,params:[]}):a===30998&&this.applyEffect({id:177,value:20,params:[]})})}applyNerfConcentrationElementaire(){let e=this.recap.value.find(T=>T.id===122)?.value??0,i=this.recap.value.find(T=>T.id===124)?.value??0,t=this.recap.value.find(T=>T.id===123)?.value??0,a=this.recap.value.find(T=>T.id===125)?.value??0,_=[{id:122,value:e},{id:124,value:i},{id:123,value:t},{id:125,value:a}].sort((T,N)=>N.value-T.value)[0].id;122!==_&&this.applyEffect({id:122,value:Math.floor(.3*-e),params:[]}),124!==_&&this.applyEffect({id:124,value:Math.floor(.3*-i),params:[]}),123!==_&&this.applyEffect({id:123,value:Math.floor(.3*-t),params:[]}),125!==_&&this.applyEffect({id:125,value:Math.floor(.3*-a),params:[]})}applyEffectPassif(){this.applyEffectPassifGenerique(),this.applyEffectPassifClasse()}applyEffectPassifClasse(){switch(this.classeFormService.getValue()){case 1:this.applyEffectPassifFeca();break;case 2:this.applyEffectPassifOsamodas();break;case 4:this.applyEffectPassifSram();break;case 5:this.applyEffectPassifXelor();break;case 7:this.applyEffectPassifEniripsa();break;case 8:this.applyEffectPassifIop();break;case 9:this.applyEffectPassifCra();break;case 10:this.applyEffectPassifSadida();break;case 11:this.applyEffectPassifSacrieur();break;case 12:this.applyEffectPassifPandawa();break;case 14:this.applyEffectPassifZobal();break;case 15:this.applyEffectPassifOuginak();break;case 16:this.applyEffectPassifSteamer();break;case 18:this.applyEffectPassifEliotrope();break;case 19:this.applyEffectPassifHuppermage();break}}applyEffectPassifHuppermage(){this.sortFormService.getSortPassifs().find(i=>i===7193)&&this.applyEffect({id:177,value:20,params:[]})}applyEffectPassifEliotrope(){this.sortFormService.getSortPassifs().find(i=>i===7208)&&this.applyEffect({id:160,value:-1,params:[]})}applyEffectPassifSteamer(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===7181)&&this.applyEffect({id:-8,value:-30,params:[]}),e.find(t=>t===7344)&&this.applyEffect({id:20,value:6*i,params:[]}),e.find(t=>t===2819)&&this.applyEffect({id:41,value:-1,params:[]}),e.find(t=>t===2816)&&this.applyEffect({id:39,value:-30,parameterMajorAction:121,params:[]}),e.find(t=>t===5462)&&this.applyEffect({id:-8,value:-20,params:[]})}applyEffectPassifOuginak(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===6276)&&(this.applyEffect({id:-8,value:50,params:[]}),this.applyEffect({id:160,value:-2,params:[]})),e.find(t=>t===6278)&&this.applyEffect({id:875,value:30,params:[]}),e.find(t=>t===5103)&&this.applyEffect({id:41,value:1,params:[]}),e.find(t=>t===6275)&&this.applyEffect({id:-8,value:-15,params:[]}),e.find(t=>t===7343)&&this.applyEffect({id:191,value:3,params:[]}),e.find(t=>t===7557)&&this.applyEffect({id:191,value:-1,params:[]}),e.find(t=>t===6277)&&(this.applyEffect({id:-6,value:-10,params:[]}),this.applyEffect({id:39,value:30,parameterMajorAction:121,params:[]}),this.applyEffect({id:20,value:4*i,params:[]})),e.find(t=>t===7328)&&this.applyEffect({id:41,value:-1,params:[]}),e.find(t=>t===6272)&&this.applyEffect({id:-8,value:-15,params:[]}),e.find(t=>t===7193)&&(this.applyEffect({id:177,value:20,params:[]}),this.applyEffect({id:-6,value:-10,params:[]})),e.find(t=>t===7596)&&this.applyEffect({id:173,value:3*i,params:[]})}applyEffectPassifZobal(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();if(e.find(t=>t===5359)&&this.applyEffect({id:41,value:1,params:[]}),e.find(t=>t===7093)&&this.applyEffect({id:175,value:2*i,params:[]}),e.find(t=>t===7111)){let t=this.recap.value.find(a=>a.id===175)?.value??0;if(t>=0){let a=Math.min(Math.floor(t/2),2*i);this.applyEffect({id:1053,value:a,params:[]})}}if(e.find(t=>t===7104)&&this.applyEffect({id:-6,value:-25,params:[]}),e.find(t=>t===3356)&&(this.applyEffect({id:-6,value:25,params:[]}),this.applyEffect({id:39,value:-40,parameterMajorAction:121,params:[]}),this.applyEffect({id:39,value:-40,parameterMajorAction:120,params:[]})),e.find(t=>t===3363)){let t=this.recap.value.find(a=>a.id===173)?.value??0;t>=0&&this.applyEffect({id:173,value:t,params:[]}),this.applyEffect({id:41,value:-1,params:[]})}if(e.find(t=>t===7094)){let t=this.recap.value.find(a=>a.id===173)?.value??0;if(t>=0){let a=Math.min(Math.floor(t/2),2*i);this.applyEffect({id:1052,value:a,params:[]})}}e.find(t=>t===7113)&&this.applyEffect({id:177,value:10,params:[]})}applyEffectPassifPandawa(){let e=this.sortFormService.getSortPassifs();e.find(i=>i===7987)&&(this.applyEffect({id:-9,value:20,params:[]}),this.applyEffect({id:-6,value:-10,params:[]})),e.find(i=>i===5149)&&(this.applyEffect({id:-6,value:15,params:[]}),this.applyEffect({id:80,value:-50,params:[]})),e.find(i=>i===5151)&&this.applyEffect({id:-6,value:10,params:[]})}applyEffectPassifSacrieur(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();if(e.find(t=>t===7218)&&this.applyEffect({id:160,value:-2,params:[]}),e.find(t=>t===7213)&&this.applyEffect({id:39,value:-50,parameterMajorAction:121,params:[]}),e.find(t=>t===5192)){let t=this.recap.value.find(a=>a.id===173)?.value??0;t>=0&&this.applyEffect({id:173,value:-t,params:[]})}e.find(t=>t===5051)&&this.applyEffect({id:20,value:8*i,params:[]})}applyEffectPassifSadida(){this.sortFormService.getSortPassifs().find(i=>i===7193)&&this.applyEffect({id:177,value:20,params:[]})}applyEffectPassifCra(){if(this.sortFormService.getSortPassifs().find(i=>i===588)){let i=this.recap.value.find(t=>t.id===175)?.value??0;this.applyEffect({id:175,value:-i,params:[]}),this.applyEffect({id:177,value:20,params:[]})}}applyEffectPassifIop(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===525)&&this.applyEffect({id:20,value:3*i,params:[]}),e.find(t=>t===7111)&&this.applyEffect({id:39,value:-20,parameterMajorAction:121,params:[]})}applyEffectPassifEniripsa(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===5453)&&this.applyEffect({id:20,value:8*i,params:[]})}applyEffectPassifXelor(){let e=this.sortFormService.getSortPassifs();e.find(i=>i===756)&&(this.applyEffect({id:191,value:6,params:[]}),this.applyEffect({id:41,value:-2,params:[]})),e.find(i=>i===7196)&&this.applyEffect({id:191,value:-6,params:[]})}applyEffectPassifSram(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();if(e.find(t=>t===4609)&&this.applyEffect({id:184,value:4,params:[]}),e.find(t=>t===5122)&&this.applyEffect({id:1053,value:Math.floor(i*1.5),params:[]}),e.find(t=>t===5126)&&this.applyEffect({id:177,value:20,params:[]}),e.find(t=>t===2437)){let t=this.recap.value.find(r=>r.id===175)?.value??0;t>=0&&this.applyEffect({id:150,value:Math.min(Math.floor(t/20),15),params:[]});let a=this.recap.value.find(r=>r.id===173)?.value??0;a>=0&&this.applyEffect({id:150,value:Math.min(Math.floor(a/20),15),params:[]})}}applyEffectPassifOsamodas(){let e=this.sortFormService.getSortPassifs();e.find(i=>i===7340)&&this.applyEffect({id:191,value:3,params:[]}),e.find(i=>i===7333)&&this.applyEffect({id:-6,value:25,params:[]}),e.find(i=>i===7331)&&this.applyEffect({id:-6,value:20,params:[]}),e.find(i=>i===7330)&&this.applyEffect({id:160,value:2,params:[]}),e.find(i=>i===7344)&&this.applyEffect({id:80,value:-100,params:[]})}applyEffectPassifFeca(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();if(e.find(t=>t===6997)&&this.applyEffect({id:875,value:30,params:[]}),e.find(t=>t===7004)&&this.applyEffect({id:39,value:100,parameterMajorAction:120,params:[]}),e.find(t=>t===2374)&&this.applyEffect({id:39,value:-100,parameterMajorAction:121,params:[]}),e.find(t=>t===5245)&&this.applyEffect({id:-6,value:10,params:[]}),e.find(t=>t===866)){let t=this.recap.value.find(a=>a.id===875);t&&t.value<=100&&(this.applyEffect({id:39,value:t.value,parameterMajorAction:120,params:[]}),this.applyEffect({id:875,value:-t.value,params:[]}))}e.find(t=>t===2295)&&(this.applyEffect({id:39,value:-100,parameterMajorAction:121,params:[]}),this.applyEffect({id:-6,value:25,params:[]})),e.find(t=>t===6989)&&this.applyEffect({id:160,value:1,params:[]}),e.find(t=>t===7005)&&(this.applyEffect({id:20,value:3*i,params:[]}),this.applyEffect({id:-6,value:-20,params:[]}))}applyEffectPassifGenerique(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===5144)&&(this.applyEffect({id:-6,value:15,params:[]}),this.applyEffect({id:-9,value:-30,params:[]})),e.find(t=>t===4957)&&this.applyEffect({id:175,value:i,params:[]}),e.find(t=>t===4956)&&this.applyEffect({id:171,value:Math.floor(i/2),params:[]}),e.find(t=>t===4958)&&this.applyEffect({id:173,value:i,params:[]}),e.find(t=>t===5146)&&(this.applyEffect({id:-9,value:30,params:[]}),this.applyEffect({id:39,value:25,parameterMajorAction:120,params:[]}),this.applyEffect({id:-6,value:-15,params:[]})),e.find(t=>t===5237)&&(this.applyEffect({id:31,value:1,params:[]}),this.applyEffect({id:-6,value:-20,params:[]}),this.applyEffect({id:177,value:10,params:[]})),e.find(t=>t===5145)&&(this.applyEffect({id:-7,value:60,params:[]}),this.applyEffect({id:-4,value:25,params:[]}),this.applyEffect({id:-6,value:-25,params:[]}),this.applyEffect({id:-9,value:-50,params:[]}))}applyEffectByClass(){let e=this.classeFormService.getValue(),i=this.levelFormService.getValue();switch(e){case 9:this.applyEffect({id:160,value:1,params:[]});break;case 6:this.applyEffect({id:150,value:20,params:[]});break;case 11:this.applyEffect({id:20,value:4*i,params:[]});break;case 4:this.applyEffect({id:180,value:i,params:[]}),this.applyEffect({id:184,value:1,params:[]});break;case 8:this.applyEffect({id:41,value:1,params:[]});break;case 7:this.applyEffect({id:20,value:2*i,params:[]});break;case 18:(this.recap.value.find(t=>t.id===160)?.value??0)>=2&&(this.applyEffect({id:160,value:-2,params:[]}),this.applyEffect({id:41,value:1,params:[]}));break;case 5:this.applyEffect({id:191,value:6,params:[]});break}}applyNatifEffects(){this.naturalEffects.forEach(e=>this.applyEffect(e))}resetEffects(){this.recap.value.forEach(e=>e.value=0)}extractEquipEffects(e){return e.flatMap(i=>i.equipEffects)}mapToRecapStats(e){return e.map(i=>({id:i.actionId,parameterMajorAction:i.actionId!==39?void 0:i.params[4]===120?120:121,value:i.params[0],params:i.params}))}applyEffectResistance(e){if(e.id===80)this.applyEffect({id:82,value:e.value,params:e.params}),this.applyEffect({id:83,value:e.value,params:e.params}),this.applyEffect({id:84,value:e.value,params:e.params}),this.applyEffect({id:85,value:e.value,params:e.params});else if(e.id===90||e.id===100)this.applyEffect({id:82,value:-e.value,params:e.params}),this.applyEffect({id:83,value:-e.value,params:e.params}),this.applyEffect({id:84,value:-e.value,params:e.params}),this.applyEffect({id:85,value:-e.value,params:e.params});else if(e.id===1069){let i=e.params[2];i>=1&&this.applyEffect({id:82,value:e.value,params:e.params}),i>=2&&this.applyEffect({id:83,value:e.value,params:e.params}),i>=3&&this.applyEffect({id:84,value:e.value,params:e.params}),i>=4&&this.applyEffect({id:85,value:e.value,params:e.params})}else e.id===35&&this.applyEffect({id:80,value:50,params:e.params})}applyEffectMaitrisesElementaires(e){if(e.id===120)this.applyEffect({id:122,value:e.value,params:e.params}),this.applyEffect({id:124,value:e.value,params:e.params}),this.applyEffect({id:123,value:e.value,params:e.params}),this.applyEffect({id:125,value:e.value,params:e.params});else if(e.id===130)this.applyEffect({id:122,value:-e.value,params:e.params}),this.applyEffect({id:124,value:-e.value,params:e.params}),this.applyEffect({id:123,value:-e.value,params:e.params}),this.applyEffect({id:125,value:-e.value,params:e.params});else if(e.id===1068){let i=e.params[2];i>=1&&this.applyEffect({id:122,value:e.value,params:e.params}),i>=2&&this.applyEffect({id:124,value:e.value,params:e.params}),i>=3&&this.applyEffect({id:123,value:e.value,params:e.params}),i>=4&&this.applyEffect({id:125,value:e.value,params:e.params})}}applyEffect(e){this.applyEffectResistance(e),this.applyEffectMaitrisesElementaires(e);let i=this.actionService.isAMalus(e.id),t=i?this.actionService.getOpposedEffect(e.id):e.id,a=i?-1:1,r=this.recap.value.find(n=>n.id!==39&&n.id===t||n.id===39&&n.parameterMajorAction===e.parameterMajorAction);r&&(r.value+=a*e.value)}emitEffects(){this.recap.next([...this.recap.value]);let e=this.recap.value.filter(r=>[1052,1053,149,180,26,1055].includes(r.id)).filter(r=>r.value>0).reduce((r,n)=>r+n.value,0),i=Math.max(this.recap.value.find(r=>r.id===122)?.value||0,this.recap.value.find(r=>r.id===124)?.value||0,this.recap.value.find(r=>r.id===123)?.value||0,this.recap.value.find(r=>r.id===125)?.value||0,0),t=e+i;this.maitrisesTotal.next(t);let a=this.recap.value.filter(r=>[82,83,84,85].includes(r.id)).reduce((r,n)=>r+n.value,0);this.resistancesTotal.next(a)}static \u0275fac=function(i){return new(i||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:"root"})};export{Q as a,pe as b,Ee as c,He as d,We as e,Ke as f};
