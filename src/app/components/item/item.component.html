<!-- eslint-disable @angular-eslint/template/interactive-supports-focus -->
<!-- eslint-disable @angular-eslint/template/click-events-have-key-events -->
 @if(item) {
    <div class="header">
        <span [matTooltip]="'item.copier' | translate" class="imgContainer fileCopy" (click)="copyToClipboard()"><mat-icon fontIcon="file_copy"></mat-icon></span>
        <span><img [src]="imageService.getActionIdUrl(IdActionEnum.MAITRISES_ELEMENTAIRES)" alt="Maitrises">{{ "item.maitrises" | translate }} {{Math.trunc(item.maitrise)}}</span>
        <span><img [src]="imageService.getActionIdUrl(IdActionEnum.RESISTANCES_ELEMENTAIRE)" alt="Résistances">{{ "item.resistances" | translate }} {{item.resistance}}</span>
        <span class="imgContainer" (click)="openEncyclopedie(item.id)"><img src="aptitudes/Encyclopédie.png" alt="Encyclopédie"></span>
    </div>
    @if (textCondition() | async; as condition) {
        <div class="condition">
            [ {{ condition }} ]
        </div>
    }
    <div class="content" (click)="setItemChoosen()">
        <div class="title">
            <h3 [style.color]="colorRarityService.mapColors.get(item.rarity)">{{getTitle()}} ({{item.level}}) <img [src]="itemTypeService.getLogo(itemTypeService.getItemType(item.itemTypeId))" alt="item type logo"> </h3>
            <img [src]="imageService.getItemUrl(item.idImage)" alt="items" appFallback>
            <div class="poids" [matTooltip]="'item.poids-infobulle' | translate:{ratio: itemService.ratioWeightByLevel(item.level)}" [matTooltipShowDelay]="300" ><img [src]="'aptitudes/poids.png'" alt="poids">{{ "item.poids" | translate }} {{item.weight}}</div>
        </div>
        <div class="effects">
            <div>
            @for (effect of item.equipEffects; track effect.id) {
                <p>
                    @if (effect.actionId !== IdActionEnum.APPLIQUE_ETAT) {
                        <img  [src]="getEffectPng(effect)" alt="aptitudes">  {{ effect | actions | async }}
                    } @else {
                        @let state = statesService.findStates(effect.params[0]);
                        <span class="appliqueEtat" 
                            (mouseenter)="openStatesTooltip($event, state?.id ?? 0, getStatesTranslate(state))"
                            (mouseleave)="stateTooltipService.closeTooltip()"
                        >
                            {{ getStatesTranslate(state) }}
                        </span>
                    }
                </p>
            }
            </div>
            <div class="craftAndDrop">
                @if (item.isCraftable) {
                    <img [src]="imageService.getItemUrl(71919810)" alt="craftable" [matTooltip]="'item.craftable' | translate">
                }
                @if(item.isDropable) {
                    <img [src]="imageService.getItemUrl(60625177)" alt="droppable" [matTooltip]="'item.droppable' | translate">
                }
            </div>
        </div>
    </div>
 }

@if (itemChoosen$ | async; as itemChoosen) {
    @if(itemIsPresentAndNotChoosen(itemChoosen)) {
        <mat-icon
            class="iconComparator"
            fontIcon="swap_horiz"
            (mouseenter)="openTooltip($event, item)" 
            (mouseleave)="tooltipService.closeTooltip()"
        ></mat-icon>
    }
}
