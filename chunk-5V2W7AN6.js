import{a as Ke}from"./chunk-VM7FY4PG.js";import{a as Ge,c as ze,d as He}from"./chunk-SIVPNUJP.js";import{a as Be,b as ke,c as le}from"./chunk-MSGFVUGO.js";import{a as se,b as q,c as ne,e as qe,u as Ee,v as he,w as ce,y as Xe}from"./chunk-IDGI6SUT.js";import{$ as Ne,$c as je,A as Y,B as ge,Bd as We,Cd as pe,D as $,E as v,Ea as A,Ga as R,Ha as V,I as h,Ja as F,Jb as ee,Ka as x,La as d,M as p,Ma as m,Na as l,Oa as C,Pa as Ce,Q as g,Qa as ue,R as N,Sa as w,Ua as y,Ub as te,Vb as k,Wa as c,_c as Qe,b as Me,bd as Q,c as Ue,cc as ie,cd as ae,d as U,dd as re,ed as b,fb as z,ga as T,hb as H,hd as $e,i as _,ia as o,ib as u,j as G,jb as Le,kb as B,lb as D,oa as ye,pa as L,pb as Fe,pd as oe,q as Oe,qb as xe,rb as Ve,rd as E,sa as De,t as Pe,ta as J,ub as be,vb as f,wb as I,xb as we}from"./chunk-5GHXMGLA.js";import{a as X,b as Z}from"./chunk-EQDQRRRY.js";var Ze=class a{isDisplayed=new U(!1);isDisplayed$=this.isDisplayed.asObservable();toggleDisplay(){this.isDisplayed.next(!this.isDisplayed.value)}setDisplay(e){this.isDisplayed.next(e)}static \u0275fac=function(i){return new(i||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};var me=class a{condition=new Map;http=p(ie);loadPromise;load(){return this.loadPromise?this.loadPromise:(this.loadPromise=new Promise(e=>{this.http.get("/itemConditions.json").pipe(v(i=>i.forEach(t=>this.condition.set(t.id,t))),Y(1)).subscribe({next:()=>e(),error:i=>{console.error("Failed to load monster drops:",i),e()}})}),this.loadPromise)}findCondition(e){return this.condition.get(e)}static \u0275fac=function(i){return new(i||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};var fe=class a{stateDefinitionService=new Map;http=p(ie);loadPromise;load(){return this.loadPromise?this.loadPromise:(this.loadPromise=new Promise(e=>{this.http.get("/statesDefinition.json").pipe(v(i=>i.forEach(t=>this.stateDefinitionService.set(t.id,{id:t.id,description:{fr:t.description.fr,en:t.description.en,es:t.description.es,pt:t.description.pt}}))),Y(1)).subscribe({next:()=>e(),error:i=>{console.error("Failed to load monster drops:",i),e()}})}),this.loadPromise)}findStatesDefinition(e){return this.stateDefinitionService.get(e)}static \u0275fac=function(i){return new(i||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};var j=class a{translateService=p(Q);ankamaCdnFacade=p(q);static malusActions=new Set([21,40,56,57,90,96,97,98,100,130,132,161,168,172,174,176,181,192,194,876,1056,1059,1060,1061,1062,1063]);static opposedEffects=new Map;static opposedPairs=[[20,21],[39,40,!0],[80,90],[84,96],[82,97],[83,98],[80,100],[120,130],[122,132],[150,168],[171,172],[173,174],[175,176],[180,181],[191,192],[193,194],[875,876],[149,1056],[1052,1059],[1053,1060],[1055,1061],[988,1062],[71,1063],[31,56],[41,57],[160,161]];constructor(){for(let[e,i]of a.opposedPairs)a.opposedEffects.set(e,i),a.opposedEffects.set(i,e)}getEffectById(e){let i=this.ankamaCdnFacade.getActionList().find(t=>t.definition.id===e);return i?`${i.description[this.translateService.currentLang]}`:""}isAMalus(e){return a.malusActions.has(e)}isOpposed(e,i){let t=e.actionId,r=i.actionId;for(let[s,n,S]of a.opposedPairs)if((t===s||r===s)&&(t===n||r===n))return S?e.params[4]===i.params[4]:!0;return!1}getOpposedEffect(e){return a.opposedEffects.get(e)??e}static \u0275fac=function(i){return new(i||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};var W=class a{ankamaCdnFacade=p(q);translateService=p(Q);actionService=p(j);transform(e){return G([this.translateService.onLangChange.pipe(ge({lang:this.translateService.currentLang,translations:{}})),this.ankamaCdnFacade.action$]).pipe(_(([,i])=>i),_(i=>this.findAction(i,e)),_(i=>this.getDefinitions(i)),_(i=>this.getDefinitionsComplete(i,e)))}getDefinitionsComplete(e,i){let t=`${e}`;return t=this.replaceValues(t,i),t=this.cleanHeaderDefinition(t),t=this.cleanRecoltEffect(t),t=this.singularOrPlurial(t,i),t=this.atLeastSixParameters(t,i),t=this.armorGivenOrReceived(t,i),t=this.deleteDoubleMinus(t),t}deleteDoubleMinus(e){return e.replace(/--/g,"")}armorGivenOrReceived(e,i){if(i.actionId!==39&&i.actionId!==40)return e;let t=i.params[4]===120?this.translateService.instant("abstract.donnee"):this.translateService.instant("abstract.recue"),r=Math.abs(i.params[0]),s=this.actionService.isAMalus(i.actionId);return(s&&i.params[0]>0||!s&&i.params[0]<0?"-":"")+r+this.translateService.instant("abstract.armure")+t}atLeastSixParameters(e,i){let t=/{\[~3\]\?(.*):(.*)}/,r=e.match(t);return r&&(e=r[i.params.length>=6?1:2]),e}singularOrPlurial(e,i){return e=this.singularOrPlurialWithRegex(e,i,/\{\[>2\]\?([^}]){0,5}:([^}]){0,5}\}/g,2),e=this.singularOrPlurialWithRegex(e,i,/\{\[>1\]\?([^}]){0,5}:([^}]){0,5}\}/g),e}singularOrPlurialWithRegex(e,i,t,r=0){let s=[...e.matchAll(t)];if(s&&i.params.length>r){let n=s.map(S=>S[i.params[r]>=2?1:2]);for(let S=0;S<s.length;S++)e=e.replace(s[S][0],n[S]??"")}return e}cleanDefinition(e,i){let t=e.match(i);return t&&(e=e.replace(t[0],"")),e}cleanRecoltEffect(e){return this.cleanDefinition(e,/{\[~2]?.+}/g)}cleanHeaderDefinition(e){return this.cleanDefinition(e,/(\[#.*\]) /g)}replaceValues(e,i){let t=/(\[#\d\])/g,r=[...e.matchAll(t)].map(s=>s[1]);if(r)for(let s of r){let n=0;switch(s){case"[#1]":n=0;break;case"[#2]":n=2;break;case"[#3]":n=4;break}i.params.length>n&&(e=e.replace(s,i.params[n].toString()))}return e}getDefinitions(e){return e.description[this.translateService.currentLang]}findAction(e,i){return e.filter(t=>t.definition.id===i.actionId)[0]}static \u0275fac=function(i){return new(i||a)};static \u0275pipe=De({name:"actions",type:a,pure:!0})};var de=class a{AnkamaCdnFacade=p(q);findStates(e){let i=this.AnkamaCdnFacade.getStatesList().find(t=>t.definition.id===e);if(i)return{id:i.definition.id,fr:i.title.fr,en:i.title.en,es:i.title.es,pt:i.title.pt}}static \u0275fac=function(i){return new(i||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};var K=class a{translateService=p(Q);itemTypeService=p(qe);itemChooseService=p(ce);actionsService=p(j);statesService=p(de);imageService=p($e);destroy$=new Ue;resistances=0;maitrises=0;IdActionEnum=b;mapSortAction=new Map([[31,0],[56,1],[41,2],[57,3],[193,4],[191,4],[192,5],[184,6],[160,7],[161,8],[20,9],[21,10],[173,11],[175,12],[172,13],[875,14],[174,15],[176,16],[876,17],[120,18],[1068,19],[149,20],[180,21],[26,22],[1055,23],[1053,24],[1052,25],[1056,26],[181,27],[1061,28],[1060,29],[1059,30],[150,31],[39,32],[168,33],[40,34],[988,35],[71,36],[80,37],[1069,38],[82,39],[83,40],[85,41],[84,42],[1062,43],[1063,44],[90,45],[97,46],[98,47],[96,48]]);Math=Math;itemChoosen$=new U([[]]);IdActionsEnum=b;getEffectPng(e){return this.imageService.getActionIdUrl(e.actionId,e.actionId===39&&e.params[4]===121)}initItemChoosen(e){let i=this.itemTypeService.getItemType(e.itemTypeId);if(!i)return;let t=new Me;i===13?t=this.itemChooseService.getObsItem(12).pipe(_(r=>[r])):i===1?t=G([this.itemChooseService.getObsItem(2),this.itemChooseService.getObsItem(12)]).pipe(_(([r,s])=>[r,s])):t=this.itemChooseService.getObsItem(i).pipe(_(r=>[r])),t.pipe($(this.destroy$)).subscribe(r=>this.itemChoosen$.next(r))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=L({type:a,selectors:[["app-item"]],decls:0,vars:0,template:function(i,t){},encapsulation:2})};function it(a,e){if(a&1&&(m(0,"div",0)(1,"span"),C(2,"img",7),u(3),f(4,"translate"),l(),m(5,"span"),C(6,"img",8),u(7),f(8,"translate"),l()()),a&2){let i=c();o(),H(i.getBackgroundDifferentsStatsOnValue(i.maitrises)),o(),d("src",i.imageService.getActionIdUrl(i.IdActionEnum.MAITRISES_ELEMENTAIRES),T),o(),D("",I(4,10,"item.maitrises")," ",i.Math.trunc(i.maitrises)),o(2),H(i.getBackgroundDifferentsStatsOnValue(i.resistances)),o(),d("src",i.imageService.getActionIdUrl(i.IdActionEnum.RESISTANCES_ELEMENTAIRE),T),o(),D("",I(8,12,"item.resistances")," ",i.resistances)}}function at(a,e){if(a&1&&(m(0,"div",4)(1,"h3"),u(2),l(),C(3,"img",9),l()),a&2){let i=e.$implicit,t=c(2);o(),z("color",t.colorRarityService.mapColors.get(i.rarity)),o(),D("",t.getTitle(i)," (",i.level,")"),o(),d("src",t.imageService.getItemUrl(i.idImage),T)}}function rt(a,e){a&1&&F(0,at,4,5,"div",4,V),a&2&&x(e)}function st(a,e){if(a&1&&(C(0,"img",11),u(1),f(2,"actions"),f(3,"async")),a&2){let i=c().$implicit,t=c(2);d("src",t.getEffectPng(i),T),o(),B(" ",I(3,4,I(2,2,i))," ")}}function nt(a,e){if(a&1&&(m(0,"p"),A(1,st,4,6),l()),a&2){let i=e.$implicit,t=c(2);H(t.getBackgroundDifferentsStats(i)),o(),R(i.actionId!==t.IdActionEnum.APPLIQUE_ETAT&&i.value!==0?1:-1)}}function ot(a,e){a&1&&(m(0,"div"),F(1,nt,2,3,"p",10,V),l()),a&2&&(o(),x(e))}var _e=class a extends K{itemService=p(Ee);colorRarityService=p(ne);cdr=p(ee);item;indexItemChoosen=0;ARMURE_DONNEE_RECUE=[39,40];listDifferentsStatsItem=[];loaded$;weight=0;itemSelected$=this.itemChoosen$.pipe(Oe(e=>e.length!==0),_(e=>e.map(i=>i[this.indexItemChoosen])),_(e=>e.length>=2&&e[0]?.id===e[1]?.id?[e.find(i=>i!==void 0)]:e),_(e=>e.filter(i=>i!==void 0)));differentStatsItemList$=this.itemSelected$.pipe($(this.destroy$),v(e=>{this.listDifferentsStatsItem=[],this.fillListCurrentItem(),e.forEach(i=>i?this.fillMapDifferentStatsItem(i):"")}),_(()=>this.listDifferentsStatsItem.sort((e,i)=>(this.mapSortAction.get(e.actionId)??999)-(this.mapSortAction.get(i.actionId)??999))));constructor(){super()}ngAfterViewInit(){this.item&&(this.item.equipEffects=this.item.equipEffects.sort((e,i)=>(this.mapSortAction.get(e.actionId)??999)-(this.mapSortAction.get(i.actionId)??999)),this.loaded$=this.itemSelected$.pipe($(this.destroy$),_(e=>(this.resistances=this.item.resistance,this.maitrises=this.item.maitrise,this.weight=this.itemService.calculWeight(this.resistances,this.maitrises,this.item.level),e.forEach(i=>{i&&(this.resistances-=i.resistance,this.maitrises-=i.maitrise,this.weight=this.itemService.calculWeight(this.resistances,this.maitrises,i.level))}),!0))),this.initItemChoosen(this.item),this.cdr.detectChanges())}setItem(e){let i=this.itemTypeService.getItemType(e.itemTypeId);i&&this.itemChooseService.setItem(i,e)}getTitle(e){return e?e.title[this.translateService.currentLang]:""}getBackgroundDifferentsStatsOnValue(e){return e>0?"green":e<0?"red":""}getBackgroundDifferentsStats(e){let i=this.actionsService.isAMalus(e.actionId);return e.value>0&&!i||e.value<0&&i||e.presentOnCurrentItem&&!e.presentOnEquippedItem&&!i?"green":e.value<0&&!i||e.value>0&&i||!e.presentOnCurrentItem&&e.presentOnEquippedItem&&i?"red":""}getByActionId(e,i){return this.listDifferentsStatsItem.find(t=>t.actionId===e&&t.isArmureRecue===i)}pushSetDifferentsStatsItem(e){e&&(this.listDifferentsStatsItem=this.listDifferentsStatsItem.filter(i=>i.actionId!==e.actionId||i.isArmureRecue!==e.isArmureRecue),this.listDifferentsStatsItem.push(e))}fillListCurrentItem(){this.item.equipEffects.forEach(e=>{let i=this.ARMURE_DONNEE_RECUE.includes(e.actionId)&&e.params[4]===121,t=this.getByActionId(e.actionId,i);if(t){let r=t.params;r[0]+=e.params[0],t=Z(X({},t),{value:t.value+e.params[0],params:r,presentOnCurrentItem:!0})}else t={value:e.params[0],params:[...e.params],actionId:e.actionId,presentOnCurrentItem:!0,presentOnEquippedItem:!1,isArmureRecue:i};this.pushSetDifferentsStatsItem(t)})}fillMapDifferentStatsItem(e){e.equipEffects.forEach(i=>{let t=this.ARMURE_DONNEE_RECUE.includes(i.actionId)&&i.params[4]===121,r=this.getByActionId(i.actionId,t),s=this.item.equipEffects.find(n=>this.actionsService.isOpposed(n,i));if(s){let n=[...i.params];n[0]=s.params[0]+n[0],r={value:s.params[0]+i.params[0],params:n,actionId:s.actionId,presentOnCurrentItem:!0,presentOnEquippedItem:!0,isArmureRecue:t}}else if(r&&r.isArmureRecue===t){let n=r.params;n[0]-=i.params[0],r=Z(X({},r),{value:r.value-i.params[0],params:n,presentOnEquippedItem:!0})}else{let n=[...i.params];n[0]=-n[0],r={value:-i.params[0],params:n,actionId:i.actionId,presentOnCurrentItem:!1,presentOnEquippedItem:!0,isArmureRecue:t}}this.pushSetDifferentsStatsItem(r)}),this.calculDifferenceResistance()}calculDifferenceResistance(){let e=this.getByActionId(80,!1),i=[82,83,85,84];e&&i.find(t=>this.getByActionId(t,!1))&&(i.forEach(t=>{let r=this.getByActionId(t,!1);r?(r.params[0]+=e.params[0],r.value+=e.params[0],r.presentOnCurrentItem=!0,r.presentOnEquippedItem=!0):r=Z(X({},e),{actionId:t,presentOnCurrentItem:!0,presentOnEquippedItem:!0}),this.pushSetDifferentsStatsItem(r)}),this.listDifferentsStatsItem=this.listDifferentsStatsItem.filter(t=>t.actionId!==80))}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=L({type:a,selectors:[["app-item-tooltip"]],inputs:{item:"item",indexItemChoosen:"indexItemChoosen"},features:[J],decls:17,vars:21,consts:[[1,"header"],[1,"content",3,"click"],[1,"column"],[1,"row"],[1,"title"],["alt","item",3,"src"],["alt","poids",3,"src"],["alt","Maitrises",3,"src"],["alt","Resistances",3,"src"],["appFallback","","alt","items",3,"src"],[3,"class"],["alt","aptitudes",3,"src"]],template:function(i,t){if(i&1&&(A(0,it,9,14,"div",0),f(1,"async"),m(2,"div",1),y("click",function(){return t.setItem(t.item)}),m(3,"div",2)(4,"div",3)(5,"div",4)(6,"h3"),u(7),l(),C(8,"img",5),l(),A(9,rt,2,0),f(10,"async"),l(),m(11,"span"),C(12,"img",6),u(13),f(14,"translate"),l()(),A(15,ot,3,0,"div"),f(16,"async"),l()),i&2){let r,s;R(I(1,13,t.loaded$)?0:-1),o(6),z("color",t.colorRarityService.mapColors.get(t.item.rarity)),o(),D("",t.getTitle(t.item)," (",t.item.level,")"),o(),d("src",t.imageService.getItemUrl(t.item.idImage),T),o(),R((r=I(10,15,t.itemSelected$))?9:-1,r),o(2),H(t.getBackgroundDifferentsStatsOnValue(t.weight)+" poids"),o(),d("src","aptitudes/poids.png",T),o(),D("",I(14,17,"item.poids")," ",t.weight," "),o(2),R((s=I(16,19,t.differentStatsItemList$))?15:-1,s)}},dependencies:[k,re,se,te,ae,W],styles:["[_nghost-%COMP%]{background:linear-gradient(145deg,#0d1b2a,#415a77);border-radius:15px;padding:5px;color:#fff;height:fit-content;width:600px;display:flex;flex-direction:column;box-shadow:0 8px 8px #0009;position:relative}[_nghost-%COMP%]   span[_ngcontent-%COMP%]{border-radius:10px;width:200px;display:flex;justify-content:space-around;align-items:center;margin:2px auto}[_nghost-%COMP%]   .green[_ngcontent-%COMP%]{background:linear-gradient(145deg,#4caf50,#00c896)}[_nghost-%COMP%]   .red[_ngcontent-%COMP%]{background:linear-gradient(145deg,#e63946,#ff6b35)}[_nghost-%COMP%]   .green[_ngcontent-%COMP%], [_nghost-%COMP%]   .red[_ngcontent-%COMP%]{color:#0d1b2a}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;border-bottom:3px solid #415A77;margin-bottom:10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;cursor:pointer}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{width:50px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:space-around;cursor:pointer}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-around;align-items:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{margin-right:10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;max-width:30%;flex-direction:column}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;margin:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center;margin:2px 0;border-radius:20px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .poids[_ngcontent-%COMP%]{align-items:center;display:flex;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .poids[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px;height:22px;margin:0 10px}[_nghost-%COMP%]   .iconComparator[_ngcontent-%COMP%]{position:absolute;right:10px;bottom:10px;color:#415a77;background-color:#e5e9ea;border-radius:50%;cursor:pointer;border:5px solid #0D1B2A}@media screen and (max-width: 700px){[_nghost-%COMP%]{width:300px;font-size:12px}}@media screen and (max-width: 700px){  .cdk-overlay-pane{transform:none!important}}"]})};function pt(a,e){if(a&1&&C(0,"app-item-tooltip",0),a&2){let i=c().$index,t=c();d("item",t.item)("indexItemChoosen",i)}}function Et(a,e){if(a&1&&A(0,pt,1,2,"app-item-tooltip",0),a&2){let i=e.$index,t=c();R(t.itemsChoosen[i]!==void 0?0:-1)}}var Ae=class a{item;itemsChoosen=[];static \u0275fac=function(i){return new(i||a)};static \u0275cmp=L({type:a,selectors:[["app-items-tooltip"]],inputs:{item:"item",itemsChoosen:"itemsChoosen"},decls:2,vars:0,consts:[[3,"item","indexItemChoosen"]],template:function(i,t){i&1&&F(0,Et,1,1,null,null,V),i&2&&x(t.itemsChoosen)},dependencies:[k,_e],encapsulation:2})};function ct(a,e){if(a&1&&(Ce(0,"div"),u(1),ue()),a&2){let i=c();o(),B(" ",i.definition()," ")}}var Re=class a{statesDefinitionService=p(fe);translateService=p(Q);statesDefinitionId=0;nameStates="";definition(){let e=this.statesDefinitionService.findStatesDefinition(this.statesDefinitionId);if(e)return e.description[this.translateService.currentLang]}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=L({type:a,selectors:[["app-states"]],inputs:{statesDefinitionId:"statesDefinitionId",nameStates:"nameStates"},decls:4,vars:2,consts:[[1,"header"]],template:function(i,t){i&1&&(Ce(0,"div",0)(1,"span"),u(2),ue()(),A(3,ct,2,1,"div")),i&2&&(o(2),Le(t.nameStates),o(),R(t.definition()?3:-1))},dependencies:[k],styles:["[_nghost-%COMP%]{background:linear-gradient(145deg,#0d1b2a,#415a77);border-radius:15px;padding:10px;color:#fff;display:flex;flex-direction:column;box-shadow:0 8px 8px #0009;position:relative}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;border-bottom:3px solid #415A77;margin-bottom:10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;margin:auto}"]})};var lt=a=>({ratio:a}),mt=(a,e)=>e.id;function ft(a,e){a&1&&(m(0,"div",7),u(1),l()),a&2&&(o(),B(" [ ",e," ] "))}function dt(a,e){if(a&1&&(C(0,"img",19),u(1),f(2,"actions"),f(3,"async")),a&2){let i=c().$implicit,t=c(2);d("src",t.getEffectPng(i),T),o(),B(" ",I(3,4,I(2,2,i))," ")}}function It(a,e){if(a&1){let i=w();Fe(0),m(1,"span",20),y("mouseenter",function(r){g(i);let s=Ve(0),n=c(3);return N(n.openStatesTooltip(r,(s==null?null:s.id)??0,n.getStatesTranslate(s)))})("mouseleave",function(){g(i);let r=c(3);return N(r.stateTooltipService.closeTooltip())}),u(2),l()}if(a&2){let i=c().$implicit,t=c(2),r=xe(t.statesService.findStates(i.params[0]));o(2),B(" ",t.getStatesTranslate(r)," ")}}function _t(a,e){if(a&1&&(m(0,"p"),A(1,dt,4,6)(2,It,3,2,"span",18),l()),a&2){let i=e.$implicit,t=c(2);o(),R(i.actionId!==t.IdActionEnum.APPLIQUE_ETAT?1:2)}}function At(a,e){if(a&1){let i=w();m(0,"img",21),f(1,"translate"),y("click",function(){g(i);let r=c(2);return N(r.navigateToCraftku())}),l()}if(a&2){let i=c(2);d("src",i.imageService.getItemUrl(71919810),T)("matTooltip",I(1,2,"item.craftable"))}}function Rt(a,e){if(a&1){let i=w();m(0,"img",23),f(1,"translate"),y("click",function(){let r=g(i).$implicit,s=c(3);return N(s.openEncyclopedieForMonster(r.idMob))}),l()}if(a&2){let i=e.$implicit,t=c(3);d("src",t.imageService.getMonsterUrl(i.gfxId),T)("matTooltip",`${I(1,2,"item.droppable")} (${t.nameMonster(i)})`)}}function St(a,e){if(a&1&&F(0,Rt,2,4,"img",22,V),a&2){let i=c(2);x(i.item.mobDropable)}}function Tt(a,e){if(a&1){let i=w();m(0,"img",25),f(1,"translate"),y("click",function(){let r=g(i).$implicit,s=c(3);return N(s.openEncyclopedieForMonster(r.idMob))}),l()}if(a&2){let i=e.$implicit,t=c(3);d("src",t.imageService.getMonsterUrl(i.gfxId),T)("matTooltip",`${I(1,2,"item.boss-drop")} (${t.nameMonster(i)})`)}}function Ct(a,e){if(a&1&&F(0,Tt,2,4,"img",24,V),a&2){let i=c(2);x(i.item.bossDropable)}}function ut(a,e){if(a&1){let i=w();m(0,"img",27),f(1,"translate"),y("click",function(){let r=g(i).$implicit,s=c(3);return N(s.openEncyclopedieForMonster(r.idMob))}),l()}if(a&2){let i=e.$implicit,t=c(3);d("src",t.imageService.getMonsterUrl(i.gfxId),T)("matTooltip",`${I(1,2,"item.archi-drop")} (${t.nameMonster(i)})`)}}function ht(a,e){if(a&1&&F(0,ut,2,4,"img",26,V),a&2){let i=c(2);x(i.item.archiDropable)}}function vt(a,e){if(a&1&&(C(0,"img",17),f(1,"translate")),a&2){let i=c(2);d("src",i.imageService.getItemUrl(53124705),T)("matTooltip",I(1,2,"item.pvp"))}}function Mt(a,e){if(a&1){let i=w();m(0,"div",0)(1,"span",1),f(2,"translate"),y("click",function(){g(i);let r=c();return N(r.copyToClipboard())}),C(3,"mat-icon",2),l(),m(4,"span"),C(5,"img",3),u(6),f(7,"translate"),l(),m(8,"span"),C(9,"img",4),u(10),f(11,"translate"),l(),m(12,"span",5),y("click",function(){g(i);let r=c();return N(r.openEncyclopedie(r.item.id))}),C(13,"img",6),l()(),A(14,ft,2,1,"div",7),f(15,"async"),m(16,"div",8),y("click",function(){g(i);let r=c();return N(r.setItemChoosen())}),m(17,"div",9)(18,"h3"),u(19),C(20,"img",10),l(),C(21,"img",11),m(22,"div",12),f(23,"translate"),C(24,"img",13),u(25),f(26,"translate"),l()(),m(27,"div",14)(28,"div"),F(29,_t,3,1,"p",null,mt),l(),m(31,"div",15),A(32,At,2,4,"img",16),A(33,St,2,0),A(34,Ct,2,0),A(35,ht,2,0),A(36,vt,2,4,"img",17),l()()()}if(a&2){let i,t=c();o(),d("matTooltip",I(2,24,"item.copier")),o(4),d("src",t.imageService.getActionIdUrl(t.IdActionEnum.MAITRISES_ELEMENTAIRES),T),o(),D("",I(7,26,"item.maitrises")," ",t.Math.trunc(t.item.maitrise)),o(3),d("src",t.imageService.getActionIdUrl(t.IdActionEnum.RESISTANCES_ELEMENTAIRE),T),o(),D("",I(11,28,"item.resistances")," ",t.item.resistance),o(4),R((i=I(15,30,t.textCondition()))?14:-1,i),o(4),z("color",t.colorRarityService.mapColors.get(t.item.rarity)),o(),D("",t.getTitle()," (",t.item.level,") "),o(),d("src",t.itemTypeService.getLogo(t.itemTypeService.getItemType(t.item.itemTypeId)),T),o(),d("src",t.imageService.getItemUrl(t.item.idImage),T),o(),d("matTooltip",we(23,32,"item.poids-infobulle",be(37,lt,t.itemService.ratioWeightByLevel(t.item.level))))("matTooltipShowDelay",300),o(2),d("src","aptitudes/poids.png",T),o(),D("",I(26,35,"item.poids")," ",t.item.weight),o(4),x(t.item.equipEffects),o(3),R(t.item.isCraftable?32:-1),o(),R(t.item.mobDropable?33:-1),o(),R(t.item.bossDropable?34:-1),o(),R(t.item.archiDropable?35:-1),o(),R(t.item.isPvP?36:-1)}}function Ut(a,e){if(a&1){let i=w();m(0,"mat-icon",29),y("mouseenter",function(r){g(i);let s=c(2);return N(s.openTooltip(r,s.item))})("mouseleave",function(){g(i);let r=c(2);return N(r.tooltipService.closeTooltip())}),l()}}function Ot(a,e){if(a&1&&A(0,Ut,1,0,"mat-icon",28),a&2){let i=c();R(i.itemIsPresentAndNotChoosen(e)?0:-1)}}var Ye=class a extends K{viewContainerRef=p(ye);el=p(Ne);itemService=p(Ee);colorRarityService=p(ne);tooltipService=p(he);stateTooltipService=p(he);cdr=p(ee);itemConditionService=p(me);item;condition=new U(void 0);condition$=this.condition.asObservable();constructor(){super()}navigateToCraftku(){window.open("https://craftkfu.waklab.fr/?"+this.item.id,"_blank")}setItemChoosen(){let e=this.itemTypeService.getItemType(this.item.itemTypeId);e&&this.itemChooseService.setItem(e,this.item)}itemIsPresentAndNotChoosen(e){return!!e.find(i=>i.find(t=>t!==void 0)&&!i.find(t=>t?.id===this.item.id))}ngAfterViewInit(){if(this.item){this.item.equipEffects=this.item.equipEffects.sort((i,t)=>(this.mapSortAction.get(i.actionId)??999)-(this.mapSortAction.get(t.actionId)??999)),this.initItemChoosen(this.item);let e=this.itemConditionService.findCondition(this.item.id);e&&this.condition.next(e),this.cdr.detectChanges()}}textCondition(){return this.condition$.pipe(_(e=>e?.description[this.translateService.currentLang]??void 0))}nameMonster(e){return e.name[this.translateService.currentLang]??""}openTooltip(e,i){let t=e.pageX>window.screen.width/2;this.tooltipService.closeTooltip(),this.itemChoosen$.pipe(Pe(1),_(r=>r.find(s=>s.find(n=>n)))).subscribe(r=>{this.tooltipService.openTooltip(this.viewContainerRef,Ae,e,{item:i,itemsChoosen:r},[{originX:t?"end":"center",originY:"bottom",overlayX:t?"end":"center",overlayY:"bottom",offsetY:0,offsetX:t?-this.el.nativeElement.offsetWidth:340}],!1)})}openEncyclopedie(e){window.open("https://www.wakfu.com/fr/mmorpg/encyclopedie/armures/"+e)}openEncyclopedieForMonster(e){window.open("https://www.wakfu.com/fr/mmorpg/encyclopedie/monstres/"+e)}copyToClipboard(){navigator.clipboard.writeText(this.item.title[this.translateService.currentLang])}getStatesTranslate(e){if(!e)return"";let i=this.translateService.currentLang;return e[i].toString()??""}getTitle(){return this.item.title[this.translateService.currentLang]}openStatesTooltip(e,i,t){this.stateTooltipService.closeTooltip(),this.stateTooltipService.openTooltip(this.viewContainerRef,Re,e,{statesDefinitionId:i,nameStates:t},[{originX:"center",originY:"top",overlayX:"center",overlayY:"top",offsetY:20,offsetX:0}])}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=L({type:a,selectors:[["app-item"]],inputs:{item:"item"},features:[J],decls:3,vars:4,consts:[[1,"header"],[1,"imgContainer","fileCopy",3,"click","matTooltip"],["fontIcon","file_copy"],["alt","Maitrises",3,"src"],["alt","R\xE9sistances",3,"src"],[1,"imgContainer",3,"click"],["src","aptitudes/Encyclop\xE9die.png","alt","Encyclop\xE9die"],[1,"condition"],[1,"content",3,"click"],[1,"title"],["alt","item type logo",3,"src"],["alt","items","appFallback","",3,"src"],[1,"poids",3,"matTooltip","matTooltipShowDelay"],["alt","poids",3,"src"],[1,"effects"],[1,"craftAndDrop"],["alt","craftable",1,"craftable",3,"src","matTooltip"],["alt","pvp",3,"src","matTooltip"],[1,"appliqueEtat"],["alt","aptitudes",3,"src"],[1,"appliqueEtat",3,"mouseenter","mouseleave"],["alt","craftable",1,"craftable",3,"click","src","matTooltip"],["alt","droppable","appFallback","",1,"monster",3,"src","matTooltip"],["alt","droppable","appFallback","",1,"monster",3,"click","src","matTooltip"],["alt","boss drop","appFallback","",1,"monster",3,"src","matTooltip"],["alt","boss drop","appFallback","",1,"monster",3,"click","src","matTooltip"],["alt","archi drop","appFallback","",1,"monster",3,"src","matTooltip"],["alt","archi drop","appFallback","",1,"monster",3,"click","src","matTooltip"],["fontIcon","swap_horiz",1,"iconComparator"],["fontIcon","swap_horiz",1,"iconComparator",3,"mouseenter","mouseleave"]],template:function(i,t){if(i&1&&(A(0,Mt,37,39),A(1,Ot,1,1),f(2,"async")),i&2){let r;R(t.item?0:-1),o(),R((r=I(2,2,t.itemChoosen$))?1:-1,r)}},dependencies:[k,ke,Be,re,je,Qe,se,Ge,te,ae,W],styles:["[_nghost-%COMP%]{background:linear-gradient(145deg,#0d1b2a,#415a77);border-radius:15px;padding:5px;color:#fff;height:100%;width:100%;display:flex;flex-direction:column;box-shadow:0 8px 8px #0009;position:relative}[_nghost-%COMP%]   span[_ngcontent-%COMP%]{border-radius:10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;border-bottom:3px solid #415A77;margin-bottom:10px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;margin:auto}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:0 5px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:40px;height:40px;cursor:pointer;align-content:center}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{width:50px;height:50px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .imgContainer[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{transform:scale(1.2)}[_nghost-%COMP%]   .condition[_ngcontent-%COMP%]{text-align:center;color:red;font-weight:bolder;margin-bottom:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:space-around;cursor:pointer}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{margin-right:10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;max-width:30%;flex-direction:column}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:30px;min-width:30px;min-height:30px;vertical-align:middle}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:80px;height:80px;min-width:80px;min-height:80px;margin:auto;object-fit:contain;border-radius:8px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .poids[_ngcontent-%COMP%]{align-items:center;display:flex;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .poids[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px;height:22px;min-width:22px;min-height:22px;margin:0 10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0;border-radius:20px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:10px;width:24px;height:24px;min-width:24px;min-height:24px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .appliqueEtat[_ngcontent-%COMP%]{font-weight:500;text-decoration:underline}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-around}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;min-width:80px;min-height:80px;object-fit:contain;flex:0 0 calc(33% - 10px);max-width:calc(33% - 10px)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   .craftable[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 5px gold)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   .monster[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .effects[_ngcontent-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   .craftable[_ngcontent-%COMP%]:hover{transform:scale(1.2)}[_nghost-%COMP%]   .iconComparator[_ngcontent-%COMP%]{position:absolute;right:10px;bottom:10px;color:#415a77;background-color:#e5e9ea;border-radius:50%;cursor:pointer;border:5px solid #0D1B2A}@media screen and (max-width: 900px){[_nghost-%COMP%]{max-width:90%;margin:auto}[_nghost-%COMP%]   .fileCopy[_ngcontent-%COMP%]{display:none!important}[_nghost-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px!important;height:40px!important;min-width:40px!important;min-height:40px!important}[_nghost-%COMP%]   .craftAndDrop[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:nth-of-type(n+4){display:none!important}}"]})};var Se=class a extends pe{static DEFAULT_VALUE={dragodinde:!1,neoFamilier1:!1,neoFamilier2:!1,neoFamilier3:!1,neoFamilier4:!1,guilde:!1};recapStats=new U([]);recapStats$=this.recapStats.asObservable();levelFormService=p(le);keyEnum="KEY_BONUS";form=new oe({dragodinde:new E(a.DEFAULT_VALUE.dragodinde,{nonNullable:!0}),neoFamilier1:new E(a.DEFAULT_VALUE.neoFamilier1,{nonNullable:!0}),neoFamilier2:new E(a.DEFAULT_VALUE.neoFamilier2,{nonNullable:!0}),neoFamilier3:new E(a.DEFAULT_VALUE.neoFamilier3,{nonNullable:!0}),neoFamilier4:new E(a.DEFAULT_VALUE.neoFamilier4,{nonNullable:!0}),guilde:new E(a.DEFAULT_VALUE.guilde,{nonNullable:!0})});constructor(){super(),this.init()}handleChanges(e){let i=this.levelFormService.form.value,t=[];e.dragodinde&&t.push({id:120,value:40,params:[]}),e.guilde&&(t.push({id:20,value:55,params:[]}),t.push({id:80,value:20,params:[]}),t.push({id:-6,value:8,params:[]}),t.push({id:162,value:10,params:[]}),t.push({id:166,value:10,params:[]}),t.push({id:171,value:10,params:[]}),t.push({id:173,value:20,params:[]}),t.push({id:175,value:20,params:[]}),t.push({id:-9,value:8,params:[]})),e.neoFamilier1&&(t.push({id:120,value:i,params:[]}),t.push({id:20,value:2*i,params:[]}),t.push({id:177,value:5,params:[]}),t.push({id:150,value:3,params:[]}),t.push({id:875,value:3,params:[]})),e.neoFamilier2&&(t.push({id:41,value:1,params:[]}),t.push({id:120,value:Math.floor(1.5*i),params:[]}),t.push({id:20,value:3*i,params:[]}),t.push({id:177,value:10,params:[]}),t.push({id:150,value:3,params:[]}),t.push({id:875,value:3,params:[]})),e.neoFamilier3&&(t.push({id:41,value:1,params:[]}),t.push({id:191,value:2,params:[]}),t.push({id:120,value:2*i,params:[]}),t.push({id:20,value:4*i,params:[]}),t.push({id:177,value:15,params:[]}),t.push({id:150,value:3,params:[]}),t.push({id:875,value:3,params:[]})),e.neoFamilier4&&(t.push({id:31,value:1,params:[]}),t.push({id:41,value:1,params:[]}),t.push({id:191,value:2,params:[]}),t.push({id:120,value:2*i,params:[]}),t.push({id:20,value:4*i,params:[]}),t.push({id:177,value:20,params:[]}),t.push({id:150,value:3,params:[]}),t.push({id:875,value:3,params:[]})),this.recapStats.next(t)}setValue(e){this.form.setValue(e??a.DEFAULT_VALUE)}setDefaultValue(){this.form.setValue(a.DEFAULT_VALUE)}static \u0275fac=function(i){return new(i||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};var Te=class a extends pe{static DEFAULT_VALUE=0;recapStat=new U([]);recapStat$=this.recapStat.asObservable();keyEnum="KEY_APTITUDES";form=new oe({pointDeVie:new E(a.DEFAULT_VALUE,{nonNullable:!0}),pa:new E(a.DEFAULT_VALUE,{nonNullable:!0}),pm:new E(a.DEFAULT_VALUE,{nonNullable:!0}),pw:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseFeu:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseEau:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseTerre:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseAir:new E(a.DEFAULT_VALUE,{nonNullable:!0}),resistancesFeu:new E(a.DEFAULT_VALUE,{nonNullable:!0}),resistancesEau:new E(a.DEFAULT_VALUE,{nonNullable:!0}),resistancesTerre:new E(a.DEFAULT_VALUE,{nonNullable:!0}),resistancesAir:new E(a.DEFAULT_VALUE,{nonNullable:!0}),di:new E(a.DEFAULT_VALUE,{nonNullable:!0}),soinsRealises:new E(a.DEFAULT_VALUE,{nonNullable:!0}),cc:new E(a.DEFAULT_VALUE,{nonNullable:!0}),parade:new E(a.DEFAULT_VALUE,{nonNullable:!0}),initiative:new E(a.DEFAULT_VALUE,{nonNullable:!0}),portee:new E(a.DEFAULT_VALUE,{nonNullable:!0}),esquive:new E(a.DEFAULT_VALUE,{nonNullable:!0}),tacle:new E(a.DEFAULT_VALUE,{nonNullable:!0}),sagesse:new E(a.DEFAULT_VALUE,{nonNullable:!0}),prospection:new E(a.DEFAULT_VALUE,{nonNullable:!0}),controle:new E(a.DEFAULT_VALUE,{nonNullable:!0}),volonte:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseCritique:new E(a.DEFAULT_VALUE,{nonNullable:!0}),resistancesCritique:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseDos:new E(a.DEFAULT_VALUE,{nonNullable:!0}),resistancesDos:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseMelee:new E(a.DEFAULT_VALUE,{nonNullable:!0}),armureDonnee:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseDistance:new E(a.DEFAULT_VALUE,{nonNullable:!0}),armureRecue:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseSoins:new E(a.DEFAULT_VALUE,{nonNullable:!0}),DIindirect:new E(a.DEFAULT_VALUE,{nonNullable:!0}),maitriseBerzerk:new E(a.DEFAULT_VALUE,{nonNullable:!0})});constructor(){super(),this.init()}handleChanges(e){let i=[{id:20,value:e.pointDeVie,params:[]},{id:31,value:e.pa,params:[]},{id:41,value:e.pm,params:[]},{id:191,value:e.pw,params:[]},{id:122,value:e.maitriseFeu,params:[]},{id:124,value:e.maitriseEau,params:[]},{id:123,value:e.maitriseTerre,params:[]},{id:125,value:e.maitriseAir,params:[]},{id:82,value:e.resistancesFeu,params:[]},{id:83,value:e.resistancesEau,params:[]},{id:84,value:e.resistancesTerre,params:[]},{id:85,value:e.resistancesAir,params:[]},{id:-6,value:e.di,params:[]},{id:-9,value:e.soinsRealises,params:[]},{id:150,value:e.cc,params:[]},{id:875,value:e.parade,params:[]},{id:171,value:e.initiative,params:[]},{id:160,value:e.portee,params:[]},{id:175,value:e.esquive,params:[]},{id:173,value:e.tacle,params:[]},{id:166,value:e.sagesse,params:[]},{id:162,value:e.prospection,params:[]},{id:184,value:e.controle,params:[]},{id:177,value:e.volonte,params:[]},{id:149,value:e.maitriseCritique,params:[]},{id:988,value:e.resistancesCritique,params:[]},{id:180,value:e.maitriseDos,params:[]},{id:71,value:e.resistancesDos,params:[]},{id:1052,value:e.maitriseMelee,params:[]},{id:39,value:e.armureDonnee,ParameterMajorActionEnum:120,params:[]},{id:1053,value:e.maitriseDistance,params:[]},{id:39,value:e.armureRecue,ParameterMajorActionEnum:121,params:[]},{id:26,value:e.maitriseSoins,params:[]},{id:-8,value:e.DIindirect,params:[]},{id:1055,value:e.maitriseBerzerk,params:[]}];this.recapStat.next(i)}setValue(e){this.form.setValue({pointDeVie:e?.pointDeVie??a.DEFAULT_VALUE,pa:e?.pa??a.DEFAULT_VALUE,pm:e?.pm??a.DEFAULT_VALUE,pw:e?.pw??a.DEFAULT_VALUE,maitriseFeu:e?.maitriseFeu??a.DEFAULT_VALUE,maitriseEau:e?.maitriseEau??a.DEFAULT_VALUE,maitriseTerre:e?.maitriseTerre??a.DEFAULT_VALUE,maitriseAir:e?.maitriseAir??a.DEFAULT_VALUE,resistancesFeu:e?.resistancesFeu??a.DEFAULT_VALUE,resistancesEau:e?.resistancesEau??a.DEFAULT_VALUE,resistancesTerre:e?.resistancesTerre??a.DEFAULT_VALUE,resistancesAir:e?.resistancesAir??a.DEFAULT_VALUE,di:e?.di??a.DEFAULT_VALUE,soinsRealises:e?.soinsRealises??a.DEFAULT_VALUE,cc:e?.cc??a.DEFAULT_VALUE,parade:e?.parade??a.DEFAULT_VALUE,initiative:e?.initiative??a.DEFAULT_VALUE,portee:e?.portee??a.DEFAULT_VALUE,esquive:e?.esquive??a.DEFAULT_VALUE,tacle:e?.tacle??a.DEFAULT_VALUE,sagesse:e?.sagesse??a.DEFAULT_VALUE,prospection:e?.prospection??a.DEFAULT_VALUE,controle:e?.controle??a.DEFAULT_VALUE,volonte:e?.volonte??a.DEFAULT_VALUE,maitriseCritique:e?.maitriseCritique??a.DEFAULT_VALUE,resistancesCritique:e?.resistancesCritique??a.DEFAULT_VALUE,maitriseDos:e?.maitriseDos??a.DEFAULT_VALUE,resistancesDos:e?.resistancesDos??a.DEFAULT_VALUE,maitriseMelee:e?.maitriseMelee??a.DEFAULT_VALUE,armureDonnee:e?.armureDonnee??a.DEFAULT_VALUE,maitriseDistance:e?.maitriseDistance??a.DEFAULT_VALUE,armureRecue:e?.armureRecue??a.DEFAULT_VALUE,maitriseSoins:e?.maitriseSoins??a.DEFAULT_VALUE,DIindirect:e?.DIindirect??a.DEFAULT_VALUE,maitriseBerzerk:e?.maitriseBerzerk??a.DEFAULT_VALUE})}setDefaultValue(){this.form.setValue({pointDeVie:a.DEFAULT_VALUE,pa:a.DEFAULT_VALUE,pm:a.DEFAULT_VALUE,pw:a.DEFAULT_VALUE,maitriseFeu:a.DEFAULT_VALUE,maitriseEau:a.DEFAULT_VALUE,maitriseTerre:a.DEFAULT_VALUE,maitriseAir:a.DEFAULT_VALUE,resistancesFeu:a.DEFAULT_VALUE,resistancesEau:a.DEFAULT_VALUE,resistancesTerre:a.DEFAULT_VALUE,resistancesAir:a.DEFAULT_VALUE,di:a.DEFAULT_VALUE,soinsRealises:a.DEFAULT_VALUE,cc:a.DEFAULT_VALUE,parade:a.DEFAULT_VALUE,initiative:a.DEFAULT_VALUE,portee:a.DEFAULT_VALUE,esquive:a.DEFAULT_VALUE,tacle:a.DEFAULT_VALUE,sagesse:a.DEFAULT_VALUE,prospection:a.DEFAULT_VALUE,controle:a.DEFAULT_VALUE,volonte:a.DEFAULT_VALUE,maitriseCritique:a.DEFAULT_VALUE,resistancesCritique:a.DEFAULT_VALUE,maitriseDos:a.DEFAULT_VALUE,resistancesDos:a.DEFAULT_VALUE,maitriseMelee:a.DEFAULT_VALUE,armureDonnee:a.DEFAULT_VALUE,maitriseDistance:a.DEFAULT_VALUE,armureRecue:a.DEFAULT_VALUE,maitriseSoins:a.DEFAULT_VALUE,DIindirect:a.DEFAULT_VALUE,maitriseBerzerk:a.DEFAULT_VALUE})}static \u0275fac=function(i){return new(i||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};var Je=class a extends We{actionService=p(j);itemChooseService=p(ce);aptitudesFormService=p(Ke);levelFormService=p(le);classeFormService=p(ze);sortFormService=p(He);chasseFormService=p(Xe);bonusFormService=p(Se);aptitudesManualFormService=p(Te);maitrisesSecondairesList=[149,180,26,1055,1052,1053];naturalEffects=[{id:31,value:6,params:[]},{id:41,value:3,params:[]},{id:191,value:6,params:[]},{id:150,value:3,params:[]},{id:184,value:1,params:[]}];initialEffectList=[{id:122,value:0,params:[]},{id:124,value:0,params:[]},{id:123,value:0,params:[]},{id:125,value:0,params:[]},{id:1052,value:0,params:[]},{id:1053,value:0,params:[]},{id:149,value:0,params:[]},{id:180,value:0,params:[]},{id:26,value:0,params:[]},{id:1055,value:0,params:[]},{id:150,value:0,params:[]},{id:875,value:0,params:[]},{id:71,value:0,params:[]},{id:988,value:0,params:[]},{id:184,value:0,params:[]},{id:-6,value:0,params:[]},{id:-8,value:0,params:[]},{id:162,value:0,params:[]},{id:82,value:0,params:[]},{id:83,value:0,params:[]},{id:84,value:0,params:[]},{id:85,value:0,params:[]},{id:31,value:0,params:[]},{id:41,value:0,params:[]},{id:191,value:0,params:[]},{id:160,value:0,params:[]},{id:20,value:0,params:[]},{id:39,parameterMajorAction:120,value:0,params:[]},{id:39,parameterMajorAction:121,value:0,params:[]},{id:175,value:0,params:[]},{id:173,value:0,params:[]},{id:177,value:0,params:[]},{id:171,value:0,params:[]},{id:-9,value:0,params:[]},{id:-7,value:0,params:[]},{id:166,value:0,params:[]}];recap=new U([...this.initialEffectList]);recap$=this.recap.asObservable();maitrisesTotal=new U(0);maitrisesTotal$=this.maitrisesTotal.asObservable();resistancesTotal=new U(0);resistancesTotal$=this.resistancesTotal.asObservable();constructor(){super(),this.initializeListeners()}initializeListeners(){G([this.itemChooseService.listItem$,this.aptitudesFormService.recapStat$,this.levelFormService.level$,this.chasseFormService.recapChassesEffect$,this.chasseFormService.sublimationsIdToLevel$,this.bonusFormService.recapStats$,this.aptitudesManualFormService.recapStat$,this.classeFormService.classe$,this.sortFormService.sortPassifs$]).pipe($(this.destroy$),v(()=>this.resetEffects()),_(([e,i,t,r,s,n,S])=>{let M=this.extractEquipEffects(e),O=this.mapToRecapStats(M);return O.push(...i,...r,...n,...S),{recapStat:O,level:t,sublimationsIdToLevel:s}}),v(()=>this.applyNatifEffects()),v(()=>this.applyEffectByClass()),v((e=>e.recapStat.forEach(i=>this.applyEffect(i)))),v(()=>this.applyEffectPassif()),v(e=>this.applyEffectSublimation(e.sublimationsIdToLevel)),v(()=>this.applyPdv()),v(()=>this.emitEffects())).subscribe()}applyPdv(){let e=this.recap.value.find(t=>t.id===20),i=this.recap.value.find(t=>t.id===-7);if(e&&i){let r=50+this.levelFormService.getValue()*10;e.value=Math.floor((r+e.value)*(1+i.value/100))}}allMaitrisesSecondairesNull(){return this.maitrisesSecondairesList.every(e=>{let i=this.recap.value.find(t=>t.id===e);return i?i.value<=0:!0})}applyEffectSublimation(e){let i=this.levelFormService.getValue();e.forEach((t,r)=>{if(r===29004&&this.allMaitrisesSecondairesNull())this.applyEffect({id:160,value:Math.floor(.5*t),params:[]}),this.applyEffect({id:191,value:Math.floor(.5*t),params:[]}),this.applyEffect({id:39,value:t*-5,parameterMajorAction:120,params:[]}),this.applyEffect({id:39,value:t*-5,parameterMajorAction:121,params:[]});else if(r===30752)this.applyEffect({id:-9,value:-20,params:[]});else if(r===30956)this.applyEffect({id:41,value:Math.floor(.5*t),params:[]});else if(r===31369)this.applyEffect({id:39,value:t*5,parameterMajorAction:120,params:[]});else if(r===29591&&this.allMaitrisesSecondairesNull())this.applyEffect({id:150,value:t*5,params:[]});else if(r===28900)this.applyEffect({id:-6,value:-20,params:[]});else if(r===29495)this.applyEffect({id:-6,value:10,params:[]}),this.applyEffect({id:41,value:-3+t,params:[]});else if(r===31630)this.applyEffect({id:988,value:t*5,params:[]});else if(r===31633)this.applyEffect({id:71,value:t*5,params:[]});else if(r===29497)this.applyEffect({id:80,value:75,params:[]}),this.applyEffect({id:31,value:-3+t,params:[]});else if(r===28828)this.applyEffect({id:120,value:Math.floor(.15*i*t),params:[]});else if(r===28830)this.applyEffect({id:-7,value:t*5,params:[]});else if(r===27158)this.applyEffect({id:177,value:-20,params:[]});else if(r===29499)this.applyEffect({id:160,value:-1,params:[]}),this.applyEffect({id:173,value:Math.floor(.5*i*t),params:[]}),this.applyEffect({id:175,value:Math.floor(.5*i*t),params:[]});else if(r===30763)this.applyEffect({id:875,value:10*t,params:[]});else if(r===28849)this.applyEffect({id:150,value:5*t,params:[]});else if(r===31627)this.applyEffect({id:875,value:3*t,params:[]});else if(r===28824)this.applyEffect({id:193,value:1,params:[]}),this.applyEffect({id:177,value:-40+10*t,params:[]});else if(r===28845)this.applyEffect({id:39,value:3*t,parameterMajorAction:121,params:[]});else if(r===28880)this.applyEffect({id:39,value:5*t,parameterMajorAction:120,params:[]});else if(r===28858)this.applyEffect({id:175,value:Math.floor(.5*i*t),params:[]});else if(r===30961)this.applyEffect({id:175,value:Math.floor(.5*i*t),params:[]});else if(r===28908)this.applyEffect({id:120,value:Math.floor(.25*i*t),params:[]});else if(r===27161)this.applyEffect({id:80,value:-50,params:[]});else if(r===27159)this.applyEffect({id:-6,value:-15,params:[]});else if(r===30953)this.applyEffect({id:-6,value:3*t,params:[]});else if(r===27153)this.applyEffect({id:-6,value:-15,params:[]});else if(r===28897)this.applyEffect({id:150,value:10*t,params:[]});else if(r===28871)this.applyEffect({id:150,value:3*t,params:[]});else if(r===30957)this.applyEffect({id:150,value:4*t,params:[]});else if(r===30967)this.applyEffect({id:173,value:Math.floor(.5*i),params:[]});else if(r===29001&&this.allMaitrisesSecondairesNull())this.applyEffect({id:-6,value:8*t,params:[]});else if(r===28867)this.applyEffect({id:875,value:5*t,params:[]});else if(r===29513){let s=this.recap.value.find(S=>S.id===41)?.value??0,n=Math.max(0,s-4);this.applyEffect({id:175,value:2*n*t,params:[]})}else if(r===29007)this.applyEffect({id:875,value:5*t,params:[]});else if(r===28894)this.applyEffect({id:191,value:-1*t,params:[]});else if(r===28826)this.applyEffect({id:120,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:1055,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:149,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:180,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:1052,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:1053,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:26,value:Math.floor(.05*t*i),params:[]}),this.applyEffect({id:80,value:3*t,params:[]});else if(r===27124)this.applyEffect({id:177,value:-20,params:[]});else if(r===28988)this.applyEffect({id:-9,value:-10,params:[]});else if(r===28822)this.applyEffect({id:-8,value:5*t,params:[]});else if(r===31636)this.applyEffect({id:191,value:-1,params:[]});else if(r===27959){let s=this.recap.value.find(n=>n.id===26)?.value??0;this.applyEffect({id:-9,value:-s,params:[]}),this.applyEffect({id:-9,value:10,params:[]})}else if(r===28852)this.applyEffect({id:173,value:50*t*i,params:[]});else if(r===28842)this.applyEffect({id:150,value:50*t,params:[]}),this.applyEffect({id:-6,value:-50,params:[]}),this.applyEffect({id:-9,value:-50,params:[]});else if(r===28840){let s=this.recap.value.find(n=>n.id===175)?.value??0;this.applyEffect({id:175,value:-s,params:[]})}else if(r===28847)this.applyEffect({id:41,value:1,params:[]}),this.applyEffect({id:-6,value:-30+10*t,params:[]});else if(r===28851)this.applyEffect({id:160,value:1,params:[]}),this.applyEffect({id:175,value:-450+150*t,params:[]}),this.applyEffect({id:173,value:-450+150*t,params:[]});else if(r===30996)this.applyEffect({id:-6,value:-15,params:[]}),this.applyEffect({id:-9,value:30,params:[]});else if(r===25795)this.applyEffect({id:-6,value:-20,params:[]});else if(r===31609)this.applyEffect({id:80,value:50,params:[]});else if(r===31601)this.applyEffect({id:80,value:-100,params:[]});else if(r===29876)this.applyEffect({id:80,value:-50,params:[]});else if(r===30995){let s=this.recap.value.find(O=>O.id===122)?.value??0;this.applyEffect({id:122,value:-s,params:[]});let n=this.recap.value.find(O=>O.id===124)?.value??0;this.applyEffect({id:124,value:-n,params:[]});let S=this.recap.value.find(O=>O.id===123)?.value??0;this.applyEffect({id:123,value:-S,params:[]});let M=this.recap.value.find(O=>O.id===125)?.value??0;this.applyEffect({id:125,value:-M,params:[]}),this.applyEffect({id:-6,value:20,params:[]}),this.applyEffect({id:-9,value:20,params:[]})}else if(r===27190)this.applyEffect({id:-6,value:20,params:[]}),this.applyEffect({id:-9,value:20,params:[]}),this.applyNerfConcentrationElementaire();else if(r===24131)this.applyEffect({id:-6,value:20,params:[]}),this.applyEffect({id:150,value:50,params:[]});else if(r===30993)this.applyEffect({id:-8,value:40,params:[]});else if(r===29873)this.applyEffect({id:-8,value:30,params:[]});else if(r===24132){let s=this.recap.value.find(n=>n.id===149)?.value??0;this.applyEffect({id:149,value:-s,params:[]}),this.applyEffect({id:120,value:s,params:[]})}else if(r===30994)this.applyEffect({id:-6,value:20,params:[]}),this.applyEffect({id:-9,value:20,params:[]});else if(r===30997){let s=this.recap.value.find(n=>n.id===26)?.value??0;this.applyEffect({id:26,value:-s,params:[]}),this.applyEffect({id:-9,value:30,params:[]})}else if(r===25799)this.applyEffect({id:-6,value:-10,params:[]});else if(r===29871)this.applyEffect({id:-6,value:-10,params:[]});else if(r===25797)this.applyEffect({id:175,value:Math.floor(2.5*i),params:[]});else if(r===28383)(this.recap.value.find(n=>n.id===175)?.value??0)>i&&this.applyEffect({id:173,value:i,params:[]});else if(r===28384)this.applyEffect({id:160,value:1,params:[]});else if(r===24130)this.applyEffect({id:-6,value:15,params:[]}),i>=100&&this.applyEffect({id:-6,value:10,params:[]});else if(r===27188){let s=this.recap.value.find(n=>n.id===160)?.value??0;s>0&&this.applyEffect({id:160,value:-s,params:[]}),this.applyEffect({id:41,value:1,params:[]})}else r===27186?(this.applyEffect({id:41,value:-2,params:[]}),this.applyEffect({id:31,value:2,params:[]})):r===24134?this.applyEffect({id:150,value:10,params:[]}):r===31614?(this.applyEffect({id:875,value:20,params:[]}),this.applyEffect({id:177,value:10,params:[]})):r===27189?(this.applyEffect({id:177,value:10,params:[]}),this.applyEffect({id:875,value:15,params:[]})):r===28385?(this.applyEffect({id:-7,value:30,params:[]}),this.applyEffect({id:39,value:-50,parameterMajorAction:121,params:[]})):r===31613?(this.applyEffect({id:-7,value:-30,params:[]}),this.applyEffect({id:39,parameterMajorAction:120,value:30,params:[]})):r===24133?(this.applyEffect({id:-9,value:20,params:[]}),this.applyEffect({id:39,value:15,parameterMajorAction:120,params:[]})):r===28389?this.applyEffect({id:80,value:-50,params:[]}):r===25793?(this.applyEffect({id:-7,value:-30,params:[]}),this.applyEffect({id:39,parameterMajorAction:121,value:30,params:[]})):r===25794?(this.applyEffect({id:80,value:50,params:[]}),this.applyEffect({id:71,value:-200,params:[]})):r===29875?this.applyEffect({id:160,value:3,params:[]}):r===30998&&this.applyEffect({id:177,value:20,params:[]})})}applyNerfConcentrationElementaire(){let e=this.recap.value.find(M=>M.id===122)?.value??0,i=this.recap.value.find(M=>M.id===124)?.value??0,t=this.recap.value.find(M=>M.id===123)?.value??0,r=this.recap.value.find(M=>M.id===125)?.value??0,S=[{id:122,value:e},{id:124,value:i},{id:123,value:t},{id:125,value:r}].sort((M,O)=>O.value-M.value)[0].id;122!==S&&this.applyEffect({id:122,value:Math.floor(.3*-e),params:[]}),124!==S&&this.applyEffect({id:124,value:Math.floor(.3*-i),params:[]}),123!==S&&this.applyEffect({id:123,value:Math.floor(.3*-t),params:[]}),125!==S&&this.applyEffect({id:125,value:Math.floor(.3*-r),params:[]})}applyEffectPassif(){this.applyEffectPassifGenerique(),this.applyEffectPassifClasse()}applyEffectPassifClasse(){switch(this.classeFormService.getValue()){case 1:this.applyEffectPassifFeca();break;case 2:this.applyEffectPassifOsamodas();break;case 4:this.applyEffectPassifSram();break;case 5:this.applyEffectPassifXelor();break;case 7:this.applyEffectPassifEniripsa();break;case 8:this.applyEffectPassifIop();break;case 9:this.applyEffectPassifCra();break;case 10:this.applyEffectPassifSadida();break;case 11:this.applyEffectPassifSacrieur();break;case 12:this.applyEffectPassifPandawa();break;case 14:this.applyEffectPassifZobal();break;case 15:this.applyEffectPassifOuginak();break;case 16:this.applyEffectPassifSteamer();break;case 18:this.applyEffectPassifEliotrope();break;case 19:this.applyEffectPassifHuppermage();break}}applyEffectPassifHuppermage(){this.sortFormService.getSortPassifs().find(i=>i===7193)&&this.applyEffect({id:177,value:20,params:[]})}applyEffectPassifEliotrope(){this.sortFormService.getSortPassifs().find(i=>i===7208)&&this.applyEffect({id:160,value:-1,params:[]})}applyEffectPassifSteamer(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===7181)&&this.applyEffect({id:-8,value:-30,params:[]}),e.find(t=>t===7344)&&this.applyEffect({id:20,value:6*i,params:[]}),e.find(t=>t===2819)&&this.applyEffect({id:41,value:-1,params:[]}),e.find(t=>t===2816)&&this.applyEffect({id:39,value:-30,parameterMajorAction:121,params:[]}),e.find(t=>t===5462)&&this.applyEffect({id:-8,value:-20,params:[]})}applyEffectPassifOuginak(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===6276)&&(this.applyEffect({id:-8,value:50,params:[]}),this.applyEffect({id:160,value:-2,params:[]})),e.find(t=>t===6278)&&this.applyEffect({id:875,value:30,params:[]}),e.find(t=>t===5103)&&this.applyEffect({id:41,value:1,params:[]}),e.find(t=>t===6275)&&this.applyEffect({id:-8,value:-15,params:[]}),e.find(t=>t===7343)&&this.applyEffect({id:191,value:3,params:[]}),e.find(t=>t===7557)&&this.applyEffect({id:191,value:-1,params:[]}),e.find(t=>t===6277)&&(this.applyEffect({id:-6,value:-10,params:[]}),this.applyEffect({id:39,value:30,parameterMajorAction:121,params:[]}),this.applyEffect({id:20,value:4*i,params:[]})),e.find(t=>t===7328)&&this.applyEffect({id:41,value:-1,params:[]}),e.find(t=>t===6272)&&this.applyEffect({id:-8,value:-15,params:[]}),e.find(t=>t===7193)&&(this.applyEffect({id:177,value:20,params:[]}),this.applyEffect({id:-6,value:-10,params:[]})),e.find(t=>t===7596)&&this.applyEffect({id:173,value:3*i,params:[]})}applyEffectPassifZobal(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();if(e.find(t=>t===5359)&&this.applyEffect({id:41,value:1,params:[]}),e.find(t=>t===7093)&&this.applyEffect({id:175,value:2*i,params:[]}),e.find(t=>t===7111)){let t=this.recap.value.find(r=>r.id===175)?.value??0;if(t>=0){let r=Math.min(Math.floor(t/2),2*i);this.applyEffect({id:1053,value:r,params:[]})}}if(e.find(t=>t===7104)&&this.applyEffect({id:-6,value:-25,params:[]}),e.find(t=>t===3356)&&(this.applyEffect({id:-6,value:25,params:[]}),this.applyEffect({id:39,value:-40,parameterMajorAction:121,params:[]}),this.applyEffect({id:39,value:-40,parameterMajorAction:120,params:[]})),e.find(t=>t===3363)){let t=this.recap.value.find(r=>r.id===173)?.value??0;t>=0&&this.applyEffect({id:173,value:t,params:[]}),this.applyEffect({id:41,value:-1,params:[]})}if(e.find(t=>t===7094)){let t=this.recap.value.find(r=>r.id===173)?.value??0;if(t>=0){let r=Math.min(Math.floor(t/2),2*i);this.applyEffect({id:1052,value:r,params:[]})}}e.find(t=>t===7113)&&this.applyEffect({id:177,value:10,params:[]})}applyEffectPassifPandawa(){let e=this.sortFormService.getSortPassifs();e.find(i=>i===7987)&&(this.applyEffect({id:-9,value:20,params:[]}),this.applyEffect({id:-6,value:-10,params:[]})),e.find(i=>i===5149)&&(this.applyEffect({id:-6,value:15,params:[]}),this.applyEffect({id:80,value:-50,params:[]})),e.find(i=>i===5151)&&this.applyEffect({id:-6,value:10,params:[]})}applyEffectPassifSacrieur(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();if(e.find(t=>t===7218)&&this.applyEffect({id:160,value:-2,params:[]}),e.find(t=>t===7213)&&this.applyEffect({id:39,value:-50,parameterMajorAction:121,params:[]}),e.find(t=>t===5192)){let t=this.recap.value.find(r=>r.id===173)?.value??0;t>=0&&this.applyEffect({id:173,value:-t,params:[]})}e.find(t=>t===5051)&&this.applyEffect({id:20,value:8*i,params:[]})}applyEffectPassifSadida(){this.sortFormService.getSortPassifs().find(i=>i===7193)&&this.applyEffect({id:177,value:20,params:[]})}applyEffectPassifCra(){if(this.sortFormService.getSortPassifs().find(i=>i===588)){let i=this.recap.value.find(t=>t.id===175)?.value??0;this.applyEffect({id:175,value:-i,params:[]}),this.applyEffect({id:177,value:20,params:[]})}}applyEffectPassifIop(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===525)&&this.applyEffect({id:20,value:3*i,params:[]}),e.find(t=>t===7111)&&this.applyEffect({id:39,value:-20,parameterMajorAction:121,params:[]})}applyEffectPassifEniripsa(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===5453)&&this.applyEffect({id:20,value:8*i,params:[]})}applyEffectPassifXelor(){let e=this.sortFormService.getSortPassifs();e.find(i=>i===756)&&(this.applyEffect({id:191,value:6,params:[]}),this.applyEffect({id:41,value:-2,params:[]})),e.find(i=>i===7196)&&this.applyEffect({id:191,value:-6,params:[]})}applyEffectPassifSram(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();if(e.find(t=>t===4609)&&this.applyEffect({id:184,value:4,params:[]}),e.find(t=>t===5122)&&this.applyEffect({id:1053,value:Math.floor(i*1.5),params:[]}),e.find(t=>t===5126)&&this.applyEffect({id:177,value:20,params:[]}),e.find(t=>t===2437)){let t=this.recap.value.find(s=>s.id===175)?.value??0;t>=0&&this.applyEffect({id:150,value:Math.min(Math.floor(t/20),15),params:[]});let r=this.recap.value.find(s=>s.id===173)?.value??0;r>=0&&this.applyEffect({id:150,value:Math.min(Math.floor(r/20),15),params:[]})}}applyEffectPassifOsamodas(){let e=this.sortFormService.getSortPassifs();e.find(i=>i===7340)&&this.applyEffect({id:191,value:3,params:[]}),e.find(i=>i===7333)&&this.applyEffect({id:-6,value:25,params:[]}),e.find(i=>i===7331)&&this.applyEffect({id:-6,value:20,params:[]}),e.find(i=>i===7330)&&this.applyEffect({id:160,value:2,params:[]}),e.find(i=>i===7344)&&this.applyEffect({id:80,value:-100,params:[]})}applyEffectPassifFeca(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();if(e.find(t=>t===6997)&&this.applyEffect({id:875,value:30,params:[]}),e.find(t=>t===7004)&&this.applyEffect({id:39,value:100,parameterMajorAction:120,params:[]}),e.find(t=>t===2374)&&this.applyEffect({id:39,value:-100,parameterMajorAction:121,params:[]}),e.find(t=>t===5245)&&this.applyEffect({id:-6,value:10,params:[]}),e.find(t=>t===866)){let t=this.recap.value.find(r=>r.id===875);t&&t.value<=100&&(this.applyEffect({id:39,value:t.value,parameterMajorAction:120,params:[]}),this.applyEffect({id:875,value:-t.value,params:[]}))}e.find(t=>t===2295)&&(this.applyEffect({id:39,value:-100,parameterMajorAction:121,params:[]}),this.applyEffect({id:-6,value:25,params:[]})),e.find(t=>t===6989)&&this.applyEffect({id:160,value:1,params:[]}),e.find(t=>t===7005)&&(this.applyEffect({id:20,value:3*i,params:[]}),this.applyEffect({id:-6,value:-20,params:[]}))}applyEffectPassifGenerique(){let e=this.sortFormService.getSortPassifs(),i=this.levelFormService.getValue();e.find(t=>t===5144)&&(this.applyEffect({id:-6,value:15,params:[]}),this.applyEffect({id:-9,value:-30,params:[]})),e.find(t=>t===4957)&&this.applyEffect({id:175,value:i,params:[]}),e.find(t=>t===4956)&&this.applyEffect({id:171,value:Math.floor(i/2),params:[]}),e.find(t=>t===4958)&&this.applyEffect({id:173,value:i,params:[]}),e.find(t=>t===5146)&&(this.applyEffect({id:-9,value:30,params:[]}),this.applyEffect({id:39,value:25,parameterMajorAction:120,params:[]}),this.applyEffect({id:-6,value:-15,params:[]})),e.find(t=>t===5237)&&(this.applyEffect({id:31,value:1,params:[]}),this.applyEffect({id:-6,value:-20,params:[]}),this.applyEffect({id:177,value:10,params:[]})),e.find(t=>t===5145)&&(this.applyEffect({id:-7,value:60,params:[]}),this.applyEffect({id:-4,value:25,params:[]}),this.applyEffect({id:-6,value:-25,params:[]}),this.applyEffect({id:-9,value:-50,params:[]}))}applyEffectByClass(){let e=this.classeFormService.getValue(),i=this.levelFormService.getValue();switch(e){case 9:this.applyEffect({id:160,value:1,params:[]});break;case 6:this.applyEffect({id:150,value:20,params:[]});break;case 11:this.applyEffect({id:20,value:4*i,params:[]});break;case 4:this.applyEffect({id:180,value:i,params:[]}),this.applyEffect({id:184,value:1,params:[]});break;case 8:this.applyEffect({id:41,value:1,params:[]});break;case 7:this.applyEffect({id:20,value:2*i,params:[]});break;case 18:(this.recap.value.find(t=>t.id===160)?.value??0)>=2&&(this.applyEffect({id:160,value:-2,params:[]}),this.applyEffect({id:41,value:1,params:[]}));break;case 5:this.applyEffect({id:191,value:6,params:[]});break}}applyNatifEffects(){this.naturalEffects.forEach(e=>this.applyEffect(e))}resetEffects(){this.recap.value.forEach(e=>e.value=0)}extractEquipEffects(e){return e.flatMap(i=>i.equipEffects)}mapToRecapStats(e){return e.map(i=>({id:i.actionId,parameterMajorAction:i.actionId!==39?void 0:i.params[4]===120?120:121,value:i.params[0],params:i.params}))}applyEffectResistance(e){if(e.id===80)this.applyEffect({id:82,value:e.value,params:e.params}),this.applyEffect({id:83,value:e.value,params:e.params}),this.applyEffect({id:84,value:e.value,params:e.params}),this.applyEffect({id:85,value:e.value,params:e.params});else if(e.id===90||e.id===100)this.applyEffect({id:82,value:-e.value,params:e.params}),this.applyEffect({id:83,value:-e.value,params:e.params}),this.applyEffect({id:84,value:-e.value,params:e.params}),this.applyEffect({id:85,value:-e.value,params:e.params});else if(e.id===1069){let i=e.params[2];i>=1&&this.applyEffect({id:82,value:e.value,params:e.params}),i>=2&&this.applyEffect({id:83,value:e.value,params:e.params}),i>=3&&this.applyEffect({id:84,value:e.value,params:e.params}),i>=4&&this.applyEffect({id:85,value:e.value,params:e.params})}else e.id===35&&this.applyEffect({id:80,value:50,params:e.params})}applyEffectMaitrisesElementaires(e){if(e.id===120)this.applyEffect({id:122,value:e.value,params:e.params}),this.applyEffect({id:124,value:e.value,params:e.params}),this.applyEffect({id:123,value:e.value,params:e.params}),this.applyEffect({id:125,value:e.value,params:e.params});else if(e.id===130)this.applyEffect({id:122,value:-e.value,params:e.params}),this.applyEffect({id:124,value:-e.value,params:e.params}),this.applyEffect({id:123,value:-e.value,params:e.params}),this.applyEffect({id:125,value:-e.value,params:e.params});else if(e.id===1068){let i=e.params[2];i>=1&&this.applyEffect({id:122,value:e.value,params:e.params}),i>=2&&this.applyEffect({id:124,value:e.value,params:e.params}),i>=3&&this.applyEffect({id:123,value:e.value,params:e.params}),i>=4&&this.applyEffect({id:125,value:e.value,params:e.params})}}applyEffect(e){this.applyEffectResistance(e),this.applyEffectMaitrisesElementaires(e);let i=this.actionService.isAMalus(e.id),t=i?this.actionService.getOpposedEffect(e.id):e.id,r=i?-1:1,s=this.recap.value.find(n=>n.id!==39&&n.id===t||n.id===39&&n.parameterMajorAction===e.parameterMajorAction);s&&(s.value+=r*e.value)}emitEffects(){this.recap.next([...this.recap.value]);let e=this.recap.value.filter(s=>[1052,1053,149,180,26,1055].includes(s.id)).filter(s=>s.value>0).reduce((s,n)=>s+n.value,0),i=Math.max(this.recap.value.find(s=>s.id===122)?.value||0,this.recap.value.find(s=>s.id===124)?.value||0,this.recap.value.find(s=>s.id===123)?.value||0,this.recap.value.find(s=>s.id===125)?.value||0,0),t=e+i;this.maitrisesTotal.next(t);let r=this.recap.value.filter(s=>[82,83,84,85].includes(s.id)).reduce((s,n)=>s+n.value,0);this.resistancesTotal.next(r)}static \u0275fac=function(i){return new(i||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};export{j as a,me as b,fe as c,Ye as d,Ze as e,Se as f,Te as g,Je as h};
